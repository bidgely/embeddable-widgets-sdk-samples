"use strict";(self.webpackChunkmeraki=self.webpackChunkmeraki||[]).push([[35],{90916:function(e,t,a){a.r(t),a.d(t,{default:function(){return J}});var i=a(15671),n=a(43144),s=a(60136),o=a(98557),r=a(47313),l=a(97326),c=a(1084),d=a(19536),h=a(69140),u=a(21911),p=a(83450),g=a(16404),m=a(56955),f=a(88291),y=a(21629),v=a(76720),D=a(46417),b=function(e){(0,s.Z)(a,e);var t=(0,o.Z)(a);function a(){return(0,i.Z)(this,a),t.apply(this,arguments)}return(0,n.Z)(a,[{key:"goToSurvey",value:function(e){(0,m.cy)(this.props.configs)?this.props.setSurveyV2Modal():((0,f.m3)(y.Z$.INSIGHTS_MONTHLY_SUMMARY,this.props.history,this.props.location,e,p.ce),this.context.rc.analytics.trackEvent(g.FiA.INSIGHTS,{clicked:"Update Home Profile",tab:g.Q2X.MONTHLY_SUMMARY,widget:g.wY4.INSIGHTS.MONTHLY_SUMMARY,version:g.zZZ.V1}))}},{key:"render",value:function(){var e=this,t=this.props,a=t.monthlySummaryData,i=t.configColors,n=t.isMobileView,s=a.monthlySummaryDataArray[a.monthlySummaryActiveIndex],o=this.props.configs.data.showWeeklyHighestConsumptionData;return(0,D.jsxs)(D.Fragment,{children:[!!s.cost&&(0,D.jsxs)(D.Fragment,{children:[(0,D.jsxs)("div",{className:"ms-details-gimpses","data-widget-name":g.wY4.INSIGHTS.MONTHLY_SUMMARY,"data-text-color":"foreground_400",children:[(0,D.jsxs)("div",{children:[this.props.translationsData["MONTHLY_SUMMARY.DETAILS.USAGE_HEADER"],(0,D.jsx)("strong",{children:(0,m.ub)({usage:s.consumption,showUsageUnit:!0,fuelType:this.props.session.userProfile.fuelType})})]}),this.props.translationsData["MONTHLY_SUMMARY.DETAILS.BILL_HEADER"]&&(0,D.jsxs)("div",{children:[this.props.translationsData["MONTHLY_SUMMARY.DETAILS.BILL_HEADER"],(0,D.jsx)("strong",{children:(0,m.xB)({cost:s.cost,showCurrency:!0})})]})]}),!n&&(!(0,m.oF)(this.props.session.userProfile.userType)||o)&&s.highestWeekendConsumptionDate&&s.highestWeekdayConsumptionDate&&(0,D.jsxs)("div",{className:"ms-details-analytics","data-widget-name":g.wY4.INSIGHTS.MONTHLY_SUMMARY,"data-bg-color":"background_400",children:[(0,D.jsxs)("div",{className:"heighest-consumption weekday","data-widget-name":g.wY4.INSIGHTS.MONTHLY_SUMMARY,"data-text-color":"foreground_400",children:[(0,D.jsx)("span",{className:"analytics"}),(0,D.jsxs)("div",{className:"details",children:[(0,D.jsx)("div",{className:"description",children:this.props.translationsData["MONTHLY_SUMMARY.DETAILS.HIGHEST_WEEKEND_HEADER"]}),(0,D.jsx)("div",{className:"day",children:(0,D.jsx)("strong",{children:s.highestWeekendConsumptionDate})})]})]}),(0,D.jsx)(d.Z,{}),(0,D.jsxs)("div",{className:"heighest-consumption weekend","data-widget-name":g.wY4.INSIGHTS.MONTHLY_SUMMARY,"data-text-color":"foreground_400",children:[(0,D.jsx)("span",{className:"analytics"}),(0,D.jsxs)("div",{className:"details",children:[(0,D.jsx)("div",{className:"description",children:this.props.translationsData["MONTHLY_SUMMARY.DETAILS.HIGHEST_WEEKDAY_HEADER"]}),(0,D.jsx)("div",{className:"day",children:(0,D.jsx)("strong",{children:s.highestWeekdayConsumptionDate})})]})]})]})]}),(0,D.jsx)("div",{className:"home-profile-text","data-widget-name":g.wY4.INSIGHTS.MONTHLY_SUMMARY,"data-text-color":"foreground_400",children:this.props.translationsData["MONTHLY_SUMMARY.DETAILS.COMPLETE_SURVEY_TEXT"]}),(0,D.jsx)("div",{"data-widget-name":g.wY4.INSIGHTS.MONTHLY_SUMMARY,"data-bg-color":"background_300","data-text-color":"primary_500","data-border-color":"primary_500","data-hover-color":"background_300",children:(0,D.jsx)(h.Z,{btnVariant:"outlined",btnText:this.props.translationsData["COMMON.HOME_SURVEY_BUTTON_TEXT"],btnBackground:"rgb(".concat(i["--background_300"],")"),hoverColor:"rgb(".concat(i["--background_300"],")"),btnTextTransform:"none",btnTextSize:"14px",btnTextColor:"".concat(((0,m.wG)(),"rgb(".concat(i["--primary_500"],")"))),borderColor:"".concat(((0,m.wG)(),"rgb(".concat(i["--primary_500"],")"))),btnWidth:"100%",onClick:function(t){return e.goToSurvey(t)}})})]})}}]),a}(r.Component);b.contextType=v.zO;var S=(0,u.EN)((0,c.$j)((function(e){return{session:e.session,monthlySummaryData:e.monthlySummaryData,translationsData:e.translationsData.data,configs:e.configs,userId:e.session.userProfile.userId}}))(b)),M=a(84060),T=a(70024),x=a(34862),A=a(41294),C=a(317),w=a(27507),N=function(e){(0,s.Z)(a,e);var t=(0,o.Z)(a);function a(e){var n;return(0,i.Z)(this,a),(n=t.call(this,e)).state={highlightData:null,lowlightData:null,values:null,mode:null,chartHeight:null,noData:!1,isMobileView:e.isMobileView},n}return(0,n.Z)(a,[{key:"render",value:function(){var e=this.props,t=e.appliancesList,a=e.fuelType,i=e.translationsData,n=e.disableAda,s=(0,C.cZ)(this.state.chartHeight,this.state.isMobileView,!1);s.series=(0,C.fD)(this.state.mode,this.state.lowlightData,this.state.highlightData,t,a),s.accessibility=(0,C.jb)(this.state.mode,t,a,i,n);var o=this.state.noData?x.w1||x.G6?"ie-no-data":"no-data":"";return(0,D.jsx)("div",{className:"ms-bar-chart "+o,"data-widget-name":g.wY4.INSIGHTS.MONTHLY_SUMMARY,"data-show-appliances-colors":"true",children:(0,D.jsx)(w.Z,{options:s,ref:"chart",immutable:!1})})}}],[{key:"getDerivedStateFromProps",value:function(e,t){var a=e.fuelType,i=!e.itemizationData.itemizationDetails[a],n=(0,A.mH)(e.itemizationData.itemizationDetails[a],e.mode,i);return n!==t.chartData||e.mode!==t.mode?{highlightData:n.highlightData,lowlightData:n.lowLightData,values:n.values,mode:e.mode,chartHeight:n.chartHeight,noData:i}:null}}]),a}(r.Component),_=function(e){(0,s.Z)(a,e);var t=(0,o.Z)(a);function a(e){var n;return(0,i.Z)(this,a),(n=t.call(this,e)).state={seriesData:null,slicedSeriesData:null,totalCostOrConsumption:null,mode:null,noData:!1},n.chart=null,n}return(0,n.Z)(a,[{key:"componentDidUpdate",value:function(e,t){if(t.mode!==this.state.mode&&this.chart&&this.chart.pieCenterText){var a=this.state.mode,i=a===g.AgQ.USAGE?this.props.totalText:null;this.chart.pieCenterText.attr({text:(0,C.sO)(a,i,this.state.totalCostOrConsumption,this.props.fuelType,!1)}),this.chart.redraw()}}},{key:"chartCallback",value:function(e){this.chart=e}},{key:"render",value:function(){var e=this,t=this.props,a=t.fuelType,i=t.disableAda,n=this.state.mode,s=this.state.totalCostOrConsumption,o=this.state.seriesData.length,r=o>10?500:"auto",l=Math.ceil(o/2),c=300+25*l,d=100+10*l,h=n===g.AgQ.USAGE?this.props.totalText:null,u=(0,C.cU)(s,n,!1,h,r,a,!1,i),p=(0,C.El)(window.innerWidth-52),m=p.itemTextWidth,f=p.itemWidth;return u.responsive={rules:[{condition:{maxWidth:400},chartOptions:{chart:{animation:!1,height:c},plotOptions:{pie:{center:[null,d]}},legend:{itemStyle:{fontSize:"12px",width:m-30},useHTML:!0,align:"center",verticalAlign:"bottom",layout:"horizontal",alignColumns:!0,itemWidth:f,width:"auto",padding:0,itemMarginTop:0,itemMarginBottom:10},series:(0,C.HL)(this.state.slicedSeriesData,this.state.seriesData,this.state.slicedSeriesData,g.fPC.MEDIUM)}},{condition:{maxWidth:300},chartOptions:{chart:{animation:!1,height:c},plotOptions:{pie:{center:[null,90]}},legend:{itemStyle:{fontSize:"12px",width:m-20},useHTML:!0,align:"center",verticalAlign:"bottom",layout:"horizontal",alignColumns:!0,itemWidth:f,width:"auto",padding:3,itemMarginTop:0,itemMarginBottom:10},series:(0,C.HL)(this.state.slicedSeriesData,this.state.seriesData,this.state.slicedSeriesData,g.fPC.SMALL)}}]},u.series=(0,C.HL)(this.state.slicedSeriesData,this.state.seriesData,this.state.slicedSeriesData,g.fPC.LARGE),(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)("svg",{height:"0",width:"0",children:(0,D.jsxs)("defs",{children:[(0,D.jsxs)("filter",{id:"blurFilter2",y:"-20",height:"500",x:"-20",width:"120",children:[(0,D.jsx)("feOffset",{in:"SourceGraphic",dx:"0",dy:"0",result:"offOut"}),(0,D.jsx)("feGaussianBlur",{in:"offOut",stdDeviation:"10",result:"blur2"}),(0,D.jsxs)("feMerge",{children:[(0,D.jsx)("feMergeNode",{in:"blur2"}),(0,D.jsx)("feMergeNode",{in:"SourceGraphic"})]})]}),(0,D.jsxs)("filter",{id:"filter",y:"-20",height:"500",x:"-20",width:"150",children:[" ",(0,D.jsx)("feOffset",{in:"SourceGraphic",dx:"0",dy:"0"})," ",(0,D.jsx)("feGaussianBlur",{stdDeviation:"10",result:"DROP"})," ",(0,D.jsx)("feComposite",{in:"DROP",operator:"in",result:"SHADOW1"})," ",(0,D.jsxs)("feComponentTransfer",{in:"SHADOW1",result:"SHADOW",children:[" ",(0,D.jsx)("feFuncA",{type:"table",tableValues:"0 1.2"})," "]})," ",(0,D.jsxs)("feMerge",{children:[" ",(0,D.jsx)("feMergeNode",{in:"SHADOW"})," ",(0,D.jsx)("feMergeNode",{in:"SourceGraphic"})," "]})," "]})]})}),(0,D.jsx)("div",{className:"ms-pie-chart "+(this.state.noData?x.w1||x.G6||x.tq?"ie-no-data ":"no-data ":"")+(!x.w1&&!x.G6&&!x.tq&&" chart-filter"),"data-widget-name":g.wY4.INSIGHTS.MONTHLY_SUMMARY,"data-show-appliances-colors":"true",children:null!=this.state.seriesData&&s?(0,D.jsx)(w.Z,{options:u,oneToOne:!0,updateArgs:[!0],callback:function(t){e.chartCallback(t)}}):""})]})}}],[{key:"getDerivedStateFromProps",value:function(e,t){var a=e.fuelType,i=!e.itemizationData.itemizationDetails[a],n=(0,A.$R)(e.itemizationData,e.mode,e.appliancesList,e.fuelType,null,!1);return n.seriesData!==t.seriesData||n.slicedSeriesData!==t.seriesData||n.totalCost!==t.totalCostOrConsumption||e.mode!==t.mode?{seriesData:n.seriesData,slicedSeriesData:n.slicedSeriesData,totalCostOrConsumption:n.totalCostOrConsumption,mode:e.mode,noData:i}:null}}]),a}(r.Component),O=a(78023),k=a(41130),j=a(14427),I=a(61120),E=a(1413),L=a(50301),Y=a(94469),U=a(4117),H=a(24193),R=a(96467),P=a(73428),Z=a(61113),F=a(19615),G=r.forwardRef((function(e,t){return(0,D.jsx)(L.Z,(0,E.Z)({direction:"up",ref:t},e))})),B=function(e){(0,s.Z)(a,e);var t=(0,o.Z)(a);function a(e){var n;(0,i.Z)(this,a),n=t.call(this,e);var s=e.controls,o=s.view,r=s.graphStyle,c=s.selectedAppliance,d=s.mode,h=s.timeOfUse,u=s.chartType,p=s.activeMode;return n.state={open:e.open,graphStyle:r,view:o,mode:d,timeOfUse:h,selectedAppliance:c,chartType:u,activeMode:p||void 0},n.onClose=n.onClose.bind((0,l.Z)(n)),n}return(0,n.Z)(a,[{key:"componentDidUpdate",value:function(e){var t=this.props.controls;e.controls.chartType!==t.chartType&&this.setState({chartType:t.chartType}),e.controls.view!==t.view&&this.setState({view:t.view}),e.controls.mode!==t.mode&&this.setState({mode:t.mode,timeOfUse:t.mode!==g.DEY.YEAR&&t.timeOfUse===g.u0K.TYPE?g.NMd.ALL.type:t.timeOfUse}),e.controls.activeMode!==t.activeMode&&this.setState({activeMode:t.activeMode})}},{key:"onViewChange",value:function(e){if(e!==this.state.view){var t=this.state.mode;e===g.H5d.APPLIANCE&&(t=g.DEY.YEAR),this.setState({view:e,mode:t})}}},{key:"onGraphStyleChange",value:function(e){this.setState({graphStyle:e})}},{key:"onModeChange",value:function(e){var t=this.props.controls;this.setState({mode:e,timeOfUse:e!==g.DEY.YEAR&&t.timeOfUse===g.u0K.TYPE?g.NMd.ALL.type:t.timeOfUse})}},{key:"onTOUChange",value:function(e){this.setState({timeOfUse:e})}},{key:"onToggleAppliance",value:function(e){this.setState({selectedAppliance:e})}},{key:"onChartTypeChange",value:function(e){this.setState({chartType:e})}},{key:"onActiveModeChange",value:function(e){this.setState({activeMode:e})}},{key:"resetStatus",value:function(){var e=this.props.controls;this.setState((0,E.Z)((0,E.Z)({},e),{},{activeMode:e.activeMode?e.activeMode:void 0}))}},{key:"onClose",value:function(){this.resetStatus(),this.props.handleModal(!1)}},{key:"render",value:function(){var e=this,t=this.props,a=t.enableApplianceSelection,i=t.enableGraphStyleSelection,n=t.enableModeSelection,s=t.enableRateSelection,o=t.enableDemandChargeSelection,r=t.getDetectedAppliances,l=t.detectedAppliances,c=t.open,d=t.allowedViews,u=t.applianceList,p=t.translations,f=t.onUpdateFilter,y=t.widgetName,v=t.configData,b=v.enableRateFilter,S=v["INSIGHTS.USAGE.TIER_TOU.VIEW"]||!1,T="boolean"===typeof a?a:a&&a(this.state.view),x=r?r(this.state.mode):l||[],A=F.V.getColors().colors,C=y===g.wY4.INSIGHTS.MONTHLY_SUMMARY,w=v["DASHBOARD.MONTHLY_SUMMARY.MS_LEFT_TOGGLE"],N=v["DASHBOARD.MONTHLY_SUMMARY.MS_RIGHT_TOGGLE"];return(0,D.jsxs)(Y.Z,{open:c,TransitionComponent:G,classes:{paper:"insights-usage-filter-dialog"},fullWidth:!0,maxWidth:"sm",onClose:this.onClose,children:[(0,D.jsxs)(U.Z,{classes:{root:"insights-usage-filter-header ".concat((0,m.wG)()?"insights-usage-filter-header-color-accessible":"")},children:[(0,D.jsx)(H.Z,{classes:{label:"insights-usage-filter-header-button"},onClick:this.onClose,children:p["DASHBOARD.FILTER_MODAL.BTN_CANCEL"]}),(0,D.jsx)("span",{className:"insights-usage-filter-header-label",children:p["DASHBOARD.FILTER_MODAL.TITLE"]}),(0,D.jsx)(H.Z,{classes:{label:"insights-usage-filter-header-button"},onClick:function(){return f(e.state)},children:p["DASHBOARD.FILTER_MODAL.BTN_DONE"]})]}),(0,D.jsxs)(R.Z,{classes:{root:"insights-usage-filter-content"},children:[d&&(0,D.jsxs)(P.Z,{classes:{root:"insights-filter-card-view"},children:[(0,D.jsx)(Z.Z,{classes:{body1:"view-by"},children:p["DASHBOARD.FILTER_MODAL.FITLER.VIEW_BY"]}),(0,D.jsx)(M.Z,{className:"insights-button-group",size:"large","data-widget-name":y,"data-bg-color":"primary_200",children:d.map((function(t){return(0,D.jsx)("div",{className:"insights-view-button","data-widget-name":y,"data-active-bg-color":"background_700","data-active-color":"background_300","data-text-color":"foreground_400",children:(0,D.jsx)(h.Z,{isActive:e.state.view===t,btnText:p["DASHBOARD.INSIGHT_USAGE_V2_VIEWS.".concat(t)],btnTextTransform:"none",textColor:"rgb(".concat(A["--foreground_400"],")"),borderColor:"transparent",activeColor:"rgb(".concat(A["--primary_500"],")"),activeTextColor:"rgb(".concat(A["--foreground_300"],")"),onClick:function(){return e.onViewChange(t)},hoverColor:"rgb(".concat(A["--background_300"],", 0.7)"),ariaChecked:e.state.view===t,role:"radio"},t)},t)}))})]}),T&&x.length&&(0,D.jsxs)(P.Z,{classes:{root:"insights-filter-card-view"},children:[(0,D.jsx)(Z.Z,{id:"appliance-toggle",classes:{body1:"view-by"},children:p["DASHBOARD.FILTER_MODAL.FILTER.APPLIANCE"]}),(0,D.jsx)("div",{className:"insights-filter-appliance-list","aria-labelledby":"appliance-toggle",children:x.map((function(t){return(0,D.jsx)(H.Z,{classes:{root:"insights-filter-appliance ".concat(parseInt(t)===parseInt(e.state.selectedAppliance)?"active":"")},onClick:function(){return e.onToggleAppliance(t)},"aria-checked":parseInt(t)===parseInt(e.state.selectedAppliance),role:"radio",children:u[t]},t)}))})]}),n&&n(this.state.view)&&(0,D.jsxs)(P.Z,{classes:{root:"insights-filter-card-view"},children:[(0,D.jsx)(Z.Z,{classes:{body1:"view-by"},children:p["DASHBOARD.FILTER_MODAL.FILTER.TIMESCALE"]}),(0,D.jsx)(M.Z,{size:"large",className:"insights-button-group mode","data-widget-name":y,"data-bg-color":"primary_200",children:Object.keys(g.DEY).map((function(t){return(0,D.jsx)("div",{className:"insights-view-button","data-widget-name":y,"data-active-bg-color":"background_700","data-active-color":"background_300","data-text-color":"foreground_400",children:(0,D.jsx)(h.Z,{isActive:e.state.mode===g.DEY[t],btnText:p["USAGE.MODE.".concat(t)],textColor:"rgb(".concat(A["--foreground_400"],")"),borderColor:"transparent",activeColor:"rgb(".concat(A["--primary_500"],")"),activeTextColor:"rgb(".concat(A["--foreground_300"],")"),onClick:function(){return e.onModeChange(g.DEY[t])},btnTextTransform:"none",hoverColor:"rgb(".concat(A["--background_300"],", 0.7)"),ariaChecked:e.state.mode===g.DEY[t],role:"radio"},t)},t)}))})]}),b&&(s&&s(this.state.view,S)||o&&o(this.state.view,S))&&(0,D.jsxs)(P.Z,{classes:{root:"insights-filter-card-view"},children:[(0,D.jsx)(Z.Z,{classes:{body1:"view-by"},children:p["DASHBOARD.FILTER_MODAL.FILTER.RATE"]}),(0,D.jsxs)(M.Z,{size:"large",className:"insights-button-group rate-view","data-widget-name":y,"data-bg-color":"primary_200",children:[s&&s(this.state.view,S)&&Object.keys(g.NMd).map((function(t){return(0,D.jsx)("div",{className:"insights-view-button wrap","data-widget-name":y,"data-active-bg-color":"background_700","data-active-color":"background_300","data-text-color":"foreground_400",children:(0,D.jsx)(h.Z,{isActive:e.state.timeOfUse===g.NMd[t].type,btnText:p["DASHBOARD.USAGE.TOU.".concat(g.NMd[t].type)],textColor:"rgb(".concat(A["--foreground_400"],")"),borderColor:"transparent",activeColor:"rgb(".concat(A["--primary_500"],")"),activeTextColor:"rgb(".concat(A["--foreground_300"],")"),onClick:function(){return e.onTOUChange(g.NMd[t].type)},btnTextTransform:"none",hoverColor:"rgb(".concat(A["--background_300"],", 0.7)"),ariaChecked:e.state.timeOfUse===g.NMd[t].type,role:"radio"},t)},t)})),o&&this.state.mode===g.DEY.YEAR&&o(this.state.view,S)&&(0,D.jsx)("div",{className:"insights-view-button wrap","data-widget-name":y,"data-active-bg-color":"background_700","data-active-color":"background_300","data-text-color":"foreground_400",children:(0,D.jsx)(h.Z,{isActive:this.state.timeOfUse===g.u0K.TYPE,btnText:g.u0K.NAME,textColor:"rgb(".concat(A["--foreground_400"],")"),borderColor:"transparent",activeColor:"rgb(".concat(A["--primary_500"],")"),activeTextColor:"rgb(".concat(A["--foreground_300"],")"),onClick:function(){return e.onTOUChange(g.u0K.TYPE)},btnTextTransform:"none",hoverColor:"rgb(".concat(A["--background_300"],", 0.7)"),ariaChecked:this.state.timeOfUse===g.u0K.TYPE,role:"radio"},g.u0K.TYPE)},g.u0K.TYPE)]})]}),i&&i(this.state.mode,this.state.view)&&(0,D.jsxs)(P.Z,{classes:{root:"insights-filter-card-view"},children:[(0,D.jsx)(Z.Z,{classes:{body1:"view-by"},children:p["DASHBOARD.FILTER_MODAL.FILTER.DISPLAY"]}),(0,D.jsx)(M.Z,{size:"large",className:"insights-button-group","data-widget-name":y,"data-bg-color":"primary_200",children:Object.keys(g.LPx).map((function(t){return(0,D.jsx)("div",{className:"insights-view-button","data-widget-name":y,"data-active-bg-color":"background_700","data-active-color":"background_300","data-text-color":"foreground_400",children:(0,D.jsx)(h.Z,{isActive:e.state.graphStyle===g.LPx[t],btnText:p["USAGE.GRAPH_STYLE.".concat(t)],textColor:"rgb(".concat(A["--foreground_400"],")"),borderColor:"transparent",activeColor:"rgb(".concat(A["--primary_500"],")"),activeTextColor:"rgb(".concat(A["--foreground_300"],")"),onClick:function(){return e.onGraphStyleChange(g.LPx[t])},btnTextTransform:"none",hoverColor:"rgb(".concat(A["--background_300"],", 0.7)"),ariaChecked:e.state.graphStyle===g.LPx[t],role:"radio"},t)},t)}))})]}),C&&(0,D.jsxs)(D.Fragment,{children:[(0,D.jsxs)(P.Z,{classes:{root:"insights-filter-card-view"},children:[(0,D.jsx)(Z.Z,{classes:{body1:"view-by"},children:p["DASHBOARD.FILTER_MODAL.FILTER.DISPLAY"]}),(0,D.jsx)(M.Z,{size:"large",className:"insights-button-group","data-widget-name":y,"data-bg-color":"primary_200",children:Object.keys(g.al9).map((function(t){return(0,D.jsx)("div",{className:"insights-view-button","data-widget-name":y,"data-bg-color":"primary_200","data-text-color":"foreground_500","data-active-bg-color":"background_300",children:(0,D.jsx)(h.Z,{isActive:e.state.chartType===g.al9[t],btnBackground:"rgba(".concat(A["--primary_200"],", 0.48)"),btnText:p["MONTHLY_SUMMARY.CHART.".concat(t)],textColor:"rgb(".concat(A["--foreground_500"],")"),borderColor:"transparent",btnTextTransform:"none",activeColor:"".concat(((0,m.IR)(),"rgb(".concat(A["--primary_500"],")"))),activeTextColor:"".concat(((0,m.IR)(),"rgb(".concat(A["--foreground_300"],")"))),onClick:function(){return e.onChartTypeChange(g.al9[t])},ariaChecked:e.state.chartType===g.al9[t],role:"radio"})},t)}))})]}),v["DASHBOARD.MONTHLY_SUMMARY.TOGGLE_ENABLED"]&&(0,D.jsxs)(P.Z,{classes:{root:"insights-filter-card-view"},children:[(0,D.jsx)(Z.Z,{classes:{body1:"view-by"},children:p["DASHBOARD.FILTER_MODAL.FILTER.USAGE"]}),(0,D.jsxs)(M.Z,{size:"large",className:"insights-button-group","data-widget-name":y,"data-bg-color":"primary_200",children:[(0,D.jsx)("div",{className:"insights-view-button","data-widget-name":y,"data-bg-color":"primary_200","data-text-color":"foreground_500","data-active-bg-color":"background_300",children:(0,D.jsx)(h.Z,{isActive:this.state.activeMode===w,btnBackground:"rgba(".concat(A["--primary_200"],", 0.48)"),btnText:(0,m.pB)(w,v),textColor:"rgb(".concat(A["--foreground_500"],")"),borderColor:"transparent",btnTextTransform:"none",activeColor:"rgb(".concat(A["--primary_500"],")"),activeTextColor:"rgb(".concat(A["--foreground_300"],")"),onClick:function(){return e.onActiveModeChange(w)},ariaChecked:this.state.activeMode===w,role:"radio"})}),(0,D.jsx)("div",{className:"insights-view-button","data-widget-name":y,"data-bg-color":"primary_200","data-text-color":"foreground_500","data-active-bg-color":"background_300",children:(0,D.jsx)(h.Z,{isActive:this.state.activeMode===N,btnBackground:"rgba(".concat(A["--primary_200"],", 0.48)"),btnText:(0,m.pB)(N,v),textColor:"rgb(".concat(A["--foreground_500"],")"),borderColor:"transparent",btnTextTransform:"none",activeColor:"rgb(".concat(A["--primary_500"],")"),activeTextColor:"rgb(".concat(A["--foreground_300"],")"),onClick:function(){return e.onActiveModeChange(N)},ariaChecked:this.state.activeMode===N,role:"radio"})})]})]})]})]})]})}}]),a}(r.Component),z=function(e){(0,s.Z)(a,e);var t=(0,o.Z)(a);function a(e){var n;return(0,i.Z)(this,a),(n=t.call(this,e)).state={noData:!1,openFilter:!1},n.toggleChartType=n.toggleChartType.bind((0,l.Z)(n)),n.toggleModeType=n.toggleModeType.bind((0,l.Z)(n)),n.handleFilterModal=n.handleFilterModal.bind((0,l.Z)(n)),n.onUpdateFilter=n.onUpdateFilter.bind((0,l.Z)(n)),n}return(0,n.Z)(a,[{key:"componentDidMount",value:function(){this.props.monthlySummaryData.activeMode||this.props.updateActiveMode(this.props.configData["DASHBOARD.MONTHLY_SUMMARY.DEFAULT_MODE"]),this.handleFilterModal=this.handleFilterModal.bind(this),this.onUpdateFilter=this.onUpdateFilter.bind(this);var e=this.props.configData["DASHBOARD.MONTHLY_SUMMARY.DEFAULT_CHART_TYPE"];e&&this.props.updateActiveChartType({activeChartType:e})}},{key:"toggleChartType",value:function(e){this.props.monthlySummaryData.activeChartType!==e&&(this.props.updateActiveChartType({activeChartType:e}),this.context.rc.analytics.trackEvent(g.FiA.INSIGHTS,{clicked:"usageChartToggle",chart:e,shown:g.Q2X.MONTHLY_SUMMARY,widget:g.wY4.INSIGHTS.MONTHLY_SUMMARY,version:g.zZZ.V1}))}},{key:"toggleModeType",value:function(){var e=this.props.monthlySummaryData.activeMode===this.props.configData["DASHBOARD.MONTHLY_SUMMARY.MS_LEFT_TOGGLE"]?this.props.configData["DASHBOARD.MONTHLY_SUMMARY.MS_RIGHT_TOGGLE"]:this.props.configData["DASHBOARD.MONTHLY_SUMMARY.MS_LEFT_TOGGLE"];this.context.rc.analytics.trackEvent(g.FiA.INSIGHTS,{clicked:g.GNf.USAGE_COST_TOGGLE,type:e,shown:g.Q2X.MONTHLY_SUMMARY,widget:g.wY4.INSIGHTS.MONTHLY_SUMMARY,version:g.zZZ.V1}),this.props.updateActiveMode(e)}},{key:"handleFilterModal",value:function(e){this.setState({openFilter:e})}},{key:"onUpdateFilter",value:function(e){var t=this.props.monthlySummaryData;e.activeMode!==t.activeMode&&this.toggleModeType(),this.toggleChartType(e.chartType),this.setState({openFilter:!1})}},{key:"render",value:function(){var e=this,t=this.props,a=t.monthlySummaryData,i=t.configColors,n=t.isMobileView,s=t.fetchBillingCycleData,o=t.translationsData,r=a.activeMode||"",l=this.props.configData["DASHBOARD.MONTHLY_SUMMARY.MS_LEFT_TOGGLE"],c=this.props.configData["DASHBOARD.MONTHLY_SUMMARY.MS_RIGHT_TOGGLE"],d=this.props.session.userProfile.fuelType.toLowerCase(),u=a.monthlySummaryDataArray[a.monthlySummaryActiveIndex],p="".concat((0,m.Yr)(u.itemizationDetails.startDateFormatted,g.DEY.YEAR,this.props.configData,n)," - ").concat((0,m.Yr)(u.itemizationDetails.endDateFormatted,g.DEY.YEAR,this.props.configData,n)),f={chartType:a.activeChartType,activeMode:r},y=o["MONTHLY_SUMMARY.TITLE"],v=(!u.itemizationDetails||!u.itemizationDetails[d])&&!a.fetchingData;return(0,D.jsxs)(D.Fragment,{children:[n&&(0,D.jsx)(I.Z,{enableLeftArrow:!a.leftArrowDisabled,enableRightArrow:!a.rightArrowDisabled,intervalDetails:p,handleArrowClick:s,handleModal:this.handleFilterModal,widgetName:g.wY4.INSIGHTS.BILL_ANALYSIS,title:y,direction:1,translations:o,configs:this.props.configData}),n&&(0,D.jsx)(B,{open:this.state.openFilter,controls:f,handleModal:this.handleFilterModal,onUpdateFilter:this.onUpdateFilter,widgetName:g.wY4.INSIGHTS.MONTHLY_SUMMARY,configData:this.props.configData,translations:o,toggleChartType:this.toggleChartType,toggleModeType:this.toggleModeType}),(0,D.jsxs)("div",{className:"content-wrapper",children:[!n&&(0,D.jsxs)("div",{className:"chart-options "+(u.itemizationDetails&&u.itemizationDetails[d]?"":"no-data"),"aria-hidden":!u.itemizationDetails||!u.itemizationDetails[d],children:[(0,D.jsxs)(M.Z,{size:"large",className:"ms-chart-button-group",tabIndex:v?-1:0,"data-widget-name":g.wY4.INSIGHTS.MONTHLY_SUMMARY,"data-bg-color":"primary_200",children:[(0,D.jsx)("div",{"data-widget-name":g.wY4.INSIGHTS.MONTHLY_SUMMARY,"data-bg-color":"primary_200","data-text-color":"foreground_500","data-active-bg-color":"background_300",children:(0,D.jsx)(h.Z,{isActive:"Bar"===a.activeChartType,btnBackground:"rgba(".concat(i["--primary_200"],", 0.48)"),btnText:o["MONTHLY_SUMMARY.CHART.BAR"],textColor:"".concat("Bar"===a.activeChartType?"rgb(".concat(i["--foreground_300"],")"):"rgb(".concat(i["--foreground_500"],")")),borderColor:"transparent",btnTextTransform:"none",btnWidth:"119px",activeColor:"rgb(".concat(i["--primary_500"],")"),tabIndex:v?-1:0,onClick:function(){return e.toggleChartType("Bar")},disableRipple:!0})}),(0,D.jsx)("div",{"data-widget-name":g.wY4.INSIGHTS.MONTHLY_SUMMARY,"data-bg-color":"primary_200","data-text-color":"foreground_500","data-active-bg-color":"background_300",children:(0,D.jsx)(h.Z,{isActive:"Pie"===a.activeChartType,btnBackground:"rgba(".concat(i["--primary_200"],", 0.48)"),btnText:o["MONTHLY_SUMMARY.CHART.PIE"],textColor:"".concat("Pie"===a.activeChartType?"rgb(".concat(i["--foreground_300"],")"):"rgb(".concat(i["--foreground_500"],")")),borderColor:"transparent",btnTextTransform:"none",btnWidth:"119px",activeColor:"rgb(".concat(i["--primary_500"],")"),tabIndex:v?-1:0,onClick:function(){return e.toggleChartType("Pie")},disableRipple:!0})})]}),this.props.configData["DASHBOARD.MONTHLY_SUMMARY.TOGGLE_ENABLED"]&&(0,D.jsxs)("div",{className:"ms-unit-toggle-container",tabIndex:v?-1:0,"data-widget-name":g.wY4.INSIGHTS.MONTHLY_SUMMARY,"data-bg-color":"primary_200","data-text-color":"foreground_500","data-icon-color":"foreground_400","data-active-color":"primary_500",children:[(0,D.jsx)("span",{className:"icon left "+(r===l?"active":""),children:(0,m.pB)(l,this.props.configData)}),(0,D.jsx)(T.Z,{focusVisibleClassName:"focus-visible",classes:{thumb:"ms-filter-thumb",track:"ms-filter-track",checked:"ms-filter-checked",colorSecondary:"ms-filter-color-secondary"},checked:r===c,onChange:function(){return e.toggleModeType()},value:r,inputProps:{"aria-label":o["DASHBOARD.LABEL.MS_TOGGLE"],role:"switch",tabIndex:v?-1:0}}),(0,D.jsx)("span",{className:"icon right "+(r===c?"active":""),children:(0,m.pB)(c,this.props.configData)})]})]}),(0,D.jsx)("div",{className:"chart-container",children:a.fetchingData?(0,D.jsx)("div",{className:"ms-data-loading",children:(0,D.jsx)(j.Z,{})}):0!==a.monthlySummaryDataArray.length&&"Pie"===a.activeChartType?(0,D.jsx)(_,{itemizationData:u,mode:a.activeMode,totalText:o["COMMON.TOTAL_TEXT"],appliancesList:this.props.appliancesList,fuelType:d,configColors:i,disableAda:v}):(0,D.jsx)(N,{itemizationData:u,mode:a.activeMode,appliancesList:this.props.appliancesList,fuelType:d,translationsData:o,isMobileView:n,configColors:i,disableAda:v})}),v?(0,D.jsx)("div",{className:"no-data-disclaimer","data-widget-name":g.wY4.INSIGHTS.MONTHLY_SUMMARY,"data-text-color":"foreground_400",children:u.itemizationDisclaimer}):"",""!==o.CHART_DISCLAIMER&&(0,D.jsx)("div",{className:"disclaimer-msg","data-widget-name":g.wY4.INSIGHTS.MONTHLY_SUMMARY,"data-text-color":"foreground_400",children:o.CHART_DISCLAIMER})]})]})}}]),a}(r.Component);z.contextType=v.zO;var V=(0,u.EN)((0,c.$j)((function(e){return{session:e.session,monthlySummaryData:e.monthlySummaryData,userId:e.session.userProfile.userId,configData:e.configs.data,translationsData:e.translationsData.data,appliancesList:e.appliances.appliancesList,queryParams:e.queryParams}}),(function(e){return{fetchMonthlySummaryData:function(t,a,i,n,s){return e((0,O.O)(t,a,i,n,s))},updateActiveChartType:function(t){return e((0,k.w3)(t))},updateActiveMode:function(t){return e((0,k.Ft)(t))},fetchingData:function(){return e((0,k.QC)())}}}))(z)),W=a(97240),K=a(74813),q=a(34582),Q=function(e){(0,s.Z)(a,e);var t=(0,o.Z)(a);function a(e){var n;return(0,i.Z)(this,a),(n=t.call(this,e)).configColors=F.V.getColors().colors,n.fetchBillingCycleData=n.fetchBillingCycleData.bind((0,l.Z)(n)),n}return(0,n.Z)(a,[{key:"fetchBillingCycleData",value:function(e){var t=this,a=this.props.monthlySummaryData.monthlySummaryDataArray[0].itemizationDetails;if(this.context.rc.analytics.trackEvent(g.FiA.INSIGHTS,{shown:g.Q2X.MONTHLY_SUMMARY,clicked:"".concat(1===e?g.JYL.RIGHT:g.JYL.LEFT,"-arrow"),intervalStart:a.startTs,intervalEnd:a.endTs,widget:g.wY4.INSIGHTS.MONTHLY_SUMMARY,version:g.zZZ.V1}),this.props.monthlySummaryData.monthlySummaryDataArray[this.props.monthlySummaryData.monthlySummaryActiveIndex+e])this.props.fetchingData(),setTimeout((function(){t.props.updateActiveIndex(e,t.props.session.userProfile.fuelType)}),100);else{this.props.fetchingData();var i=this.props.monthlySummaryData.monthlySummaryDataArray[this.props.monthlySummaryData.monthlySummaryActiveIndex],n={locale:this.props.locale,"measurement-type":(0,m.nY)(this.props.session.userProfile.fuelType),"date-format":this.props.configData.date_format,"highest-day-date-format":this.props.configData.highest_day_date_format};1===e?(n["bill-start"]=i.nextBillStart,n["bill-end"]=i.nextBillEnd,n["next-bill-cycle"]=!0):(n["bill-start"]=i.previousBillStart,n["bill-end"]=i.previousBillEnd,n["next-bill-cycle"]=!1),(0,K.JF)()&&(n.templateName="".concat(g.wY4.HOME.CONSUMPTION_BREAKDOWN,".FETCH_MONTHLY_SUMMARY_DATA")),this.props.fetchMonthlySummaryData(this.context.rc,this.props.userId,n,!0,this.props.session.userProfile.fuelType)}}},{key:"render",value:function(){var e=this.props,t=e.monthlySummaryData,a=e.translationsData,i=e.isMobileView,n=t.monthlySummaryDataArray[t.monthlySummaryActiveIndex].itemizationDetails,s=a["MONTHLY_SUMMARY.TITLE"];return(0,D.jsxs)(D.Fragment,{children:[!i&&(0,D.jsxs)("div",{className:"ms-header",children:[s&&(0,D.jsx)("div",{className:"ms-title","data-widget-name":g.wY4.INSIGHTS.MONTHLY_SUMMARY,"data-text-color":"foreground_500",children:s}),(0,D.jsx)(W.Z,{widgetName:g.wY4.INSIGHTS.MONTHLY_SUMMARY,enableLeftArrow:!t.leftArrowDisabled,enableRightArrow:!t.rightArrowDisabled,intervalDetails:"".concat((0,m.Yr)(n.startDateFormatted,g.DEY.YEAR,this.props.configData,i)," - ").concat((0,m.Yr)(n.endDateFormatted,g.DEY.YEAR,this.props.configData,i)),handleArrowClick:this.fetchBillingCycleData,direction:1,translations:a})]}),(0,D.jsxs)("div",{className:"insights-ms-content",children:[(0,D.jsx)("div",{className:"ms-chart",children:(0,D.jsx)(V,{isMobileView:i,fetchBillingCycleData:this.fetchBillingCycleData,configColors:this.configColors})}),(0,D.jsx)("div",{className:"ms-details",children:(0,D.jsx)(S,{isMobileView:i,configColors:this.configColors,configs:this.props.configData,setSurveyV2Modal:this.props.setSurveyV2Modal})})]})]})}}]),a}(r.Component);Q.contextType=v.zO;var $=(0,c.$j)((function(e){return{session:e.session,monthlySummaryData:e.monthlySummaryData,translationsData:e.translationsData.data,configData:e.configs.data,locale:e.configs.locale,userId:e.session.userProfile.userId}}),(function(e){return{fetchMonthlySummaryData:function(t,a,i,n,s){return e((0,O.O)(t,a,i,n,s))},fetchingData:function(){return e((0,k.QC)())},updateActiveIndex:function(t,a){return e((0,k.fp)(t,a))},setSurveyV2Modal:function(){return e((0,q._t)())}}}))(Q),X=function(e){(0,s.Z)(a,e);var t=(0,o.Z)(a);function a(){return(0,i.Z)(this,a),t.apply(this,arguments)}return(0,n.Z)(a,[{key:"componentDidMount",value:function(){if(this.widgetTrackingInfo=this.context.rc.analytics.createWidgetInfo(g.xDZ.INSIGHTS_MS),this.context.rc.analytics.trackEvent(g.FiA.INSIGHTS,{viewed:!0,shown:g.Q2X.MONTHLY_SUMMARY,version:g.zZZ.V1},this.props),0===this.props.monthlySummaryData.monthlySummaryDataArray.length){var e={"date-format":this.props.configData.date_format,"highest-day-date-format":this.props.configData.highest_day_date_format,locale:this.props.locale,"measurement-type":(0,m.nY)(this.props.session.userProfile.fuelType)};(0,K.JF)()&&(e.templateName="".concat(g.wY4.INSIGHTS.MONTHLY_SUMMARY,".FETCH_MONTHLY_SUMMARY_DATA")),this.props.fetchingData(),this.props.fetchMonthlySummaryData(this.context.rc,this.props.userId,e,!1,this.props.session.userProfile.fuelType)}}},{key:"componentDidUpdate",value:function(e){if(this.widgetTrackingInfo&&e.monthlySummaryData.fetchingData&&!this.props.monthlySummaryData.fetchingData){var t=this.props.monthlySummaryData.apiFailed?g.WW8.ERROR:this.props.monthlySummaryData.monthlySummaryDataArray.length?g.WW8.SUCCESS:g.WW8.DATA_NOT_AVAILABLE,a=this.props.monthlySummaryData.errorInfo;this.context.rc.analytics.logWidgetInfo(this.widgetTrackingInfo,t,a),this.widgetTrackingInfo=null}}},{key:"render",value:function(){var e=this.props,t=e.monthlySummaryData,a=e.responsiveness.isMobileView;return(0,D.jsx)("div",{className:"insights-ms-inner-container ".concat((0,m.wG)()?"accessible-color-insights-ms":""),children:0!==t.monthlySummaryDataArray.length?(0,D.jsx)($,{isMobileView:a}):t.apiFailed?(0,D.jsx)("div",{className:"error-page",children:(0,D.jsx)("div",{className:"error-msg",tabIndex:0,children:this.props.translationsData["MONTHLY_SUMMARY.DATA_NOT_AVAILABLE"]})}):(0,D.jsx)(j.Z,{})})}}]),a}(r.Component);X.contextType=v.zO;var J=(0,u.EN)((0,c.$j)((function(e){return{session:e.session,monthlySummaryData:e.monthlySummaryData,userId:e.session.userProfile.userId,configData:e.configs.data,locale:e.configs.locale,translationsData:e.translationsData.data,queryParams:e.queryParams,configs:e.configs,responsiveness:e.responsiveness}}),(function(e){return{fetchMonthlySummaryData:function(t,a,i,n,s){return e((0,O.O)(t,a,i,n,s))},fetchingData:function(){return e((0,k.QC)())}}}))(X))},9998:function(e,t,a){a.r(t),a.d(t,{default:function(){return q}});var i=a(15671),n=a(43144),s=a(97326),o=a(60136),r=a(98557),l=a(47313),c=a(1413),d=a(1084),h=a(54495),u=a(6377),p=a(21911),g=a(70501),m=a(16404),f=a(56955),y=a(41294),v=a(69140),D=a(57284),b=a(14427),S=a(89269),M=a(37762),T=a(34862),x=a(317),A=a(27507),C=a(73428),w=a(76720),N=a(46417);function _(e){var t,a=e.fuelType,i=(0,w.WS)().runMode===m.K8z,n=e.itemizationData.itemizationDetails[a],s=(0,y.kz)(e.showAllAppliances,e.singleChart||e.isMobileView,n,e.mode,!n),o=[],r=(0,M.Z)(s);try{for(r.s();!(t=r.n()).done;){var l=t.value,d=(0,x.cZ)(l.chartHeight,e.isMobileView,i);(0,f.IR)()&&(d.accessibility=(0,x.jb)(e.mode,e.appliancesList,e.fuelType,e.translationsData,e.showError)),d.series=(0,x.fD)(e.mode,l.lowLightData,l.highlightData,e.appliancesList,e.fuelType),o.push(d)}}catch(p){r.e(p)}finally{r.f()}var h=n?"":T.w1||T.G6?"ie-no-data":"no-data",u=!e.isMobileView&&!e.singleChart&&1===o.length;return(0,N.jsx)("div",{className:"ms-bar-chart-container","data-widget-name":m.wY4.INSIGHTS.MONTHLY_SUMMARY,"data-show-appliances-colors":"true",children:(0,N.jsxs)("div",{className:"ms-bar-chart "+h,children:[o.map((function(t,a){return(0,N.jsx)("div",{role:"group",className:"ms-bar-chart-inner ".concat(e.isMobileView?"mobile":""),children:(0,N.jsx)(A.Z,(0,c.Z)({options:t,immutable:!0,widgetConfigs:e.widgetConfigs,widgetStrings:e.widgetStrings,isModalTableEnabled:e.isModalTableEnabled,isInsights:!0,handleADA:e.handleADA,monthlyData:o,excludeModal:0!==a,adaModalTitle:e.isSolar?e.widgetStrings.titleSolar:e.widgetStrings.title,liveAnnouncerMsg:e.liveAnnouncerMsg},e))},a)})),u&&(0,N.jsx)("div",{className:"ms-chart-faq-container",children:(0,N.jsx)(C.Z,{raised:!0,children:(0,N.jsx)(S.Z,{widgetConfigs:e.widgetConfigs.faqModal,widgetStrings:e.widgetStrings.faqModal,configColors:e.configColors,goToFaq:e.goToFaq,isSolar:e.isSolar,disableAda:e.showError,isAccessibility:f.wG})})})]})})}var O=function(e){(0,o.Z)(a,e);var t=(0,r.Z)(a);function a(e){var n;return(0,i.Z)(this,a),(n=t.call(this,e)).state={seriesData:null,slicedSeriesData:null,totalCostOrConsumption:null,mode:null,noData:!1},n.chart=null,n}return(0,n.Z)(a,[{key:"componentDidUpdate",value:function(e,t){if(t.mode!==this.state.mode&&this.chart&&this.chart.pieCenterText){var a=this.state.mode,i=this.props.isSolar||a!==m.AgQ.USAGE?null:this.props.totalText;this.chart.pieCenterText.attr({text:(0,x.sO)(a,i,this.state.totalCostOrConsumption,this.props.fuelType,!1)}),this.chart.redraw()}}},{key:"chartCallback",value:function(e){this.chart=e}},{key:"render",value:function(){var e=this,t=this.props.responsiveness,a=t.isDesktop,i=t.isLargeDesktop,n=this.state.mode,s=this.state.totalCostOrConsumption,o=this.state.seriesData.length,r=a||i?300:o>=10?500:"auto",l=Math.ceil(o/2),d=this.props.isSolar||n!==m.AgQ.USAGE?null:this.props.totalText,h=o<10?300+25*l:"auto",u=(0,x.cU)(s,n,!1,d,r,this.props.fuelType,!0,this.props.showError),p=(0,x.El)(window.innerWidth-52),g=p.itemTextWidth,f=p.itemWidth;return u.responsive={rules:[{condition:{minWidth:800},chartOptions:{legend:{itemStyle:{fontSize:"18px"}}}},{condition:{maxWidth:800},chartOptions:{legend:{x:0},series:(0,x.HL)(this.state.slicedSeriesData,this.state.seriesData,this.state.slicedSeriesData,m.fPC.MEDIUM)}},{condition:{maxWidth:490},chartOptions:{legend:{x:40},series:(0,x.HL)(this.state.slicedSeriesData,this.state.seriesData,this.state.slicedSeriesData,m.fPC.SMALL)}},{condition:{maxWidth:400},chartOptions:{chart:{animation:!1,height:h},plotOptions:{pie:{center:[null,90]}},legend:{itemStyle:{fontSize:"11px",lineHeight:"15px",width:g-20},align:"center",verticalAlign:"bottom",layout:"horizontal",alignColumns:!0,itemWidth:f,width:"auto",x:0,padding:0,useHTML:!0,itemMarginTop:0,itemMarginBottom:10},series:(0,x.HL)(this.state.slicedSeriesData,this.state.seriesData,this.state.slicedSeriesData,m.fPC.SMALL)}},{condition:{maxWidth:300},chartOptions:{chart:{animation:!1,height:h},plotOptions:{pie:{center:[null,90]}},legend:{itemStyle:{fontSize:"11px",lineHeight:"15px",width:g-20},align:"center",verticalAlign:"bottom",layout:"horizontal",alignColumns:!0,itemWidth:f,width:"auto",x:0,useHTML:!0,padding:3,itemMarginTop:0,itemMarginBottom:10},series:(0,x.HL)(this.state.slicedSeriesData,this.state.seriesData,this.state.slicedSeriesData,m.fPC.SMALL)}}]},u.series=(0,x.HL)(this.state.slicedSeriesData,this.state.seriesData,this.state.slicedSeriesData,m.fPC.LARGE_V2),(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)("svg",{height:"0",width:"0","aria-hidden":"true",children:(0,N.jsxs)("defs",{children:[(0,N.jsxs)("filter",{id:"blurFilter2",y:"-20",height:"500",x:"-20",width:"120",children:[(0,N.jsx)("feOffset",{in:"SourceGraphic",dx:"0",dy:"0",result:"offOut"}),(0,N.jsx)("feGaussianBlur",{in:"offOut",stdDeviation:"10",result:"blur2"}),(0,N.jsxs)("feMerge",{children:[(0,N.jsx)("feMergeNode",{in:"blur2"}),(0,N.jsx)("feMergeNode",{in:"SourceGraphic"})]})]}),(0,N.jsxs)("filter",{id:"filter",y:"-20",height:"500",x:"-20",width:"150",children:[" ",(0,N.jsx)("feOffset",{in:"SourceGraphic",dx:"0",dy:"0"})," ",(0,N.jsx)("feGaussianBlur",{stdDeviation:"10",result:"DROP"})," ",(0,N.jsx)("feComposite",{in:"DROP",operator:"in",result:"SHADOW1"})," ",(0,N.jsxs)("feComponentTransfer",{in:"SHADOW1",result:"SHADOW",children:[" ",(0,N.jsx)("feFuncA",{type:"table",tableValues:"0 1.2"})," "]})," ",(0,N.jsxs)("feMerge",{children:[" ",(0,N.jsx)("feMergeNode",{in:"SHADOW"})," ",(0,N.jsx)("feMergeNode",{in:"SourceGraphic"})," "]})," "]})]})}),(0,N.jsx)("div",{className:"ms-pie-chart "+(this.state.noData?T.w1||T.G6||T.tq?"ie-no-data ":"no-data ":"")+(!T.w1&&!T.G6&&!T.tq&&" chart-filter"),"data-widget-name":m.wY4.INSIGHTS.MONTHLY_SUMMARY,"data-show-appliances-colors":"true",children:null!=this.state.seriesData&&s?(0,N.jsx)(A.Z,(0,c.Z)({options:u,oneToOne:!0,updateArgs:[!0],callback:function(t){e.chartCallback(t)},monthlyData:!0,isInsights:!0,adaModalTitle:this.props.isSolar?this.props.widgetStrings.titleSolar:this.props.widgetStrings.title,liveAnnouncerMsg:this.props.liveAnnouncerMsg},this.props)):""})]})}}],[{key:"getDerivedStateFromProps",value:function(e,t){var a=e.fuelType,i=!e.itemizationData.itemizationDetails[a],n=(0,y.$R)(e.itemizationData,e.mode,e.appliancesList,e.fuelType,null,!1);return n.seriesData!==t.seriesData||n.slicedSeriesData!==t.seriesData||n.totalCostOrConsumption!==t.totalCostOrConsumption||e.mode!==t.mode?{seriesData:n.seriesData,slicedSeriesData:n.slicedSeriesData,totalCostOrConsumption:(0,f.rK)(e.widgetConfigs,e.isSolar)&&e.mode!==m.AgQ.USAGE?n.energyCost:n.totalCostOrConsumption,mode:e.mode,noData:i}:null}}]),a}(l.Component),k=null,j=function(e){(0,o.Z)(a,e);var t=(0,r.Z)(a);function a(e){var n;return(0,i.Z)(this,a),(n=t.call(this,e)).openFooterDialog=function(){n.setState({openModal:!0}),k=n.footerEl.current},n.closeFooterDialog=function(){n.setState({openModal:!1}),k&&k.focus()},n.footerEl=l.createRef(),n.state={showAllAppliances:!0,singleChart:!1,openModal:!1},n}return(0,n.Z)(a,[{key:"componentDidUpdate",value:function(){this.props.isMobileView&&(0,f.ku)(!this.state.openModal)}},{key:"componentWillUnmount",value:function(){this.props.isMobileView&&(0,f.ku)(!0)}},{key:"onWidthChange",value:function(){var e=window.innerWidth<800;this.state.singleChart!==e&&this.setState({singleChart:e,showAllAppliances:!e})}},{key:"showAllAppliancesToggle",value:function(){this.setState({showAllAppliances:!0})}},{key:"getLiveAnnouncerMsg",value:function(e,t,a){var i,n=e.monthlySummaryDataArray[e.monthlySummaryActiveIndex];return e.fetchingData?i=this.props.widgetStrings.loadingLabel:t?i=n.itemizationDisclaimer:t||(i=(0,f.Z7)(this.props.widgetStrings.showingDataLabel,{interval:a})),i}},{key:"render",value:function(){var e=this,t=this.props,a=t.monthlySummaryData,i=t.translationsData,n=t.isMobileView,s=t.showHelperFooter,o=t.widgetStrings,r=t.widgetConfigs,l=this.props.session.userProfile.fuelType.toLowerCase(),c=a.monthlySummaryDataArray[a.monthlySummaryActiveIndex],d=!!c.itemizationDetails[l]&&c.itemizationDetails[l].length>m.Xn2,h=(0,y.Bo)(a,c,l),p=a.autoVoiceOver?this.getLiveAnnouncerMsg(a,h,this.props.intervalDetails):"",M=(0,f.rK)(r,this.props.isSolar),T=(0,y.$R)(c,a.activeMode,null,l,null,M,i["MONTHLY_SUMMARY.FULL_BILL.OTHER_CHARGES"]);return(0,N.jsx)(u.Z,{bounds:!0,onResize:function(){setTimeout((function(){e.onWidthChange()}),100)},children:function(t){var u=t.measureRef;return(0,N.jsxs)("div",{ref:u,className:"content-wrapper",children:[(0,N.jsxs)("div",{className:"chart-container ".concat(h?"no-data":""),children:[(0,N.jsx)(D.Z,{msg:p}),a.fetchingData?(0,N.jsx)("div",{className:"ms-data-loading",children:(0,N.jsx)(b.Z,{})}):0!==a.monthlySummaryDataArray.length&&"Pie"===a.activeChartType?(0,N.jsx)(O,{widgetConfigs:r,widgetStrings:o,isMobileView:n,itemizationData:c,mode:a.activeMode,monthlySummaryData:a,totalText:o.totalUsageLabel,appliancesList:e.props.appliancesList,showAllAppliances:e.state.showAllAppliances,fuelType:l,configs:e.props.configs,goToFaq:e.props.goToFaq,configColors:e.props.configColors,isModalTableEnabled:e.props.isModalTableEnabled,handleADA:e.props.handleADA,widgetName:e.props.widgetName,enableLeftArrow:e.props.enableLeftArrow,enableRightArrow:e.props.enableRightArrow,intervalDetails:e.props.intervalDetails,liveAnnouncerMsg:p,handleArrowClick:e.props.handleArrowClick,translations:e.props.translations,errorMessage:c.itemizationDisclaimer,showError:h,isSolar:e.props.isSolar,currentRef:e.props.currentRef,responsiveness:e.props.responsiveness,widgetData:T}):(0,N.jsx)(_,{widgetConfigs:r,widgetStrings:o,isMobileView:n,itemizationData:c,mode:a.activeMode,appliancesList:e.props.appliancesList,fuelType:l,translationsData:i,showAllAppliances:e.state.showAllAppliances,singleChart:e.state.singleChart,goToFaq:e.props.goToFaq,configColors:e.props.configColors,isModalTableEnabled:e.props.isModalTableEnabled,handleADA:e.props.handleADA,widgetName:e.props.widgetName,enableLeftArrow:e.props.enableLeftArrow,enableRightArrow:e.props.enableRightArrow,intervalDetails:e.props.intervalDetails,liveAnnouncerMsg:p,handleArrowClick:e.props.handleArrowClick,translations:e.props.translations,configs:e.props.configs,monthlySummaryData:a,errorMessage:c.itemizationDisclaimer,showError:h,isSolar:e.props.isSolar,currentRef:e.props.currentRef,widgetData:T}),!a.fetchingData&&s&&(0,N.jsxs)("div",{className:"ms-footer",children:[e.state.openModal?(0,N.jsxs)("div",{className:"dialog ".concat(n?"custom-dialog-box":""),"aria-labelledby":"header",children:[(0,N.jsx)("div",{className:"dialog-window",children:(0,N.jsx)(g.Z,{className:"popup-root",elevation:3,children:(0,N.jsx)(S.Z,{widgetConfigs:r.faqModal,widgetStrings:o.faqModal,isMobileView:n,configs:e.props.configs,configColors:e.props.configColors,goToFaq:e.props.goToFaq,getParent:e.props.getParent,isAccessibility:e.props.isAccessibility,open:e.state.openModal,closeFooterDialog:e.closeFooterDialog,headerId:"header",isModal:!0})})}),e.state.openModal&&(0,N.jsx)("div",{onClick:e.closeFooterDialog,className:"dialog-mask"})]}):"",(0,N.jsxs)("span",{role:"link",ref:e.footerEl,onClick:function(t){return e.openFooterDialog(t)},onKeyPress:function(t){return e.openFooterDialog(t)},"aria-hidden":h,tabIndex:h?-1:0,className:"".concat((0,f.IR)()?"ada-focus":""),children:[o.faqLabel,(0,N.jsx)("span",{className:"tooltip bidgely-icon-faq"})]})]}),d&&!e.state.showAllAppliances&&"Pie"!==a.activeChartType&&(0,N.jsx)("div",{className:"ms-appliance-toggle",children:(0,N.jsx)(v.Z,{btnText:o.showMoreAppsLabel,btnWidth:"50%",disableRipple:!0,btnBackground:"rgb(".concat(e.props.configColors["--primary_500"],")"),borderColor:"rgb(".concat(e.props.configColors["--primary_500"],")"),textColor:"rgb(".concat(e.props.configColors["--foreground_300"],")"),hoverColor:"rgb(".concat(e.props.configColors["--primary_500"],")"),btnTextTransform:"none",onClick:function(){return e.showAllAppliancesToggle()}})})]}),h?(0,N.jsx)("div",{className:"no-data-disclaimer","data-widget-name":m.wY4.INSIGHTS.MONTHLY_SUMMARY,"data-text-color":"foreground_400",children:c.itemizationDisclaimer?c.itemizationDisclaimer:o.dataNotAvailable}):"",""!==o.chartDisclaimer&&(0,N.jsx)("div",{className:"disclaimer-msg","data-widget-name":m.wY4.INSIGHTS.MONTHLY_SUMMARY,"data-text-color":"foreground_400",children:o.chartDisclaimer})]})}})}}]),a}(l.Component),I=(0,p.EN)((0,d.$j)((function(e){return{session:e.session,monthlySummaryData:e.monthlySummaryData,translationsData:e.translationsData.data,appliancesList:e.appliances.appliancesList,queryParams:e.queryParams,responsiveness:e.responsiveness}}))(j)),E=a(19615),L=a(61120),Y=a(97240),U=a(7745),H=a(74813),R=a(41130),P=a(78023),Z=a(62791),F=a(21629),G=a(88291),B=a(14969),z=function(e){(0,o.Z)(a,e);var t=(0,r.Z)(a);function a(e){var n;return(0,i.Z)(this,a),(n=t.call(this,e)).shiftFocusBack=function(){n.filterAnchorEl.current&&n.filterAnchorEl.current.focus()},n.setParentEle=function(e){n.setState({parentEle:e})},n.handleKeyPress=function(e){if(27!==e.keyCode){if((0,f.IR)()&&n.state.parentEle){var t=n.state.parentEle,a=Array.from(t.querySelectorAll('a[href], button:not([disabled]), textarea, input, select, h2, p,  [tabindex]:not([tabindex="-1"]')),i=a[0],s=a[a.length-1],o=n.state.currentElement,r=a.indexOf(o);if(39===e.keyCode||40===e.keyCode||9===e.keyCode&&!e.shiftKey){if(9===e.keyCode&&e.preventDefault(),o===s)return void n.setState({currentElement:i},(function(){return n.state.currentElement.focus()}));n.setState({currentElement:a[r+1]},(function(){return a[r+1].focus()}))}if(37===e.keyCode||38===e.keyCode||9===e.keyCode&&e.shiftKey){if(9===e.keyCode&&e.shiftKey&&e.preventDefault(),o===i)return void n.setState({currentElement:s},(function(){return n.state.currentElement.focus()}));n.setState({currentElement:a[r-1]},(function(){return n.state.currentElement.focus()}))}}}else n.handleFooterDialog(!1,null)},n.state={noData:!1,openFilter:!1,openFooterDialog:!1,isModalTableEnabled:!1,parentEle:null,currentElement:null,refEl:null,currentRef:null,filterRef:null},n.configColors=E.V.getColors().colors,n.fetchBillingCycleData=n.fetchBillingCycleData.bind((0,s.Z)(n)),n.handleFilterModal=n.handleFilterModal.bind((0,s.Z)(n)),n.onUpdateFilter=n.onUpdateFilter.bind((0,s.Z)(n)),n.toggleChartType=n.toggleChartType.bind((0,s.Z)(n)),n.toggleModeType=n.toggleModeType.bind((0,s.Z)(n)),n.handleFooterDialog=n.handleFooterDialog.bind((0,s.Z)(n)),n.setFooterEl=n.setFooterEl.bind((0,s.Z)(n)),n.goToFaq=n.goToFaq.bind((0,s.Z)(n)),n.filterAnchorEl=l.createRef(),n.handleADA=n.handleADA.bind((0,s.Z)(n)),n}return(0,n.Z)(a,[{key:"componentDidMount",value:function(){if(!this.props.monthlySummaryData.activeMode){var e=this.props.widgetConfigs.defaultChartMode,t=this.props.widgetConfigs.defaultChartModeSolar;this.props.updateActiveMode(this.props.isSolar?t:e)}var a=this.props.widgetConfigs.defaultChartType;a&&this.props.updateActiveChartType({activeChartType:a})}},{key:"componentDidUpdate",value:function(e,t){if(t.openFooterDialog!==this.state.openFooterDialog){var a=null;this.state.openFooterDialog&&this.state.parentEle&&(a=Array.from(this.state.parentEle.querySelectorAll('a[href], button:not([disabled]), textarea, input, select, h2, p, [tabindex]:not([tabindex="-1"]')),this.setState({currentElement:a[0]}))}var i=this.props.monthlySummaryData;if(this.state.isModalTableEnabled&&i&&!i.fetchingData){var n=i.monthlySummaryDataArray[i.monthlySummaryActiveIndex],s=this.props.session.userProfile.fuelType.toLowerCase();n.itemizationDetails&&n.itemizationDetails[s]&&!i.apiError||this.handleADA()}}},{key:"handleADA",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.setState({isModalTableEnabled:!this.state.isModalTableEnabled,currentRef:e&&e}),this.props.updateModalTableEnabled&&this.props.updateModalTableEnabled(!this.state.isModalTableEnabled)}},{key:"fetchBillingCycleData",value:function(e){var t=this,a=this.props.monthlySummaryData.monthlySummaryDataArray[0].itemizationDetails;if(this.context.rc.analytics.trackEvent(m.FiA.INSIGHTS,{clicked:m.YyL,shown:m.Q2X.MONTHLY_SUMMARY,usageArrowClicked:1===e?m.JYL.RIGHT:m.JYL.LEFT,intervalStart:a.startTs,intervalEnd:a.endTs,widget:m.wY4.INSIGHTS.MONTHLY_SUMMARY,version:m.zZZ.V2}),this.context.rc.analytics.trackGtmEvent("action-click",{pageName:m.FiA.INSIGHTS,click:m.YyL,direction:1===e?m.JYL.RIGHT:m.JYL.LEFT}),this.props.monthlySummaryData.monthlySummaryDataArray[this.props.monthlySummaryData.monthlySummaryActiveIndex+e])this.props.fetchingData(),setTimeout((function(){t.props.updateActiveIndex(e,t.props.session.userProfile.fuelType)}),100);else{this.props.fetchingData();var i=this.props.monthlySummaryData.monthlySummaryDataArray[this.props.monthlySummaryData.monthlySummaryActiveIndex],n={locale:this.props.locale,"measurement-type":(0,f.nY)(this.props.session.userProfile.fuelType),"date-format":this.props.widgetConfigs.dateFormat,"highest-day-date-format":this.props.widgetConfigs.highestDayDateFormat};1===e?(n["bill-start"]=i.nextBillStart,n["bill-end"]=i.nextBillEnd,n["next-bill-cycle"]=!0):(n["bill-start"]=i.previousBillStart,n["bill-end"]=i.previousBillEnd,n["next-bill-cycle"]=!1),(0,H.JF)()&&(n.templateName="".concat(m.wY4.HOME.CONSUMPTION_BREAKDOWN,".FETCH_MONTHLY_SUMMARY_DATA")),this.props.fetchMonthlySummaryData(this.context.rc,this.props.userId,n,!0,this.props.session.userProfile.fuelType)}}},{key:"handleFilterModal",value:function(e,t){this.setState((function(a){return(0,c.Z)((0,c.Z)({},a),{},{openFilter:e,filterRef:t&&t})}))}},{key:"handleFooterDialog",value:function(e,t){var a=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;i&&this.setState({refEl:i}),t?(e.stopPropagation(),Z.bs.broadcast(Z.FP.POPUP_OPENED,{widgetId:F.Z$.INSIGHTS_MONTHLY_SUMMARY}),Z.bs.subscribe(Z.FP.CLOSE_POPUP,(function(){return a.toggleFooterDialog()}))):Z.bs.broadcast(Z.FP.POPUP_CLOSED,{widgetId:F.Z$.INSIGHTS_MONTHLY_SUMMARY}),t||this.state.refEl.current&&this.state.refEl.current.focus(),this.toggleFooterDialog(t)}},{key:"toggleFooterDialog",value:function(e){this.setState((function(t){return(0,c.Z)((0,c.Z)({},t),{},{openFooterDialog:e})})),this.context.rc.analytics.trackEvent(m.FiA.INSIGHTS,{clicked:"Monthly Summary Itemization",openTooltip:e,tab:m.Q2X.MONTHLY_SUMMARY,widget:m.wY4.INSIGHTS.MONTHLY_SUMMARY,version:m.zZZ.V2})}},{key:"goToFaq",value:function(e,t){this.context.rc.analytics.trackEvent(m.FiA.INSIGHTS,{clicked:m.mhs,tab:m.Q2X.MONTHLY_SUMMARY,widget:m.wY4.INSIGHTS.MONTHLY_SUMMARY,version:m.zZZ.V2}),(0,G.K2)(t)?window.open(t):(0,G.m3)(F.Z$.INSIGHTS_MONTHLY_SUMMARY,this.props.history,this.props.location,e,t)}},{key:"setFooterEl",value:function(e){this.footerEl=e}},{key:"onUpdateFilter",value:function(e,t){var a=this.props.monthlySummaryData;e.activeMode!==a.activeMode&&this.toggleModeType(),this.toggleChartType(e.chartType),this.setState({openFilter:!1}),t&&this.state.filterRef&&this.state.filterRef.focus()}},{key:"toggleChartType",value:function(e){this.props.monthlySummaryData.activeChartType!==e&&(this.props.updateActiveChartType({activeChartType:e}),this.context.rc.analytics.trackEvent(m.FiA.INSIGHTS,{clicked:"usageChartToggle",chart:e,shown:m.Q2X.MONTHLY_SUMMARY,widget:m.wY4.INSIGHTS.MONTHLY_SUMMARY,version:m.zZZ.V2}))}},{key:"toggleModeType",value:function(){var e=this.props.widgetConfigs.leftToggleUnit,t=this.props.widgetConfigs.rightToggleUnit,a=this.props.monthlySummaryData.activeMode===e?t:e;this.context.rc.analytics.trackEvent(m.FiA.INSIGHTS,{clicked:m.GNf.USAGE_COST_TOGGLE,type:a,shown:m.Q2X.MONTHLY_SUMMARY,widget:m.wY4.INSIGHTS.MONTHLY_SUMMARY,version:m.zZZ.V2}),this.props.updateActiveMode(a)}},{key:"render",value:function(){var e=this,t=this.props,a=t.monthlySummaryData,i=t.translationsData,n=t.isMobileView,s=a.monthlySummaryDataArray[a.monthlySummaryActiveIndex],o="".concat((0,f.Yr)(s.itemizationDetails.startDateFormatted,m.DEY.YEAR,this.props.configData,n)," - ").concat((0,f.Yr)(s.itemizationDetails.endDateFormatted,m.DEY.YEAR,this.props.configData,n)),r=a.activeMode||"",c={chartType:a.activeChartType,activeMode:r},d=this.props.session.userProfile.fuelType.toLowerCase(),u=s.itemizationDetails[d],p=this.props.configData&&(0,f.rK)(this.props.widgetConfigs,this.props.isSolar),g=(0,y.$R)(s,r,null,d,null,p,i["MONTHLY_SUMMARY.FULL_BILL.OTHER_CHARGES"]),v=(0,y.Bo)(a,s,d),D=p&&!v&&r===m.AgQ.COST&&g,b=n||u&&u.length>m.yU$||"Pie"===c.chartType,S=this.props.widgetStrings.adaLabel||i["DASHBOARD.ADA_BTN_TEXT"],M=this.props.widgetStrings.title,T=this.context.runMode===m.K8z;return(0,N.jsxs)(N.Fragment,{children:[n&&(0,N.jsxs)(l.Fragment,{children:[(M||(0,f.IR)())&&(0,N.jsxs)("div",{className:T?"widget-header-cont ".concat((0,f.jP)()?"no-bg":""):"ms-header",children:[M&&(0,N.jsx)("div",{"aria-level":"2",role:"heading",tabIndex:"0","data-widget-name":m.wY4.INSIGHTS.MONTHLY_SUMMARY,"data-text-color":"foreground_400",children:M}),(0,f.IR)()?(0,N.jsx)("button",{ref:"msAdaRefMobile",className:"accessibility-cta insights-page ada-mobile ".concat(v?"disabled-btn":""),disabled:v,"aria-label":S,onClick:function(){return e.handleADA(e.refs.msAdaRefMobile)},children:(0,N.jsx)("span",{className:"bidgely-icon-accessibility"})}):""]}),(0,N.jsx)("div",{className:"ms-controller-mobile",children:(0,N.jsx)(L.Z,{enableLeftArrow:!a.leftArrowDisabled,enableRightArrow:!a.rightArrowDisabled,intervalDetails:o,handleArrowClick:this.fetchBillingCycleData,handleModal:this.handleFilterModal,widgetName:m.wY4.INSIGHTS.BILL_ANALYSIS,direction:1,translations:i,configs:this.props.configData,isShowADABtn:!0,handleADA:this.handleADA,noDataFound:v,isMobileView:n})})]}),!n&&(0,N.jsx)(l.Fragment,{children:(0,N.jsxs)("div",{className:"ms-controller",children:[(0,N.jsx)(Y.Z,{widgetName:m.wY4.INSIGHTS.MONTHLY_SUMMARY,enableLeftArrow:!a.leftArrowDisabled,enableRightArrow:!a.rightArrowDisabled,intervalDetails:o,handleArrowClick:this.fetchBillingCycleData,direction:1,translations:i}),(0,N.jsxs)("div",{className:this.props.configData.web_accessibility?"ada-btn-wrapper":"",children:[(0,N.jsxs)("button",{ref:this.filterAnchorEl,className:"ms-filter ".concat(v?"disabled-btn":""),disabled:v,onClick:function(){return e.handleFilterModal(!0,e.filterAnchorEl.current)},tabIndex:v?-1:0,children:[(0,N.jsx)("span",{className:"filter-icon"}),(0,N.jsx)("span",{className:"filter-text",children:this.props.widgetStrings.filterLabel})]}),(0,f.IR)()?(0,N.jsx)("button",{ref:"msAdaRef",className:"accessibility-cta insights-page ".concat(v?"disabled-btn":""),disabled:v,tabIndex:v?-1:0,"aria-label":S,onClick:function(){return e.handleADA(e.refs.msAdaRef)},children:(0,N.jsx)("span",{className:"bidgely-icon-accessibility"})}):""]})]})}),(0,N.jsx)("div",{className:"ms-details ".concat(v?"no-data":""),children:(0,N.jsx)(h.Z,{widgetStrings:this.props.widgetStrings,widgetConfigs:this.props.widgetConfigs,isMobileView:n,configColors:this.configColors,isSolar:this.props.isSolar,widgetData:g,showTabsUI:D,configs:this.props.configData,translationsData:this.props.translationsData})}),(0,N.jsxs)("div",{className:"ms-chart-container",children:[D&&!n&&(0,N.jsx)(B.Z,{widgetData:g,widgetStrings:this.props.widgetStrings}),(0,N.jsx)("div",{className:"ms-chart ".concat(D&&!n?"ms-tabs-container":""," ").concat(v?"no-border":""),children:(0,N.jsx)(I,{widgetStrings:this.props.widgetStrings,widgetConfigs:this.props.widgetConfigs,isMobileView:n,configColors:this.configColors,showHelperFooter:b,handleFooterDialog:this.handleFooterDialog,setFooterEl:this.setFooterEl,goToFaq:this.goToFaq,isModalTableEnabled:this.state.isModalTableEnabled,handleADA:this.handleADA,widgetName:m.wY4.INSIGHTS.MONTHLY_SUMMARY,enableLeftArrow:!a.leftArrowDisabled,enableRightArrow:!a.rightArrowDisabled,intervalDetails:o,handleArrowClick:this.fetchBillingCycleData,direction:1,translations:i,configs:this.props.configData,isSolar:this.props.isSolar,currentRef:this.state.currentRef,isAccessibility:f.wG})})]}),(0,N.jsx)(U.Z,{widgetName:m.wY4.INSIGHTS.MONTHLY_SUMMARY,isMobileView:n,open:this.state.openFilter,controls:c,handleModal:this.handleFilterModal,onUpdateFilter:this.onUpdateFilter,configData:this.props.configData,skipOngoingBC:this.props.widgetConfigs.skipOngoingBC,widgetStrings:this.props.widgetStrings.filterModal,toggleChartType:this.toggleChartType,toggleModeType:this.toggleModeType,anchorEl:this.filterAnchorEl.current,isSolar:this.props.isSolar,shiftFocusBack:this.shiftFocusBack})]})}}]),a}(l.Component);z.contextType=w.zO;var V=(0,d.$j)((function(e){return{session:e.session,monthlySummaryData:e.monthlySummaryData,translationsData:e.translationsData.data,userId:e.session.userProfile.userId,configData:e.configs.data,locale:e.configs.locale}}),(function(e){return{fetchMonthlySummaryData:function(t,a,i,n,s){return e((0,P.O)(t,a,i,n,s))},updateActiveChartType:function(t){return e((0,R.w3)(t))},updateActiveIndex:function(t,a){return e((0,R.fp)(t,a))},updateActiveMode:function(t){return e((0,R.Ft)(t))},fetchingData:function(){return e((0,R.QC)())}}}))(z),W=a(61939),K=function(e){(0,o.Z)(a,e);var t=(0,r.Z)(a);function a(e){var n;return(0,i.Z)(this,a),(n=t.call(this,e)).widgetTrackingInfo=void 0,n.updateModalTableEnabled=function(e){n.setState({isModalTableEnabled:e})},n.state={isModalTableEnabled:!1},Z.bs.subscribe(Z.FP.RELOAD_WIDGET,n.init.bind((0,s.Z)(n))),n}return(0,n.Z)(a,[{key:"componentDidMount",value:function(){this.widgetTrackingInfo=this.context.rc.analytics.createWidgetInfo(m.xDZ.INSIGHTS_MS,"V2"),this.context.rc.analytics.trackEvent(m.FiA.INSIGHTS,{viewed:!0,shown:m.Q2X.MONTHLY_SUMMARY,version:m.zZZ.V2},this.props),this.init()}},{key:"init",value:function(){if(0===this.props.monthlySummaryData.monthlySummaryDataArray.length){var e={"date-format":this.props.widgetConfigs.dateFormat,"highest-day-date-format":this.props.widgetConfigs.highestDayDateFormat,locale:this.props.locale,"measurement-type":(0,f.nY)(this.props.session.userProfile.fuelType)};(0,H.JF)()&&(e.templateName="".concat(m.wY4.INSIGHTS.MONTHLY_SUMMARY,".FETCH_MONTHLY_SUMMARY_DATA")),this.props.fetchingData(),this.props.fetchMonthlySummaryData(this.context.rc,this.props.userId,e,!1,this.props.session.userProfile.fuelType)}}},{key:"componentDidUpdate",value:function(e){if(this.widgetTrackingInfo&&e.monthlySummaryData.fetchingData&&!this.props.monthlySummaryData.fetchingData){var t=this.props.monthlySummaryData.apiFailed?m.WW8.ERROR:this.props.monthlySummaryData.monthlySummaryDataArray.length?m.WW8.SUCCESS:m.WW8.DATA_NOT_AVAILABLE,a=this.props.monthlySummaryData.errorInfo;this.context.rc.analytics.logWidgetInfo(this.widgetTrackingInfo,t,a),this.widgetTrackingInfo=null}}},{key:"render",value:function(){var e=this,t=this.props,a=t.monthlySummaryData,i=t.responsiveness,n=t.translationsData,s=t.widgetConfigs,o=t.widgetStrings,r=i.isMobileView,l=this.context.rc.session.isSolarUser(),c=l?o.titleSolar:(0,f.rK)(s,l)?o.fullBillTitle:o.title,d=this.context.runMode===m.K8z;return a&&a.monthlySummaryDataArray&&a.monthlySummaryActiveIndex>=0&&a.monthlySummaryDataArray.length&&(l=a.monthlySummaryDataArray[a.monthlySummaryActiveIndex].solarUser),(0,N.jsxs)("div",{className:"insights-ms-inner-container-v2 ".concat((0,f.wG)()?"accessible-color-insights-ms-V2":""," ").concat(this.state.isModalTableEnabled?"ada-modal-view":""),role:"region","aria-label":n["TOP_MENU_ITEMS.MONTHLY_SUMMARY"],children:[!r&&c&&(0,N.jsx)("div",{className:"".concat(d?"widget-header-cont ".concat((0,f.jP)()?"no-bg":""," sdk-mode"):"ms-header"),"data-widget-name":m.wY4.INSIGHTS.MONTHLY_SUMMARY,"data-text-color":"foreground_400",children:(0,N.jsx)("span",{role:"heading","aria-level":2,children:c})}),0!==a.monthlySummaryDataArray.length?(0,N.jsx)(V,{widgetConfigs:s,widgetStrings:o,isMobileView:r,history:this.props.history,location:this.props.location,isSolar:l,updateModalTableEnabled:function(t){return e.updateModalTableEnabled(t)}}):a.apiFailed?(0,N.jsx)("div",{className:"error-page",children:(0,N.jsx)("div",{className:"error-msg",tabIndex:0,children:o.dataNotAvailable})}):(0,N.jsx)(b.Z,{})]})}}]),a}(l.Component);K.contextType=w.zO;var q=(0,W.$)(F.Z$.INSIGHTS_MONTHLY_SUMMARY,(0,p.EN)((0,d.$j)((function(e){return{session:e.session,monthlySummaryData:e.monthlySummaryData,userId:e.session.userProfile.userId,configData:e.configs.data,locale:e.configs.locale,translationsData:e.translationsData.data,responsiveness:e.responsiveness}}),(function(e){return{fetchMonthlySummaryData:function(t,a,i,n,s){return e((0,P.O)(t,a,i,n,s))},fetchingData:function(){return e((0,R.QC)())}}}))(K)))},70744:function(e,t,a){a.r(t),a.d(t,{default:function(){return ne}});var i=a(15671),n=a(43144),s=a(97326),o=a(60136),r=a(98557),l=a(47313),c=a(1084),d=a(56955),h=a(76720),u=a(41294),p=a(46417),g=function(e){var t=(0,h.WS)().rc,a=e.monthlySummaryData,i=e.widgetStrings,n=e.widgetConfigs,s=a.monthlySummaryDataArray&&a.monthlySummaryDataArray.length?a.monthlySummaryDataArray[a.monthlySummaryActiveIndex]:"",o=(t.session.isSolarUser(),s.solarUser,(0,u.G3)(s.consumption,s.previousMonthConsumption)),r=(0,d.Q_)({percentageVal:o.percent}),l=o.gain?i.usageUpVsPrevMonth:i.usageDownVsPrevMonth,c=o.percent>0,g=(0,u.G3)(s.cost,s.previousMonthCost),m=(0,d.Q_)({percentageVal:g.percent}),f=g.gain?i.billUpVsPrevMonth:i.billDownVsPrevMonth,y=g.percent>0,v=[{usage:!0,iconClass:"bidgely-icon-power-plug",title:i.energyUsageTitle,value:(0,d.ub)({usage:s.consumption,showUsageUnit:!0,fuelType:e.session.userProfile.fuelType}),compPrevMonth:c?(0,d.Z7)(i.usageChangeVsPrevMonth,{percent:r}):i.sameAsPrevious,adaDiffLabel:c?(0,d.Z7)(l,{percent:r}):i.sameAsPrevious,vsPrevMonth:o.gain,percentage:c},{usage:!1,iconClass:"bidgely-icon-bill-outline",title:i.totalBillTitle,value:(0,d.xB)({cost:s.cost,showCurrency:!0,round:!0}),compPrevMonth:y?(0,d.Z7)(i.billChangeVsPrevMonth,{percent:m}):i.sameAsPrevious,adaDiffLabel:y?(0,d.Z7)(f,{percent:m}):i.sameAsPrevious,vsPrevMonth:g.gain,percentage:y}],D=[{name:i.energyChargesLineItem,value:(0,d.xB)({cost:s.energyCharges,showCurrency:!0,round:!0}),energyCharges:!0}];if(n.fullBillOn){s.peakDemandCharges&&D.push({name:i.demandChargeslabel,value:(0,d.xB)({cost:s.peakDemandCharges,showCurrency:!0,round:!0})});var b=s.miscCharges,S=0;if(b&&b.length&&(D=D.concat(b.map((function(e){return S+=e.cost,{name:e.chargeNameText,value:(0,d.xB)({cost:e.cost,showCurrency:!0,round:!0})}})))),s.cost){var M=s.cost-(s.energyCharges+(s.peakDemandCharges||0))+S;0!==Math.round(M)&&D.push({name:i.otherChargeslabel,value:(0,d.xB)({cost:M,showCurrency:!0,round:!0})})}}var T=(0,d.Z7)(i.billBreakdownTitle,{energyCharges:(0,d.xB)({cost:s.cost,showCurrency:!0,round:!0})});return(0,p.jsxs)("div",{className:"ms-bill-details","data-text-color":"foreground_400",children:[(0,p.jsx)("div",{className:"details-left-cont",children:v.map((function(e,t){return(0,p.jsxs)("div",{className:"info-box","aria-label":"".concat(e.title," - ").concat(e.value),children:[(0,p.jsxs)("div",{className:"header",children:[(0,p.jsx)("div",{className:"icon ".concat(e.iconClass),"aria-hidden":"true"}),(0,p.jsx)("div",{className:"title",children:e.title})]}),(0,p.jsxs)("div",{className:"detail",children:[(0,p.jsx)("div",{className:"value",children:e.value}),s.previousMonthConsumption&&s.previousMonthCost?(0,p.jsxs)("div",{className:"insight",children:[e.percentage?(0,p.jsx)("div",{className:"arrow ".concat(e.vsPrevMonth?"bidgely-icon-up-comparison negative":"bidgely-icon-down-comparison positive"),"aria-hidden":"true"}):"",(0,p.jsx)("div",{"aria-label":e.adaDiffLabel,children:(0,p.jsx)("span",{"aria-hidden":"true",children:e.compPrevMonth})})]}):""]})]},"infoBox".concat(t))}))}),(0,p.jsxs)("div",{className:"breakdown-right-cont",children:[(0,p.jsx)("div",{className:"heading",children:T}),(0,p.jsx)("div",{className:"breakdown-list",role:"list",children:D.map((function(e){return(0,p.jsxs)("div",{className:"item",role:"listitem","aria-label":"".concat(e.name," - ").concat(e.value),children:[(0,p.jsx)("div",{className:"title","aria-hidden":"true",children:e.name}),(0,p.jsx)("div",{className:"value ".concat(e.energyCharges?"highlight":""),"aria-hidden":"true",children:e.value})]},e.name)}))})]})]})},m=a(19615),f=a(16404),y=a(97240),v=a(74813),D=a(41130),b=a(78023),S=a(14427),M=a(37762),T=a(1413),x=a(29439),A=a(78770),C=a(3789),w=a(38502),N=a(1550),_=a(22548),O=a(51405),k=a(83213),j=a(6306),I=a(17592),E=a(86592),L=a(69140),Y=function(e){e.widgetConfigs;var t=e.widgetStrings,a=e.previousMonthData,i=e.currentMonthData,n=e.configColors,s=e.isMobileView,o=e.activeMode,r=e.configData,l=e.session,c=e.goToUsage,h=e.isTOUUser,u=84,g=a&&a.trueDisagg||i&&i.trueDisagg,m=(a?h&&g?a.peakVal:a.total:0)||0,f=(i?h&&g?i.peakVal:i.total:0)||0,y=o===r.electric_cost_unit,v=function(e,t,a){return Math.round(e)===Math.round(t)?u:a?e>=t?u:Math.floor(u*(e/t*100)/100):e<=t?u:Math.floor(u*(t/e*100)/100)},D=function(e){var t=e<0?1:e;return y?(0,d.xB)({cost:t,showCurrency:!0,round:!0,lessThanOne:e<0}):(0,d.ub)({usage:t,showUsageUnit:!0,fuelType:l.userProfile.fuelType,round:!0,lessThanOne:e<0})},b=0===m?t.notAvailableText:D(m),S=D(f),M=v(m,f,!0),T=v(m,f,!1),x=g?n["--data_colors_on_peak"]:n["--data_colors_graph_primary"],A=t.nonTouUsageInsight;h&&(a&&a.trueDisagg||i&&i.trueDisagg)&&(A=t.peakUsageInsight);var C=function(e,t){return(0,p.jsx)("div",{className:"month-bar",children:(0,p.jsx)("div",{className:"total",style:{height:"".concat(u,"px")},children:(0,p.jsx)("div",{className:"usage",style:{height:"".concat(e,"px"),backgroundColor:"rgba(".concat(t,", 1)")}})})})};return(0,p.jsxs)("div",{className:"ms-tooltip",children:[(0,p.jsxs)("div",{className:"tooltip-wrapper",children:[(0,p.jsxs)("div",{className:"month-detail last",children:[(0,p.jsx)("div",{className:"value",children:b}),(0,p.jsx)("div",{className:"text",children:h&&a&&a.trueDisagg?t.lastMonthPeakUsageLabel:t.lastMonthUsageLabel})]}),C(M,x),C(T,x),(0,p.jsxs)("div",{className:"month-detail current",children:[(0,p.jsx)("div",{className:"value",children:S}),(0,p.jsx)("div",{className:"text",children:h&&i&&i.trueDisagg?t.currentMonthPeakUsageLabel:t.currentMonthUsageLabel})]})]}),(0,p.jsx)("div",{className:"description",children:A}),(0,p.jsx)("div",{className:"btn",style:{cursor:"pointer"},children:(0,p.jsx)(L.Z,{btnVariant:"outlined",btnText:t.viewUsagePatternBtn,btnBackground:"rgb(".concat(n["--background_300"],")"),hoverColor:"rgb(".concat(n["--background_300"],")"),btnTextTransform:"none",btnTextSize:s?"12px":"14px",textColor:"rgb(".concat(n["--primary_500"],")"),borderColor:"rgb(".concat(n["--primary_500"],")"),onClick:function(e,t){return c(e,i.applianceId?i.applianceId:"")},isMobileView:s})})]})},U=a(83450),H=a(96534),R={itemizationDetails:{startTs:1681272e3,endTs:1683604799,startDate:"April 12, 2023",endDate:"May 8, 2023",startDateFormatted:"2023-04-12",endDateFormatted:"2023-05-08",electric:[{id:18,category:"electricVehicle",usage:1371,cost:275,percentage:35,costPercentage:35,attributes:{}},{id:3,category:"spaceHeating",usage:841,cost:169,percentage:21,costPercentage:21,attributes:{}},{id:8,category:"alwaysOn",usage:412,cost:83,percentage:10,costPercentage:10,attributes:{}},{id:66,category:"entertainment",usage:138,cost:28,percentage:4,costPercentage:4,attributes:{}},{id:71,category:"lighting",usage:102,cost:21,percentage:3,costPercentage:3,attributes:{}},{id:9,category:"refrigeration",usage:95,cost:19,percentage:2,costPercentage:2,attributes:{}},{id:5,category:"cooking",usage:70,cost:14,percentage:2,costPercentage:2,attributes:{}},{id:59,category:"laundry",usage:14,cost:3,percentage:0,costPercentage:0,attributes:{}},{id:99,category:"other",usage:897,cost:180,percentage:23,costPercentage:23,attributes:{}}],context:{electricity:{statistical:!1,invoicePresent:!0,errorCode:1,percentage:!0},gas:null}},previousMonthItemizationDetails:{startTs:1681272e3,endTs:1683604799,startDate:"April 12, 2023",endDate:"May 8, 2023",startDateFormatted:"2023-04-12",endDateFormatted:"2023-05-08",electric:[{id:18,category:"electricVehicle",usage:1331,cost:285,percentage:35,costPercentage:35,attributes:{}},{id:3,category:"spaceHeating",usage:801,cost:149,percentage:21,costPercentage:21,attributes:{}},{id:8,category:"alwaysOn",usage:300,cost:63,percentage:10,costPercentage:10,attributes:{}},{id:66,category:"entertainment",usage:118,cost:18,percentage:4,costPercentage:4,attributes:{}},{id:71,category:"lighting",usage:152,cost:51,percentage:3,costPercentage:3,attributes:{}},{id:9,category:"refrigeration",usage:89,cost:29,percentage:2,costPercentage:2,attributes:{}},{id:5,category:"cooking",usage:75,cost:34,percentage:2,costPercentage:2,attributes:{}},{id:59,category:"laundry",usage:34,cost:5,percentage:0,costPercentage:0,attributes:{}},{id:99,category:"other",usage:900,cost:170,percentage:23,costPercentage:23,attributes:{}}],context:{electricity:{statistical:!1,invoicePresent:!0,errorCode:1,percentage:!0},gas:null}},itemizationDisclaimer:"Energy breakdown amounts are approximate and rounded to the nearest dollar. If you haven\u2019t filled out your HOME PROFILE, please fill it out to help us improve.",cost:792,consumption:3940,estimatedConsumption:3940,highestWeekdayConsumptionDate:"Monday Apr 17",highestWeekendConsumptionDate:"Saturday Apr 15",previousBillStart:1678338e3,previousBillEnd:1681272e3,nextBillStart:null,nextBillEnd:null,solarUser:!1,miscCharges:[],peakDemandCharges:null,energyCharges:791.8,previousMonthCost:844,previousMonthConsumption:4200,currentMonthTOUData:{touCost:{PEAK:77.38226211071014,MID_PEAK:88.47397662699223,OFF_PEAK:34.58767236582935},touConsumption:{PEAK:188.64980000000003,MID_PEAK:421.80680000000007,OFF_PEAK:274.8762000000001},invoiceOverridden:!1,weekdayWeekendTouCost:null,weekdayWeekendTouConsumption:null},previousMonthTOUData:{touCost:{PEAK:8.64140249043703,MID_PEAK:96.07414169982076,OFF_PEAK:59.189450768753886},touConsumption:{PEAK:23.695200000000003,MID_PEAK:458.0412,OFF_PEAK:470.3922},invoiceOverridden:!1,weekdayWeekendTouCost:null,weekdayWeekendTouConsumption:null},currentMonthAppliancesTouData:{3:{"Off-Peak":{cost:50,consumption:133},"Mid-Peak":{cost:70,consumption:143},"On-Peak":{cost:49,consumption:103}},8:{"Off-Peak":{cost:50,consumption:80},"Mid-Peak":{cost:23,consumption:703},"On-Peak":{cost:10,consumption:50}},18:{"Off-Peak":{cost:100,consumption:200},"Mid-Peak":{cost:125,consumption:230},"On-Peak":{cost:50,consumption:100}}},previousMonthAppliancesTouData:{3:{"Off-Peak":{cost:70,consumption:145},"Mid-Peak":{cost:20,consumption:122},"On-Peak":{cost:50,consumption:186}},8:{"Off-Peak":{cost:40,consumption:130},"Mid-Peak":{cost:10,consumption:43},"On-Peak":{cost:18,consumption:73}},18:{"Off-Peak":{cost:90,consumption:145},"Mid-Peak":{cost:130,consumption:233},"On-Peak":{cost:30,consumption:90}}},topAppliances:[{key:3,value:4.496389136514976}],touSupportedAppliances:[18,3,8]},P=(0,I.ZP)(w.ZP)((function(e){e.theme;return{"& .MuiInputBase-input":{margin:0,borderRadius:20,position:"relative",border:"1px solid rgba(var(--primary_400), 1)",backgroundColor:"rgba(var(--primary_200), 1)",color:"rgba(var(--primary_500), 1)",fontSize:18,fontWeight:600,padding:"4px 12px","&:focus":{borderRadius:20,borderColor:"rgba(var(--primary_500), 1)",boxShadow:"0 0 0 0.2rem rgba(0,123,255,.25)"}}}})),Z=function(e){var t=(0,h.WS)().rc,a=e.msData,i=e.responsiveness,n=(e.monthlySummaryData,e.configColors),s=e.configData,o=e.widgetStrings,r=e.widgetConfigs,c=e.session,g=e.history,m=e.isRunModeSdk,y=e.applianceList,v=i.isMobileView,D=i.isTabletView,b=(0,l.useState)(-1),S=(0,x.Z)(b,2),w=S[0],I=S[1],L=(0,l.useState)(-1),Z=(0,x.Z)(L,2),F=Z[0],G=Z[1],B=(0,l.useState)(!0),z=(0,x.Z)(B,2),V=z[0],W=z[1],K=(0,l.useState)(-1),q=(0,x.Z)(K,2),Q=q[0],$=q[1],X=(0,l.useState)([]),J=(0,x.Z)(X,2),ee=J[0],te=J[1],ae=(0,l.useState)(!1),ie=(0,x.Z)(ae,2),ne=ie[0],se=ie[1],oe=(0,l.useState)(0),re=(0,x.Z)(oe,2),le=re[0],ce=re[1],de=(0,l.useState)(""),he=(0,x.Z)(de,2),ue=he[0],pe=he[1],ge=e.barChartNoData,me=a.currentMonthAppliancesTouData||{},fe=a.previousMonthAppliancesTouData||{},ye=a.currentMonthTOUData||{},ve=a.previousMonthTOUData||{},De=ge||a.itemizationDetails&&!a.itemizationDetails.electric?R.itemizationDetails:a.itemizationDetails,be=a.previousMonthItemizationDetails||{},Se=(0,d.ib)(a.touUser)&&Object.keys(me).length>0;(0,l.useEffect)((function(){pe(s.electric_cost_unit)}),[s.electric_cost_unit]);var Me=function(e,a){var i=ue===s.electric_cost_unit;t.analytics.trackEvent(f.FiA.INSIGHTS,{clicked:i?o.viewCostPatternBtn:o.viewUsagePatternBtn,version:f.zZZ.V3});var n=f.H5d.APPLIANCE,r=(0,H.HT)(c.userProfile,s).includes(a.toString())?a:f.N$L;g.push("".concat(U.Ub.USAGE,"?usage-view=").concat(n,"&usage-mode=YEAR&app-id=").concat(r))},Te=function(e){for(var t=ue===s.electric_cost_unit,a=[],i=0,n=0,o=0;o<e.length;o++){var r=f.nO4[e[o].id];i+=e[o].cost>0?e[o].cost:0,n+=e[o].usage>0?e[o].usage:0,a.push({applianceId:e[o].id,applianceName:y[e[o].id],icon:"bidgely-icon-".concat(r.iconClassName),cost:e[o].cost,usage:e[o].usage,total:t?e[o].cost:e[o].usage})}return{appDetails:a,costTotal:i,usageTotal:n}},xe=function(e,t){var a=ue===s.electric_cost_unit,i=[],n=function(e,n){var s=f.nO4[Number(e)],o=0,r=[],l={OFF_PEAK:n[f.i6u.OFF_PEAK]||n[f.Twc.OFF_PEAK]?n[f.i6u.OFF_PEAK]||n[f.Twc.OFF_PEAK]:"",MID_PEAK:n[f.i6u.MID_PEAK]||n[f.Twc.MID_PEAK]?n[f.i6u.MID_PEAK]||n[f.Twc.MID_PEAK]:"",PEAK:n[f.i6u.ON_PEAK]||n[f.Twc.ON_PEAK]?n[f.i6u.ON_PEAK]||n[f.Twc.ON_PEAK]:""};for(var c in l)if(l[c].cost||l[c].consumption){var d=a?l[c].cost:l[c].consumption,h=f.i6u[c];o+=d,r.push({name:c,value:d,peakClassName:h})}(0,u.CW)(r);var p=l[f.Twc.ON_PEAK]||l[f.NMd.ON_PEAK.apiResponseName];if(t&&De&&De.electric)for(var g=0;g<De.electric.length;g++){var m=De.electric[g];if(m.id===Number(e)){o=a?m.cost:m.usage;break}}s&&i.push((0,T.Z)({applianceId:e,applianceName:y[e],icon:"bidgely-icon-".concat(s.iconClassName),total:o,peakData:r,trueDisagg:!0,peakVal:p?a?p.cost:p.consumption:null},l)),(0,u.CW)(i)};if(Se)for(var o in e)e.hasOwnProperty(o)&&n(o,e[o]);else{for(var r=Te(e),l=0;l<r.appDetails.length;l++){var c=r.appDetails[l];i.push({applianceId:c.applianceId,applianceName:c.applianceName,icon:c.icon,total:c.total,usage:c.usage,cost:c.cost,trueDisagg:!1})}t&&ce(a?r.costTotal:r.usageTotal)}return i},Ae=function(e,t){var a,i=(0,M.Z)(t);try{for(i.s();!(a=i.n()).done;){var n=a.value;e[n.name]?e[n.name]+=n.value:e[n.name]=n.value}}catch(s){i.e(s)}finally{i.f()}},Ce=function(){I(-1),G(-1),se(!1),$(-1)},we=function(){Ce(),W(!V)},Ne=(0,E.O)({trigger:"hover",placement:v||D?"bottom":"right",visible:ne&&!ge,offset:v||D?[0,15]:[0,20],interactive:!0}),_e=Ne.getArrowProps,Oe=Ne.getTooltipProps,ke=Ne.setTooltipRef,je=Ne.setTriggerRef,Ie=Ne.visible,Ee=function(e){pe(e.target.value)},Le=function(e,t,a,i,n,o,r,l){var c="";c=n===s.electric_cost_unit?a.currentMonthData.trueDisagg?l.barAdaLabelTouCost:l.barAdaLabelCost:a.currentMonthData.trueDisagg?l.barAdaLabelTouUsage:l.barAdaLabelUsage;var h=a.currentMonthData&&a.currentMonthData.applianceName?a.currentMonthData.applianceName:a.name;return(0,d.Z7)(c,{applianceName:h,mode:n,value:i,percent:o,currentIndex:e+1,peakIndex:a.currentMonthData.peakData?a.currentMonthData.peakData.length:0,total:t+1})};(0,l.useEffect)((function(){!function(){for(var e=[],t=ue===s.electric_cost_unit,a=xe(Se?me:De.electric||[],!0),i=xe(Se?fe:be.electric||[]),n={},r={},l=0;l<a.length;l++){for(var c={currentMonthData:a[l],previousMonthData:{}},d=0;d<i.length;d++)if(a[l].applianceId===i[d].applianceId){c.previousMonthData=i[d];break}e.push(c),Se&&(Ae(n,a[l].peakData),i.length&&i[l]&&Ae(r,i[l].peakData))}var h=e.filter((function(e){return e.currentMonthData.applianceId!==f.zNt})).sort((function(e,a){return a.currentMonthData.total===e.currentMonthData.total&&t?a.currentMonthData.usage-e.currentMonthData.usage:a.currentMonthData.total-e.currentMonthData.total})),p=e.filter((function(e){return e.currentMonthData.applianceId===f.zNt}));if(e=h,p.length&&(e=e.concat(p)),Se&&!ge){var g=0,m=0,y=0,v=t?ye.touCost:ye.touConsumption,D=t?ve.touCost:ve.touConsumption;for(var b in n)y+=v[b],n[b]=Math.floor(v[b]-n[b]),r[b]=D?Math.floor(D[b]-r[b]):0,g+=n[b],m+=r[b];y&&ce(y);var S=Te(De.electric.filter((function(e){return!(me&&me[e.id])}))),M=Te(be.electric?be.electric.filter((function(e){return!(fe&&fe[e.id])})):[]);S.appDetails&&S.appDetails.length&&(g=0,S.appDetails.forEach((function(e){var a=t?e.cost:e.usage;a>0&&(g+=a)})));var T=(0,u.ry)(S.appDetails,t),x=Object.keys(n).map((function(e){return{name:e,value:n[e],peakClassName:f.i6u[e]}}));(0,u.CW)(x),e.push({others:!0,name:o.otherAppliancesLabel,currentPeakData:n,currentMonthData:{peakData:x,otherAppData:T,total:g,trueDisagg:!0,peakVal:n[f.Twc.ON_PEAK]||n[f.NMd.ON_PEAK.apiResponseName]},previousMonthData:{otherAppData:M.appDetails,total:m,trueDisagg:!0,peakVal:r[f.Twc.ON_PEAK]||r[f.NMd.ON_PEAK.apiResponseName]},previousPeakData:r})}te(e)}()}),[ue,a]);var Ye=function(e){var t=e/le*100;return"".concat((t=v?t+7.6:t+3.4).toFixed(2),"%")},Ue=function(e){var t=e<=0?1:e;return ue===s.electric_cost_unit?(0,d.xB)({cost:t,showCurrency:!0,round:!0,lessThanOne:e<=0}):(0,d.ub)({usage:t,showUsageUnit:!0,fuelType:c.userProfile.fuelType,round:!0,lessThanOne:e<=0})},He=(0,d.Z7)(o.billBreakdownTitle,{energyCharges:ue===s.electric_cost_unit?(0,d.xB)({cost:a.cost,showCurrency:!0,round:!0}):(0,d.ub)({usage:a.consumption,showUsageUnit:!0,fuelType:c.userProfile.fuelType,round:!0})}),Re=[{name:s.electric_cost_unit},{name:s.electric_energy_unit}];return(0,p.jsxs)("div",{className:"ms-bar-chart-container-v3 ".concat(ge?"no-data":""),onMouseLeave:Ce,"data-widget-name":f.wY4.INSIGHTS.MONTHLY_SUMMARY,"data-show-appliances-colors":"true","aria-labelledby":"breakdownChartTitle",children:[(0,p.jsxs)("div",{className:"header",onMouseOver:Ce,children:[(0,p.jsx)("div",{className:"title",id:"breakdownChartTitle",children:o.energyChargesBreakdownTitle}),ge?"":(0,p.jsxs)(p.Fragment,{children:[" ",v?(0,p.jsx)("div",{className:"mode-toggle",children:(0,p.jsx)(N.Z,{sx:{m:1},variant:"filled",children:(0,p.jsx)(_.Z,{value:ue,onChange:Ee,input:(0,p.jsx)(P,{}),IconComponent:j.Z,MenuProps:{anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"}},children:Re.map((function(e,t){return(0,p.jsx)(O.Z,{value:e.name,children:(0,p.jsx)(k.Z,{primary:e.name})},"modeToggle".concat(t))}))})})}):(0,p.jsx)("div",{className:"mode-toggle",children:(0,p.jsx)(A.Z,{className:"button-group",value:ue,onChange:Ee,children:Re.map((function(e,t){return(0,p.jsx)(C.Z,{className:"button ".concat(ue===e.name?"active":""),value:e.name,children:e.name},"modeToggle".concat(t))}))})})," "]})]}),(0,p.jsx)("div",{className:"chart-content",role:"group","aria-label":He,children:ee.map((function(e,t){return(0,p.jsxs)(l.Fragment,{children:[(0,p.jsxs)("div",{className:"appliance-row ".concat(t!==w||ge?"":"highlight","  ").concat(m?"sdk-tooltip":""),ref:t===w?je:null,onMouseOver:function(){return function(e){Ce(),I(e),G(-1),se(!0)}(t)},children:[(0,p.jsx)("div",{className:"appliance-info",children:e.others?(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)("div",{className:"icon other-appliances","aria-hidden":"true",children:"\xb7\xb7\xb7"}),(0,p.jsx)("div",{className:"name",children:e.name}),e.currentMonthData.otherAppData.length>0&&(0,p.jsx)("a",{className:"other-appliances-toggle",onClick:we,href:"javascript:void(0)","aria-label":"".concat(V?o.hideOtherAppliancesLink:o.viewOtherAppliancesLink," ").concat(e.name),children:V?o.hideOtherAppliancesLink:o.viewOtherAppliancesLink})]}):(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)("div",{className:"icon ".concat(e.currentMonthData.icon),"aria-hidden":"true"}),(0,p.jsx)("div",{className:"name",children:e.currentMonthData.applianceName})]})}),(0,p.jsxs)("div",{className:"appliance-usage",children:[e.currentMonthData&&e.currentMonthData.peakData&&e.currentMonthData.peakData.length&&le>0?(0,p.jsx)("div",{className:"bar",children:e.currentMonthData.peakData.map((function(t,a){return(0,p.jsx)("div",{className:"bar-part ".concat(t.peakClassName.toLowerCase()," ").concat(1==e.currentMonthData.peakData.length?"flat":""),tabIndex:0,"aria-label":Le(a,ee.length,e,t.value,ue,Ye(t.value),0,o),style:{width:Ye(t.value)}},"barPart".concat(a))}))}):(0,p.jsx)("div",{className:"bar",children:(0,p.jsx)("div",{className:"bar-part flat",style:{width:Ye(e.currentMonthData.total)},tabIndex:0,"aria-label":Le(F,ee.length,e,e.currentMonthData.total,ue,Ye(e.currentMonthData.total),0,o)})}),(0,p.jsx)("div",{className:"value",children:Ue(e.currentMonthData.total)})]}),Ie&&t===w&&(0,p.jsxs)("div",(0,T.Z)((0,T.Z)({ref:ke},Oe({className:"tooltip-container"})),{},{children:[(0,p.jsx)(Y,{widgetConfigs:r,widgetStrings:o,currentMonthData:e.currentMonthData,previousMonthData:e.previousMonthData,configColors:n,isMobileView:v,activeMode:ue,configData:s,session:c,goToUsage:Me,isTOUUser:Se}),(0,p.jsx)("div",(0,T.Z)({},_e({className:"tooltip-arrow"})))]}))]}),V&&e.others&&e.currentMonthData.otherAppData&&e.currentMonthData.otherAppData.length?(0,p.jsx)("div",{className:"other-appliances",children:e.currentMonthData.otherAppData.map((function(t,a){return(0,p.jsxs)("div",{className:"appliance-row ".concat(a===F?"highlight":""),ref:a===F?je:null,onMouseOver:function(){return function(e,t){se(!1),$(t),G(e),I(-1)}(a,t.applianceId)},tabIndex:0,children:[(0,p.jsxs)("div",{className:"appliance-info",children:[(0,p.jsx)("span",{className:"icon ".concat(t.icon),"aria-hidden":"true"}),(0,p.jsx)("span",{className:"name",children:t.applianceName})]}),(0,p.jsx)("div",{className:"appliance-usage",children:(0,p.jsx)("div",{className:"value",children:ue===s.electric_cost_unit?(0,d.xB)({cost:t.cost<0?1:t.cost,showCurrency:!0,round:!0,lessThanOne:t.cost<0}):(0,d.ub)({usage:t.usage<0?1:t.usage,showUsageUnit:!0,fuelType:c.userProfile.fuelType,round:!0,lessThanOne:t.usage<0})})}),a===F&&(0,p.jsxs)("div",(0,T.Z)((0,T.Z)({ref:ke},Oe({className:"tooltip-container"})),{},{children:[(0,p.jsx)(Y,{widgetConfigs:r,widgetStrings:o,currentMonthData:e.currentMonthData.otherAppData[a],previousMonthData:(i=e.previousMonthData.otherAppData,i.filter((function(e){return e.applianceId==Q}))[0]),configColors:n,isMobileView:v,activeMode:ue,configData:s,session:c,goToUsage:Me,isTOUUser:Se}),(0,p.jsx)("div",(0,T.Z)({},_e({className:"tooltip-arrow"})))]}))]},"otherAppRow".concat(a));var i}))}):""]},"applianceRow".concat(t))}))}),ge&&(0,p.jsx)("div",{className:"chart-content-error",children:a.itemizationDisclaimer})]})},F=a(28303),G=a(57034),B=a(27507),z=function(e){var t=e.widgetConfigs,a=e.widgetStrings,i=e.configColors,n=e.touData,s=e.totalTouDetails,o=e.isHer,r=o?135:80,l=(0,u.fR)(n),c={chart:{type:"column",height:o?440:400,marginLeft:0,marginRight:0,marginBottom:o?5:70,marginTop:o?70:0,events:{load:function(){return(0,u.jy)(this,n,i,r,s,o)}}},title:{text:null},subTitle:{text:null},accessibility:{enabled:(0,d.IR)(),point:{valueDescriptionFormat:null,descriptionFormatter:function(t){var i="";return 0===t.options.y?i=a.energyUsageNoData:(i="".concat(t.series.name," "),i+="".concat("left"===t.series.userOptions.stack?(0,d.ub)({usage:t.options.y,showUsageUnit:!0,fuelType:e.session.userProfile.fuelType}):(0,d.xB)({cost:t.options.y,showCurrency:!0}))),i}}},xAxis:{visible:!1,margin:0},yAxis:{visible:!1,alignTicks:!1,endOnTick:!1,crosshair:!1,tickLength:0,stackLabels:{enabled:!1}},legend:{enabled:!1},tooltip:{enabled:!1},credits:{enabled:!1},exporting:{enabled:!1},plotOptions:{column:{stacking:"normal",groupPadding:.05,pointWidth:r,borderWidth:2,dataLabels:{enabled:!0,style:{align:"center",textOutline:o?"0.3px rgba(var(--color_13), 1)":"none",fontWeight:"700",fontSize:o?"24px":"14px",color:o?"rgba(var(--color_1), 1)":"rgba(var(--background_700), 1)"},formatter:function(){if(0!==this.y){var t=null;if("left"===this.series.options.stack){var a=(0,d.ub)({usage:Math.round(this.point.orgUsage),showUsageUnit:!0,fuelType:e.session.userProfile.fuelType}),i=null;this.point.orgUsage>999&&(i=a.match(/([\d,]+)\s*(\w+)/)),t=i?i[1]+"<br>"+i[2]:a}else t=(0,d.xB)({cost:Math.round(this.point.orgCost),showCurrency:!0});return t}},inside:!0,align:"center",verticalAlign:"middle"}}},series:(0,u.LW)(n,i,l,a,o)};return(0,p.jsx)("div",{className:"tou-chart",children:(0,p.jsx)(B.Z,{options:c,fontFamily:o?"":t.fontFamily,immutable:!0})})},V=function(e){var t=e.msData,a=e.widgetStrings,i=e.applianceList,n=e.configColors,s=e.session,o=e.isMobileView,r=e.queryParams,c=e.deleteQueryParams,g=e.widgetConfigs,m=(0,l.useState)(!1),y=(0,x.Z)(m,2),v=y[0],D=y[1],b=(0,h.WS)().rc,S=e.energyUsageTouNoData,M=t.currentMonthTOUData,T=t.previousMonthTOUData,A=t.topAppliances,C=(0,u.DD)(M,a,!0),w=C.peak,N=C.data,_=(T&&T.touCost?(0,u.DD)(T,a):{peak:0}).peak,O=(0,u.G3)(w,_),k=Math.round(t.energyCharges),j=N.reduce((function(e,t){return e+t.orgUsage}),0),I=k,E=N.reduce((function(e,t){return e+Math.round(t.orgCost)}),0);if(E<k&&E!==k){var L=k-E;if(0!==L){for(var Y,H=0,R=0;R<N.length;R++)H<N[R].orgCost&&(H=N[R].orgCost,Y=R);(Y||0===Y)&&(N[Y].orgCost+=L)}}var P=!M.invoiceOverridden,Z=t.ratePlanImageData,B=(0,u.Bt)(Z);(0,l.useEffect)((function(){r.openPopup===f.CL_.TOU_RATE_PLAN&&(D(!0),c(["openPopup"]))}),[]);var V="";if(w!=_){var W=O.gain?a.peakUsageIncInsight:a.peakUsageDecInsight;V=(0,d.Z7)(W,{percent:(0,d.Q_)({percentageVal:O.percent})})}var K=[{label:a.totalUsageLabel,value:(P?a.disclaimerIcon:"")+(0,d.ub)({usage:j,showUsageUnit:!0,fuelType:e.session.userProfile.fuelType})},{label:a.totalCostLabel,value:(0,d.xB)({cost:I,showCurrency:!0,round:!0})}],q=A&&A.length?function(e){return e.map((function(e){var t=e.key,a=Math.floor(e.value),n=f.nO4[Number(t)];if(n)return{icon:n.iconClassName,name:i[Number(t)],value:(0,d.Q_)({percentageVal:a})}}))}(A):[],Q=function(){D(!v),b.analytics.trackEvent(f.FiA.INSIGHTS,{clicked:a.seeYourRatePlanLink,version:f.zZZ.V3})};return(0,p.jsxs)("div",{className:"usage-by-tou-container ".concat(S?"no-data":""),"aria-label":"touUsageTitle",children:[(0,p.jsxs)("div",{className:"content",children:[(0,p.jsxs)("div",{className:"tou-details",children:[(0,p.jsx)("div",{className:"title",id:"touUsageTitle",children:a.energyUsageByTouTitle}),(0,p.jsx)("div",{className:"desc",children:a.energyUsageByTouDesc}),P&&(0,p.jsx)("div",{className:"desc disclaimer",children:a.aggregatedUsageDisclaimer}),(0,p.jsx)("div",{children:(0,p.jsx)("a",{className:"link",onClick:Q,href:"javascript:void(0)","aria-label":"".concat(a.seeYourRatePlanLink),children:a.seeYourRatePlanLink})})]}),(0,p.jsx)(z,{touData:N,totalTouDetails:K,isHer:!1,configColors:n,session:s,widgetConfigs:g,widgetStrings:a}),(0,p.jsxs)("div",{className:"legends-and-contributors",children:[(0,p.jsx)("div",{className:"legends",children:N.map((function(e,t){return(0,p.jsxs)("div",{className:"legend",children:[(0,p.jsx)("div",{className:"marker ".concat(e.name.toLowerCase()),"aria-hidden":"true"}),(0,p.jsx)("div",{className:"name",children:e.displayName})]},"legend".concat(t))}))}),q.length?(0,p.jsxs)("div",{className:"top-contributors",children:[(0,p.jsx)("div",{className:"title",children:1==q.length?a.peakHoursTopContributorTitle:a.peakHoursTopContributorsTitle}),(0,p.jsx)("div",{className:"top-appliances",role:"list",children:q.map((function(e,t){return(0,p.jsxs)("div",{className:"appliance-row",role:"listitem","aria-label":"".concat(e.name," - ").concat(e.value),children:[(0,p.jsxs)("div",{className:"info",children:[(0,p.jsx)("div",{className:"icon bidgely-icon-".concat(e.icon),"aria-hidden":"true"}),(0,p.jsx)("div",{className:"name",children:e.name})]}),(0,p.jsx)("div",{className:"value",children:e.value})]},"topContributor".concat(t))}))})]}):""]})]}),_!==w?(0,p.jsxs)("div",{className:"peak-insight ".concat(O.gain?"increase":"decrease"),children:[(0,p.jsx)("div",{className:"text",children:V}),(0,p.jsx)(F.rU,{to:"".concat(U.Ub.USAGE,"?usage-view=USAGE&usage-mode=MONTH&bill-start=").concat(t.itemizationDetails.startTs,"&bill-end=").concat(t.itemizationDetails.endTs),children:a.learnMoreLink})]}):"",S&&(0,p.jsx)("div",{className:"usage-tou-section-error",children:a.touDataNotAvailable}),(0,p.jsx)(G.Z,{ratePlanDialogData:B,widgetStrings:a,isMobileView:o,open:v,handleClose:Q})]})},W=function(e){(0,o.Z)(a,e);var t=(0,r.Z)(a);function a(e){var n;return(0,i.Z)(this,a),(n=t.call(this,e)).state={noData:!1,energyUsageTouNoData:!1,barChartNoData:!1,isErrorCase:!1},n.fetchBillingCycleData=n.fetchBillingCycleData.bind((0,s.Z)(n)),n.isNegative=n.isNegative.bind((0,s.Z)(n)),n.isEnergyUsageNegativeData=n.isEnergyUsageNegativeData.bind((0,s.Z)(n)),n.handleErrorCase=n.handleErrorCase.bind((0,s.Z)(n)),n}return(0,n.Z)(a,[{key:"componentDidMount",value:function(){}},{key:"componentDidUpdate",value:function(){}},{key:"fetchBillingCycleData",value:function(e){var t=this,a=this.props.monthlySummaryData.monthlySummaryDataArray[this.props.monthlySummaryData.monthlySummaryActiveIndex+e];if(a&&!a.customData)this.props.fetchingData(),setTimeout((function(){t.props.updateActiveIndex(e,t.props.session.userProfile.fuelType)}),100);else{this.props.fetchingData();var i=this.props.monthlySummaryData.monthlySummaryDataArray[this.props.monthlySummaryData.monthlySummaryActiveIndex],n={locale:this.props.locale,"measurement-type":(0,d.nY)(this.props.session.userProfile.fuelType),"date-format":this.props.widgetConfigs.dateFormat,"highest-day-date-format":this.props.widgetConfigs.highestDayDateFormat};1===e?(n["bill-start"]=i.nextBillStart,n["bill-end"]=i.nextBillEnd,n["next-bill-cycle"]=!0):(n["bill-start"]=i.previousBillStart,n["bill-end"]=i.previousBillEnd,n["next-bill-cycle"]=!1),(0,v.JF)()&&(n.templateName="".concat(f.wY4.HOME.CONSUMPTION_BREAKDOWN,".FETCH_MONTHLY_SUMMARY_DATA")),this.setState({isErrorCase:!1,energyUsageTouNoData:!1,barChartNoData:!1}),this.props.fetchMonthlySummaryData(this.context.rc,this.props.userId,n,!0,this.props.session.userProfile.fuelType,f.zZZ.V3)}}},{key:"isNegative",value:function(e){return e<0}},{key:"isEnergyUsageNegativeData",value:function(e){var t=!1;if(e.touCost)for(var a in e.touCost)if(this.isNegative(e.touCost[a]))return t=!0;if(e.touConsumption)for(var i in e.touConsumption)if(this.isNegative(e.touConsumption[i]))return t=!0;return t}},{key:"handleErrorCase",value:function(e,t){var a=!1;e.currentMonthTOUData&&(a=this.isEnergyUsageNegativeData(e.currentMonthTOUData)),(e.currentMonthTOUData&&(Object.keys(e.currentMonthTOUData.touCost).length>0||Object.keys(e.currentMonthTOUData.touConsumption).length>0)||!t)&&!a||(this.setState({energyUsageTouNoData:!0,isErrorCase:!0}),e.currentMonthTOUData=R.currentMonthTOUData,e.customData=!0,e.energyUsageTouNoData=!0),e.itemizationDetails&&e.itemizationDetails.electric||(this.setState({barChartNoData:!0,isErrorCase:!0}),e.customData=!0,e.barChartNoData=!0,e.currentMonthAppliancesTouData=R.currentMonthAppliancesTouData,e.previousMonthAppliancesTouData=R.previousMonthAppliancesTouData),e.energyUsageTouNoData&&this.setState({energyUsageTouNoData:!0,isErrorCase:!0}),e.barChartNoData&&this.setState({barChartNoData:!0,isErrorCase:!0})}},{key:"render",value:function(){var e=m.V.getColors().colors,t=this.props,a=t.monthlySummaryData,i=t.translationsData,n=t.isMobileView,s=t.history,o=t.userId,r=t.showError,c=t.applianceList,h=t.widgetStrings,v=t.widgetConfigs,D=t.session,b=t.isSolar,M=t.configData,T=t.responsiveness,x=t.queryParams,A=t.deleteQueryParams,C=a.monthlySummaryDataArray[a.monthlySummaryActiveIndex],w="".concat((0,d.Yr)(C.itemizationDetails.startDateFormatted,f.DEY.YEAR,this.props.configData,n)," - ").concat((0,d.Yr)(C.itemizationDetails.endDateFormatted,f.DEY.YEAR,this.props.configData,n)),N=a.activeMode||"",_=this.props.session.userProfile.fuelType.toLowerCase(),O=this.props.configData&&(0,d.rK)(this.props.widgetConfigs,this.props.isSolar),k=(0,u.$R)(C,N,null,_,null,O,i["MONTHLY_SUMMARY.FULL_BILL.OTHER_CHARGES"]),j=this.context.runMode===f.K8z,I=(0,d.ib)(C.touUser);return a.fetchingData||this.state.isErrorCase||this.handleErrorCase(C,I),(0,p.jsxs)("div",{className:"monthly-summary-container ".concat(r?"error-overlay":""),children:[(0,p.jsx)(l.Fragment,{children:(0,p.jsxs)("div",{className:"ms-controller ".concat(j?"sdk-controller":""),children:[(0,p.jsx)("div",{className:"".concat(j?"widget-header-cont ".concat((0,d.jP)()?"no-bg":""," sdk-mode"):"ms-header"),"data-widget-name":f.wY4.INSIGHTS.MONTHLY_SUMMARY,"data-text-color":"foreground_400",children:(0,p.jsx)("span",{role:"heading","aria-level":2,children:h.title})}),(0,p.jsx)("div",{className:"insights-interval-cont",children:(0,p.jsx)(y.Z,{widgetName:f.wY4.INSIGHTS.MONTHLY_SUMMARY,enableLeftArrow:!a.leftArrowDisabled,enableRightArrow:!a.rightArrowDisabled,intervalDetails:w,handleArrowClick:this.fetchBillingCycleData,direction:1,translations:i})}),(0,p.jsx)("div",{})]})}),(0,p.jsxs)("div",{className:"".concat(a.fetchingData?"loading":""),children:[a.fetchingData&&(0,p.jsx)("div",{className:"ms-data-overlay","data-bg-color":"background_300",children:(0,p.jsx)(S.Z,{})}),r&&(0,p.jsx)("div",{className:"ms-data-overlay ms-data-error","data-bg-color":"background_300",children:(0,p.jsx)("div",{className:"error-info",children:C.itemizationDisclaimer?C.itemizationDisclaimer:h.apiError})}),(0,p.jsx)(g,{widgetStrings:h,widgetConfigs:v,isMobileView:n,configColors:e,widgetData:k,session:D,isSolar:b,monthlySummaryData:a,userId:o}),(0,p.jsxs)("div",{className:"ms-chart-container ".concat(this.state.energyUsageTouNoData?"no-data":""),children:[I&&(0,p.jsx)(V,{widgetStrings:h,widgetConfigs:v,isMobileView:n,session:D,isSolar:b,monthlySummaryData:a,msData:C,configData:M,configColors:e,energyUsageTouNoData:this.state.energyUsageTouNoData,queryParams:x,deleteQueryParams:A,applianceList:c}),0!==a.monthlySummaryDataArray.length&&(0,p.jsx)(Z,{responsiveness:T,monthlySummaryData:a,msData:C,configColors:e,widgetStrings:h,widgetConfigs:v,configData:M,session:D,history:s,isRunModeSdk:j,barChartNoData:this.state.barChartNoData,applianceList:c})]})]})]})}}]),a}(l.Component);W.contextType=h.zO;var K=(0,c.$j)((function(e){return{session:e.session,monthlySummaryData:e.monthlySummaryData,translationsData:e.translationsData.data,userId:e.session.userProfile.userId,configData:e.configs.data,locale:e.configs.locale,applianceList:e.appliances.appliancesList}}),(function(e){return{fetchMonthlySummaryData:function(t,a,i,n,s,o){return e((0,b.O)(t,a,i,n,s,o))},updateActiveIndex:function(t,a){return e((0,D.fp)(t,a))},updateActiveMode:function(t){return e((0,D.Ft)(t))},fetchingData:function(){return e((0,D.QC)())}}}))(W),q=a(62791),Q=a(61939),$=a(21629),X=a(21911),J=a(88291),ee=function(e){var t=e.isMobileView,a=e.monthlySummaryData,i=e.history,n=e.location,s=e.widgetConfigs,o=e.widgetStrings,r=m.V.getColors().colors,c=(0,h.WS)().rc,g=(0,l.useState)(!1),y=(0,x.Z)(g,2),v=y[0],D=y[1],b=s.surveyNavUrl,S=s.recommendationsNavUrl,M=a.monthlySummaryDataArray[a.monthlySummaryActiveIndex],T=(0,d.ib)(M.touUser),A=M.ratePlanImageData,C=(0,u.Bt)(A),w=function(){D(!v),c.analytics.trackEvent(f.FiA.INSIGHTS,{clicked:o.faqSectionRatePlanLink,version:f.zZZ.V3})},N=function(e,a,s){return(0,p.jsxs)("div",{className:"section",children:[(0,p.jsx)("div",{className:"desc",children:e}),(0,p.jsx)(L.Z,{btnVariant:"outlined",btnText:a,btnBackground:"rgb(".concat(r["--background_300"],")"),hoverColor:"rgb(".concat(r["--background_300"],")"),btnTextTransform:"none",btnTextSize:t?"12px":"14px",textColor:"rgb(".concat(r["--primary_500"],")"),borderColor:"rgb(".concat(r["--primary_500"],")"),btnWidth:"250px",onClick:function(e){return t=e,o=s,r=a,c.analytics.trackEvent(f.FiA.INSIGHTS,{clicked:r,version:f.zZZ.V3}),void(0,J.m3)($.Z$.INSIGHTS_MONTHLY_SUMMARY,i,n,t,o);var t,o,r},isMobileView:t})]})};return(0,p.jsxs)(p.Fragment,{children:[!a.fetchingData&&(0,p.jsxs)("div",{className:"useful-links-container",children:[(0,p.jsx)("div",{className:"heading",children:o.ctaSectionTitle}),(0,p.jsxs)("div",{className:"content",children:[N(o.homeProfileSectionDesc,o.homeProfileSectionBtn,b),N(o.tipsSectionDesc,o.tipsSectionBtn,S),(0,p.jsxs)("div",{className:"section",children:[T&&(0,p.jsx)("div",{children:(0,p.jsx)("a",{className:"link",onClick:w,href:"javascript:void(0)","aria-label":"".concat(o.faqSectionRatePlanLink),children:o.faqSectionRatePlanLink})}),(0,p.jsx)("div",{children:(0,p.jsx)(F.rU,{className:"link",to:U.O2,children:o.faqSectionItemizationFaqLink})})]})]})]}),(0,p.jsx)(G.Z,{ratePlanDialogData:C,widgetStrings:o,isMobileView:t,open:v,handleClose:w})]})},te=a(62426),ae=a(45764),ie=function(e){(0,o.Z)(a,e);var t=(0,r.Z)(a);function a(e){var n;return(0,i.Z)(this,a),(n=t.call(this,e)).widgetTrackingInfo=void 0,q.bs.subscribe(q.FP.RELOAD_WIDGET,n.init.bind((0,s.Z)(n))),n}return(0,n.Z)(a,[{key:"componentDidMount",value:function(){this.context.rc.analytics.trackEvent(f.FiA.INSIGHTS,{viewed:!0,shown:f.Q2X.MONTHLY_SUMMARY,version:f.zZZ.V3},this.props),this.init()}},{key:"init",value:function(){var e=(0,d.xW)(te.gI,this.props.configData);if(0===this.props.monthlySummaryData.monthlySummaryDataArray.length){var t={"date-format":e.dateFormat,"highest-day-date-format":e.highestDayDateFormat,locale:this.props.locale,"measurement-type":(0,d.nY)(this.props.session.userProfile.fuelType)};(0,v.JF)()&&(t.templateName="".concat(f.wY4.INSIGHTS.MONTHLY_SUMMARY,".FETCH_MONTHLY_SUMMARY_DATA")),this.props.fetchingData(),this.props.fetchMonthlySummaryData(this.context.rc,this.props.userId,t,!1,this.props.session.userProfile.fuelType,f.zZZ.V3)}}},{key:"componentDidUpdate",value:function(e){if(this.widgetTrackingInfo&&e.monthlySummaryData.fetchingData&&!this.props.monthlySummaryData.fetchingData){var t=this.props.monthlySummaryData.apiFailed?f.WW8.ERROR:this.props.monthlySummaryData.monthlySummaryDataArray.length?f.WW8.SUCCESS:f.WW8.DATA_NOT_AVAILABLE,a=this.props.monthlySummaryData.errorInfo;this.context.rc.analytics.logWidgetInfo(this.widgetTrackingInfo,t,a),this.widgetTrackingInfo=null}}},{key:"render",value:function(){var e=this.props,t=e.monthlySummaryData,a=e.responsiveness,i=e.translationsData,n=e.widgetStrings,s=e.queryParams,o=e.deleteQueryParams,r=a.isMobileView,l=(0,d.xW)(te.gI,this.props.configData),c=this.context.runMode===f.K8z,h=this.context.rc.session.isSolarUser(),g=!1;if(t&&t.monthlySummaryDataArray&&t.monthlySummaryActiveIndex>=0&&t.monthlySummaryDataArray.length){h=t.monthlySummaryDataArray[t.monthlySummaryActiveIndex].solarUser;var m=this.props.session.userProfile.fuelType.toLowerCase(),y=t.monthlySummaryDataArray[t.monthlySummaryActiveIndex];g=(0,u.Bo)(t,y,m)}return(0,p.jsx)("div",{className:"insights-ms-inner-container-v3 ".concat(c?"sdk-ms-container":""),role:"region","aria-label":i["INSIGHTS_MENU_ITEM.MONTHLY_SUMMARY"],children:0!==t.monthlySummaryDataArray.length?(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(K,{widgetConfigs:l,widgetStrings:n,isMobileView:r,history:this.props.history,location:this.props.location,isSolar:h,responsiveness:a,queryParams:s,deleteQueryParams:o,showError:g}),l.showUsefulLinks&&!g&&(0,p.jsx)(ee,{widgetConfigs:l,widgetStrings:n,isMobileView:r,history:this.props.history,location:this.props.location,monthlySummaryData:t})]}):t.apiFailed?(0,p.jsx)("div",{className:"error-page",children:(0,p.jsx)("div",{className:"error-msg",tabIndex:0,children:n.apiError})}):(0,p.jsx)("div",{className:"loading-wrapper",children:(0,p.jsx)(S.Z,{})})})}}]),a}(l.Component);ie.contextType=h.zO;var ne=(0,Q.$)($.Z$.INSIGHTS_MONTHLY_SUMMARY,(0,X.EN)((0,c.$j)((function(e){return{session:e.session,monthlySummaryData:e.monthlySummaryData,userId:e.session.userProfile.userId,configData:e.configs.data,locale:e.configs.locale,translationsData:e.translationsData.data,responsiveness:e.responsiveness,queryParams:e.queryParams}}),(function(e){return{fetchMonthlySummaryData:function(t,a,i,n,s,o){return e((0,b.O)(t,a,i,n,s,o))},fetchingData:function(){return e((0,D.QC)())},deleteQueryParams:function(t){return e((0,ae.Ow)(t))}}}))(ie)),f.zZZ.V3)},78023:function(e,t,a){a.d(t,{O:function(){return o}});var i=a(41130),n=a(82574),s=a(16404);function o(e,t,a,o,r,l){return function(c){var d=n.Hk.getEndpoint(t);e.apiClient.get(d,{params:a}).then((function(e){if(e.error)c((0,i.dC)(e.error));else{var t=e.data;o?c((0,i.K8)(t,r)):l===s.zZZ.V3?c((0,i.eO)(t,r)):c((0,i.pY)(t,r))}}))}}},317:function(e,t,a){a.d(t,{El:function(){return y},HL:function(){return p},cU:function(){return u},cZ:function(){return g},fD:function(){return f},jb:function(){return m},sO:function(){return r}});var i=a(56955),n=a(16404),s=a(19615),o=a(41294),r=function(e,t,a,o){var r=s.V.getColors().colors,l=e!==n.AgQ.PERCENTAGE&&t?t:"",c=e!==n.AgQ.PERCENTAGE?e===n.AgQ.COST?(0,i.xB)({cost:a,round:!0,showCurrency:!0}):(0,i.ub)({usage:a,round:!0,showUsageUnit:!0,fuelType:o}):"",d=c&&c.length<8?20:16,h=l?'<div style="text-align: center;font-size:16px;color:rgb('.concat(r["--foreground_500"],')">')+l+"</div>":"",u='<div style="text-align:center;font-size:'+d+"px;line-height:40px;padding-right:3px;font-weight:"+n.m5g.bold+";color:rgb(".concat(r["--foreground_500"],')">')+c+"</div>";if(h||u)return'<div aria-label="'.concat(l," ").concat(c,'">').concat(h+u,"</div>")},l=function(e){var t=e.plotLeft+e.series[0].center[0],a=e.plotTop+e.series[0].center[1];if(e.pieCenterText){var i=e.pieCenterText.getBBox();e.pieCenterText.attr({x:t-i.width/2,y:a-i.height/4,"aria-hidden":!1})}},c=function(e,t,a){return{align:"right",verticalAlign:"middle",x:-150,itemWidth:290,symbolWidth:10,symbolHeight:10,itemMarginTop:0,itemMarginBottom:20,padding:3,useHTML:!0,itemStyle:{fontSize:"18px",color:"rgb(".concat(e["--foreground_500"],")"),lineHeight:"25px",width:"290px"},labelFormatter:function(){var s={cost:this.y,percentage:this.percentage,usage:this.y,orgCost:this.orgCost,orgPercent:this.orgPercent,orgUsage:this.orgUsage},o=(0,i.fX)(t,s,a),r=this.name?this.name.replace(o,""):this.name;return'<span style="cursor:default; '.concat(0===this.index?"color:rgb(".concat(e["--foreground_500"],");font-weight:").concat(n.m5g.medium,";"):"color:rgb(".concat(e["--foreground_500"],");font-weight:").concat(n.m5g.normal,";"),'">')+o+" "+r+"</span>"}}},d=function(e,t,a,i){return{name:"",data:e,size:t,innerSize:a,sizeBy:"radius",showInLegend:i,accessibility:{enabled:i},dataLabels:{enabled:!1},states:{hover:{enabled:!1,halo:{size:0}},inactive:{opacity:1}}}},h=function(e,t,a){return{align:"right",x:0,width:"215px",verticalAlign:"middle",layout:"vertical",padding:3,itemMarginTop:0,itemMarginBottom:20,itemStyle:{fontSize:"14px",color:"rgb(".concat(e["--foreground_500"],")"),lineHeight:"22px",width:"230px"},labelFormatter:function(){var e={cost:this.y,percentage:this.percentage,usage:this.y,orgCost:this.orgCost,orgPercent:this.orgPercent,orgUsage:this.orgUsage},n=(0,i.fX)(t,e,a);return'<span style="cursor: default;">'+n+" "+(this.name?this.name.replace(n,""):this.name)+"</span>"}}},u=function(e,t,a,n,o,d,u,p){var g=s.V.getColors().colors,m={chart:{backgroundColor:"rgb(".concat(g["--background_300"],")"),type:"pie",marginLeft:0,marginTop:0,height:a?210:o,spacingLeft:0,style:{textShadow:"none",color:"rgb(".concat(g["--foreground_500"],")")},events:{load:function(){var i=r(t,n,e,d,a);if(i){var s=this,o=s.plotLeft+s.series[0].center[0],c=s.plotTop+s.series[0].center[1];s.pieCenterText=s.renderer.text(i,o,c,!0).add(),l(s)}},redraw:function(){l(this)}}},title:{text:""},subtitle:{text:""},plotOptions:{pie:{shadow:!1,startAngle:310,borderWidth:0,series:{allowPointSelect:!1,shadow:!1,events:{legendItemClick:function(){return!1},mouseOver:function(e){e.preventDefault()}}},point:{events:{legendItemClick:function(){return!1},mouseOver:function(e){e.preventDefault()}}},size:"80%"}},tooltip:{formatter:function(){var e={cost:this.y,percentage:this.percentage,usage:this.y,orgCost:this.point.orgCost,orgPercent:this.point.orgPercent,orgUsage:this.point.orgUsage},a=(0,i.fX)(t,e,d);return"<b>"+(this.point.name?this.point.name.replace(a,""):this.point.name)+"</b>: "+a}},legend:u?c(g,t,d):h(g,t,d)};return(0,i.IR)()&&(m.accessibility={enabled:!p,point:{descriptionFormatter:function(e){return e.name}}}),m},p=function(e,t,a,i){var n=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],s=[];return t&&1===t.length?(s.push(d(t,i.innerRing.size,i.innerRing.innerSize,n)),s):(s.push(d(e,i.outerSlice.size,i.outerSlice.innerSize,!1)),s.push(d(t,i.innerRing.size,i.innerRing.innerSize,n)),s.push(d(a,i.innerSlice.size,i.innerSlice.innerSize,!1)),s)},g=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=s.V.getColors().colors;return{chart:{backgroundColor:"rgb(".concat(i["--background_300"],")"),type:"bar",animation:{enabled:!1},marginRight:t?45:a?75:35,marginTop:20,height:e},xAxis:{lineWidth:0,minorGridLineWidth:0,lineColor:"transparent",categories:[],title:{text:null},labels:{enabled:!1}},yAxis:{gridLineWidth:0,minorGridLineWidth:0,min:0,title:{text:"",align:""},labels:{enabled:!1}},tooltip:{enabled:!1},plotOptions:{bar:{stacking:"normal",animation:!1},series:{borderWidth:0,enableMouseTracking:!0,pointWidth:10,states:{hover:{enabled:!1},inactive:{opacity:1}}}},legend:{enabled:!1}}},m=function(e,t,a,s,r){return{enabled:!r,point:{valueDescriptionFormat:null,descriptionFormatter:function(r){var l=(0,o.ht)(r.appId,t)+", ";switch(e){case n.AgQ.COST:l+="cost";var c=(0,i.xB)({cost:r.cost,round:!0,showCurrency:!0,lessThanOne:r.orgCost<1});l+=c&&-1!==c.indexOf("<")?c:"="+c,l+=", "+r.y+"%";break;case n.AgQ.PERCENTAGE:var d=(0,i.Q_)({percentageVal:r.percentage,round:!0,lessThanOne:r.orgPercent<1});l+=d&&-1!==d.indexOf("<")?d:"="+d;break;default:l+="usage";var h=(0,i.ub)({usage:r.usage,round:!0,showUsageUnit:!0,fuelType:a,lessThanOne:r.orgUsage<1});l+=h&&-1!==h.indexOf("<")?h:"="+h,l+=", "+r.y+"%"}return(0,i.xi)(l,s)}}}},f=function(e,t,a,r,l){var c=s.V.getColors().colors,d=[];return d.push({name:"",accessibility:{enabled:!1},data:t,color:"rgba(".concat(c["--data_colors_graph_primary"],", 0.20)"),dataLabels:{inside:!1,enabled:!0,useHTML:!0,formatter:function(){var t=((0,i.wG)(),"rgb(".concat(c["--foreground_500"],")")),a={cost:this.point.cost,percentage:100-this.point.percentage,usage:this.point.usage,orgCost:this.point.orgCost,orgPercent:this.point.orgPercent,orgUsage:this.point.orgUsage};return'<span style="position:absolute;top:-10px;padding-right:10px;width:90px;text-align:right;font-weight:'+n.m5g.bold+";font-size: 16px;color: "+t+';">'+(0,i.fX)(e,a,l)+"</span>"}}}),d.push({name:"",data:a,color:"".concat(((0,i.wG)(),"rgb(".concat(c["--data_colors_graph_primary"],")"))),dataLabels:{enabled:!0,align:"left",y:-10,style:{textOutline:0},useHTML:!0,formatter:function(){return'<span style="position:absolute;top:-30px;left:-5px;align-items:center;"><span class="bidgely-icon-'+(99===this.point.appId&&l===n.oVm.GAS?n.nO4[this.point.appId].iconClassNameGas+((0,i.wG)()?"-color-accessible":""):n.nO4[this.point.appId].iconClassName+((0,i.wG)()?"-color-accessible":""))+'" style="font-size:30px;"/><div style="display:inherit;padding-left: 10px;font-weight: '+n.m5g.medium+";font-family: "+(0,i.IQ)()+", Helvetica Neue, Arial, sans-serif;font-size: 16px;color: "+"rgb(".concat(c["--foreground_500"],');vertical-align:middle;">')+(0,o.ht)(this.point.appId,r)+"</div></span>"}}}),d},y=function(e){return e<=300?{itemTextWidth:e-10,itemWidth:void 0}:{itemTextWidth:e/2-5,itemWidth:e/2-10}}}}]);