"use strict";(self.webpackChunkmeraki=self.webpackChunkmeraki||[]).push([[787],{63834:function(e,t,a){a.r(t),a.d(t,{default:function(){return We}});var r=a(15671),n=a(43144),s=a(60136),i=a(98557),o=a(47313),c=a(1084),l=a(56955),d=a(83450),u=a(16404),p=a(74813),E=a(61113),f=a(21911),g=a(76720),m=a(46417);var h=(0,f.EN)((function(e){var t=(0,g.WS)().rc,a=(0,l.Xu)(),r=(0,p.W6)(),n=e.isSolar&&!(0,l.oF)(e.session.userProfile.userType),s=!(!e.configs||!e.configs.data)&&e.configs.data["DUAL.FOOTER_ENABLED"],i=e.translations.data,o=function(t,a){var r=!(!e.configs||!e.configs.data)&&e.configs.data["FOOTER.SHOW_NEW_SOCIAL_ICONS"];return t.map((function(e,t){return(0,m.jsx)("a",{href:e.link,className:r?"utility-social-icon":"utility-social-media-icon",target:"_blank",onClick:function(){return a(e.name)},"data-widget-name":u.wY4.FOOTER,"data-bg-color":"background_600","data-text-color":"foreground_300",rel:"noopener noreferrer",children:(0,m.jsx)("span",{className:"".concat(r?"bidgely-icon-".concat(e.name):e.name),title:e.name})},t)}))},c=function(a){t.analytics.trackEvent(u.FiA.PREFERENCE,{clicked:a,widget:u.wY4.FOOTER},e)},f=function(t){var r=[{key:"{faqsLink}",value:d.O2},{key:"{className}",value:"link"},{key:"{privacyLink}",value:e.configs.data?e.configs.data["privacyLink_"+a]:"#"},{key:"{privacyNoticeLink}",value:e.configs.data?e.configs.data["privacyNoticeLink_"+a]:"#"},{key:"{unsubscribeLink}",value:d.Md+"?tab-type=alertType"}];return t=(0,l.$j)(t,r)},h=e.configs.data["footer.footer_css_container_class"],b=e.configs.data["dashboard.footer.fadeLinksText"],S=function(t){var a=[{key:"{year}",value:(new Date).getFullYear()},{key:"{uuid}",value:e.uuid}];return t=(0,l.$j)(t,a)},N=(s?[0,1]:[0]).map((function(t,r){var n=0==t?"":"1";return{displayIcons:o(e.configs&&e.configs.data?JSON.parse(e.configs.data["social-media-links".concat(n)]):[],c),utilityName:i["UTILITY_INFO".concat(n,".NAME")],footerNote:e.footerNote?f(e.footerNote):"",addressLine1:i["UTILITY_INFO".concat(n,".ADDRESS_LINE1")],addressLine2:i["UTILITY_INFO".concat(n,".ADDRESS_LINE2")],utilityZipCode:i["UTILITY_INFO".concat(n,".ADDRESS_ZIPCODE")],copyRightNote:i["COPY_RIGHT_NOTE".concat(n)],utilityPhone:i["UTILITY_INFO".concat(n,".PHONE_NO")],utilityEmail:i["UTILITY_INFO".concat(n,".EMAIL")],footerDisclaimerEnabled:!(!e.configs||!e.configs.data)&&e.configs.data["FOOTER".concat(n,".DISCLAIMER_ENABLED")],footerDisclaimerText:i["FOOTER".concat(n,".DISCLAIMER")],showTOSLinkFooter:e.configs.data["showTOSlink".concat(n)],utilityPrivacy:{tosLink:e.configs.data["termsLink".concat(n,"_")+a],tosText:i["UTILITY_INFO".concat(n,".TERMS_OF_SERVICE")],showFAQLinkFooter:e.configs.data["showFaqLink".concat(n)],faqText:i["UTILITY_INFO".concat(n,".FAQ")],faqLink:e.configs.data["faqLink".concat(n,"_")+a],privacyPolicyText:i["UTILITY_INFO".concat(n,".PRIVACY_POLICY")],showUtilityPrivacyFooter:e.configs.data["FOOTER".concat(n,".SHOW_UTILITY_PRIVACY_POLICY")],utilityPrivacyPolicyText:i["UTILITY_INFO".concat(n,".UTILITY_PRIVACY_POLICY")],utilityPrivacyPolicyLink:e.configs.data["utilityPrivacyLink".concat(n,"_")+a],showBidgelyPrivacyPolicyFooter:e.configs.data["showPrivacyLink".concat(n)],bidgelyPrivacyPolicyText:i["UTILITY_INFO".concat(n,".PRIVACY_POLICY")],bidgelyPrivacyPolicyLink:e.configs.data["privacyLink".concat(n,"_")+a]}}}));return(0,m.jsx)(m.Fragment,{children:!r&&(0,m.jsxs)("footer",{role:"contentinfo",className:"utility-footer","data-widget-name":u.wY4.FOOTER,"data-bg-color":"background_300",children:[n&&(0,m.jsx)(E.Z,{classes:{root:"utility-footer-disclaimer"},"data-widget-name":u.wY4.FOOTER,"data-text-color":"foreground_400",children:i["FOOTER.SOLAR_DISCLAIMER"]}),(0,m.jsx)("div",{className:"".concat(h," utility-footer-container"),children:N.map((function(t,a){return(0,m.jsx)("div",{className:"".concat(h," utility-footer-container footer-inner"),children:(0,m.jsxs)("div",{className:"footer-item",children:[(0,m.jsx)("div",{className:"utility-social-media-icons ".concat((0,l.wG)()?"utility-social-media-icons-color-accessible":""),children:t.displayIcons}),(0,m.jsx)("div",{className:"utility-name",children:(0,m.jsx)("span",{"data-widget-name":u.wY4.FOOTER,"data-text-color":"foreground_400",children:t.utilityName})}),e.footerNote?(0,m.jsxs)("div",{className:"privacy-note",children:[(0,m.jsx)("span",{dangerouslySetInnerHTML:{__html:f(e.footerNote)}}),(0,m.jsx)("br",{})]}):"",(0,m.jsxs)("span",{className:"utility-address",children:[(0,m.jsx)("span",{dangerouslySetInnerHTML:{__html:S(t.addressLine1)}}),t.addressLine2?(0,m.jsxs)("span",{"data-widget-name":u.wY4.FOOTER,"data-text-color":"foreground_400",children:[(0,m.jsx)("br",{}),t.addressLine2]}):"",t.utilityZipCode?(0,m.jsxs)("span",{"data-widget-name":u.wY4.FOOTER,"data-text-color":"foreground_400",children:[(0,m.jsx)("br",{}),t.utilityZipCode]}):""]}),N[a].copyRightNote&&(0,m.jsxs)("span",{className:"utility-address","data-widget-name":u.wY4.FOOTER,"data-text-color":"foreground_400",children:[(0,m.jsx)("br",{}),t.copyRightNote]}),(0,m.jsx)("div",{className:"utility-phone",children:(0,m.jsx)("span",{"data-widget-name":u.wY4.FOOTER,"data-text-color":"foreground_400",children:t.utilityPhone})}),(0,m.jsx)("div",{className:"utility-email",children:(0,m.jsx)("span",{"data-widget-name":u.wY4.FOOTER,"data-text-color":"foreground_400",children:t.utilityEmail})}),N[a].footerDisclaimerEnabled&&(0,m.jsx)(E.Z,{classes:{root:"utility-footer-disclaimer"},"data-widget-name":u.wY4.FOOTER,"data-text-color":"foreground_400",children:(0,m.jsx)("span",{dangerouslySetInnerHTML:{__html:t.footerDisclaimerText}})}),t.showTOSLinkFooter?(0,m.jsxs)("div",{className:"utility-tos ".concat((0,l.wG)()?"tos-color-accessible":""," ").concat(b?"":"highlight-text"),children:[t.utilityPrivacy.tosText&&(0,m.jsx)("div",{children:(0,m.jsx)("a",{href:t.utilityPrivacy.tosLink||"#",rel:"noopener noreferrer",target:"_blank",onClick:function(){return c(t.utilityPrivacy.tosText)},"data-widget-name":u.wY4.FOOTER,"data-text-color":"primary_500",children:t.utilityPrivacy.tosText})}),t.utilityPrivacy.showFAQLinkFooter&&t.utilityPrivacy.faqText?(0,m.jsx)("div",{children:(0,m.jsx)("a",{href:t.utilityPrivacy.faqLink?t.utilityPrivacy.faqLink:"#",rel:"noopener noreferrer",target:"_blank",onClick:function(){return c(t.utilityPrivacy.faqText)},"data-widget-name":u.wY4.FOOTER,"data-text-color":"primary_500",children:t.utilityPrivacy.faqText})}):"",t.utilityPrivacy.showUtilityPrivacyFooter&&t.utilityPrivacy.utilityPrivacyPolicyText?(0,m.jsx)("div",{children:(0,m.jsx)("a",{href:t.utilityPrivacy.utilityPrivacyPolicyLink||"#",rel:"noopener noreferrer",target:"_blank",onClick:function(){return c(t.utilityPrivacy.utilityPrivacyPolicyText)},"data-widget-name":u.wY4.FOOTER,"data-text-color":"primary_500",children:t.utilityPrivacy.utilityPrivacyPolicyText})}):"",t.utilityPrivacy.showBidgelyPrivacyPolicyFooter&&t.utilityPrivacy.bidgelyPrivacyPolicyText?(0,m.jsx)("div",{children:(0,m.jsx)("a",{href:t.utilityPrivacy.bidgelyPrivacyPolicyLink||"#",rel:"noopener noreferrer",target:"_blank",onClick:function(){return c(t.utilityPrivacy.bidgelyPrivacyPolicyText)},"data-widget-name":u.wY4.FOOTER,"data-text-color":"primary_500",children:t.utilityPrivacy.bidgelyPrivacyPolicyText})}):""]}):""]},"footer-item".concat(a))},"footer-item-".concat(a))}))})]})})})),b=a(93433),S=a(97326),N=a(9019),T=a(70178),x=a(69140),v=a(19615),y=function(e){(0,s.Z)(a,e);var t=(0,i.Z)(a);function a(){var e;(0,r.Z)(this,a);for(var n=arguments.length,s=new Array(n),i=0;i<n;i++)s[i]=arguments[i];return(e=t.call.apply(t,[this].concat(s))).configColors=v.V.getColors().colors,e}return(0,n.Z)(a,[{key:"render",value:function(){var e=this,t=this.props.responsiveness,a=t.isMobileView,r=t.isXLMobileView,n=t.isTabletView||a?"16px":"18px",s=[{id:u.n_d.CONTACT_INFO,class:"contact-tab",icon:"bidgely-icon-contact"},{id:u.n_d.ALERT_TYPE,class:"alert-tab",icon:"bidgely-icon-alert"},{id:u.n_d.SETTINGS,class:"settings-tab",icon:"bidgely-icon-setting"}],i=u.eSs.TABS,c=function(t){switch(t){case u.n_d.CONTACT_INFO:return e.props.widgetStrings.contactInfoTab;case u.n_d.ALERT_TYPE:return e.props.widgetStrings.alertsTab;case u.n_d.SETTINGS:return e.props.widgetStrings.settingsTab}};return(0,m.jsx)("div",{className:"preference-left-container","data-widget-name":u.wY4.SETTINGS_AND_PREFERENCES,"data-bg-color":"background_300","data-text-color":"foreground_400","data-active-color":"primary_500",children:s.map((function(t){return(0,m.jsx)(o.Fragment,{children:-1!==e.props.preferencesTabs.indexOf(t.id)&&(0,m.jsx)(N.ZP,{item:!0,xs:12,sm:12/e.props.preferencesTabs.length,md:12,className:"tab-container",children:(0,m.jsx)(x.Z,{cssClassName:"preference-tab ".concat(t.class),btnHeight:"56px",btnVariant:e.props.activePane===i[t.id]?"contained":"outlined",btnText:a||r?"":c(t.id),btnBackground:"rgb(".concat(e.configColors["--background_300"],")"),borderColor:e.props.activePane!==i[t.id]?"rgb(".concat(e.configColors["--background_500"],")"):void 0,hoverColor:"rgb(".concat(e.configColors["--background_300"],")"),btnTextTransform:"none",btnTextSize:n,btnTextColor:"rgb(".concat(e.configColors["--foreground_500"],")"),isBidgelyIcon:!0,iconLeft:t.icon+" tab-icon",iconActiveColor:"rgb(".concat(e.configColors["--primary_500"],")"),isIconActive:e.props.activePane===i[t.id],labelAlign:a||r?"center":"left",isActive:e.props.activePane===i[t.id],activeTextColor:"rgb(".concat(e.configColors["--primary_500"],")"),onClick:function(){return e.props.updatePane(i[t.id])},onKeyPress:function(a){return e.props.updatePane(i[t.id],a)}})})},t.id)}))})}}]),a}(o.Component),C=y,R=a(1413),_=a(1168),A=a(87421),P=a(70501),I=a(94469),D=a(46123),w=a.n(D),k=a(21573),L=a.n(k),F=a(83929),O=a(44758);var j=function(e){return e&&e.toString().trim()&&!isNaN(e)&&!/\./.test(e)&&e>0},M=function(e){return/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}$/i.test(e)},Z=function(e){(0,s.Z)(a,e);var t=(0,i.Z)(a);function a(e){var n;(0,r.Z)(this,a),(n=t.call(this,e)).state={dialogBoxOpen:!1,validating:!1,saving:!1,isInvalidEmail:!1,isPrimaryEmailPresent:!1,isInvalidValue:!0,applyToAllPremises:!1,initialData:null,formControl:null};var s=n.props.translations;return n.configColors=v.V.getColors().colors,n.customErrorMsg={REQUIRED:s["PREFERENCE.CONTACT_INFO.REQUIRED_FIELD"],EMAIL_INVALID:s["PREFERENCE.CONTACT_INFO.EMAIL_INVALID"],PHONE_INVALID:s["PREFERENCE.CONTACT_INFO.PHONE_NO_INVALID"],IDENTICAL_EMAIL_ERROR:s["PREFERENCE.CONTACT_INFO.IDENTICAL_EMAIL_ERROR"],IDENTICAL_PHONE_NO_ERROR:s["PREFERENCE.CONTACT_INFO.IDENTICAL_PHONE_NO_ERROR"]},n.formControls=[{label:s["PREFERENCE.PRIMARY_EMAIL"]+" ("+s["PREFERENCE.REQUIRED"]+")",fieldName:"PRIMARY_EMAIL",type:"email",required:!0,hasValue:!1,editBtnAriaLabel:s["PREFERENCE.EDIT"]+" "+s["PREFERENCE.PRIMARY_EMAIL"]},{label:s["PREFERENCE.SECONDARY_EMAIL"]+" ("+s["PREFERENCE.OPTIONAL"]+")",fieldName:"SECONDARY_EMAIL",type:"email",required:!1,hasValue:!1,editBtnAriaLabel:s["PREFERENCE.EDIT"]+" "+s["PREFERENCE.SECONDARY_EMAIL"]},{label:s["PREFERENCE.PRIMARY_NUMBER"]+" ("+s["PREFERENCE.OPTIONAL"]+")",fieldName:"PRIMARY_SMS",type:"phone",required:!1,hasValue:!1,editBtnAriaLabel:s["PREFERENCE.EDIT"]+" "+s["PREFERENCE.PRIMARY_NUMBER"]},{label:s["PREFERENCE.SECONDARY_NUMBER"]+" ("+s["PREFERENCE.OPTIONAL"]+")",fieldName:"SECONDARY_SMS",type:"phone",required:!1,hasValue:!1,editBtnAriaLabel:s["PREFERENCE.EDIT"]+" "+s["PREFERENCE.SECONDARY_NUMBER"]}],n.maskedString=["(",/[0-9]/,/\d/,/\d/,")"," ",/\d/,/\d/,/\d/,"-",/\d/,/\d/,/\d/,/\d/],n.validateInput=n.validateInput.bind((0,S.Z)(n)),n.submitResponse=n.submitResponse.bind((0,S.Z)(n)),n.closeDialogBox=n.closeDialogBox.bind((0,S.Z)(n)),n.openDialogBox=n.openDialogBox.bind((0,S.Z)(n)),n.validateDialogBoxInput=n.validateDialogBoxInput.bind((0,S.Z)(n)),n.getContactInfoData=n.getContactInfoData.bind((0,S.Z)(n)),n.openInEditableMode=n.openInEditableMode.bind((0,S.Z)(n)),n.isPrimaryEmailPresent=n.isPrimaryEmailPresent.bind((0,S.Z)(n)),n.inputRefs=[],n}return(0,n.Z)(a,[{key:"componentWillUnmount",value:function(){this.props.resetCommunicationPreferences()}},{key:"componentDidMount",value:function(){!this.props.preferencesData.contactInfoData.length!==this.formControls.length&&(this.updateControls(),this.getContactInfoData())}},{key:"componentDidUpdate",value:function(e){this.props.isSessionSSO&&!this.state.isPrimaryEmailPresent&&this.context.runMode!==u.K8z&&this.inputRefs[0].focus(),(0,c.wU)(this.props.preferencesData.contactInfoData,e.preferencesData.contactInfoData)||(this.updateControls(),this.getContactInfoData())}},{key:"isPrimaryEmailPresent",value:function(e){var t=!1;if("PRIMARY"===this.props.preferencesData.contactInfoData[e].channelType)for(var a=0;a<this.formControls.length;a++)if(this.formControls[a].fieldName==="".concat(this.props.preferencesData.contactInfoData[e].channelType,"_").concat(this.props.preferencesData.contactInfoData[e].channel)){t=!0;break}return t}},{key:"updateControls",value:function(){var e=this;this.formControls.forEach((function(t,a){a<e.props.preferencesData.contactInfoData.length&&e.isPrimaryEmailPresent(a)?("PRIMARY"===e.props.preferencesData.contactInfoData[a].channelType&&e.props.preferencesData.contactInfoData[a].id.length>0&&e.setState({isPrimaryEmailPresent:!0}),t.hasValue=!0):t.hasValue=!1}))}},{key:"getContactInfoData",value:function(){var e=function(e){var t={PRIMARY_EMAIL:"",SECONDARY_EMAIL:"",PRIMARY_SMS:"",SECONDARY_SMS:""};return e.forEach((function(e){t[e.channelType+"_"+e.channel]=e.id})),t}(this.props.preferencesData.contactInfoData);return this.formControls.forEach((function(t){for(var a in e)(0,l.nr)(e,a)&&t.fieldName===a&&e[t.fieldName].length&&(t.hasValue=!0)})),this.setState({initialData:e}),e}},{key:"validateInput",value:function(e){var t=this,a={};this.formControls.forEach((function(r){var n,s=r.fieldName,i=r.required,o=r.type;if(void 0===e[s])return a;if(i&&!e[s]&&(a[s]=t.customErrorMsg.REQUIRED),e[s])switch(o){case"email":var c=e.PRIMARY_EMAIL,l=e.SECONDARY_EMAIL;M(e[s])?c&&l&&c.toLowerCase()===l.toLowerCase()&&(a.SECONDARY_EMAIL=t.customErrorMsg.IDENTICAL_EMAIL_ERROR):a[s]=t.customErrorMsg.EMAIL_INVALID;break;case"phone":e[s]=e[s].replace(/[^0-9]+/gi,""),n=(n=e[s]).toString(),-1!==["0","1"].indexOf(n.substr(0,1))||10!==n.toString().length?a[s]=t.customErrorMsg.PHONE_INVALID:e.PRIMARY_SMS&&e.SECONDARY_SMS&&e.PRIMARY_SMS===e.SECONDARY_SMS&&(a.SECONDARY_SMS=t.customErrorMsg.IDENTICAL_PHONE_NO_ERROR)}}));var r=this.getContactInfoData(),n=!1;return Object.keys(r).forEach((function(t){if(e[t]!==r[t])return n=!0})),this.setState({isInvalidValue:!n||!(0,l.Qr)(a)}),a}},{key:"submitResponse",value:function(e){var t=this;if(this.context.rc.analytics.trackEvent(u.FiA.PREFERENCE,{shown:u.eSs.TABS.CONTACT_INFO,clicked:u.eSs.SAVE_CHANGES,widget:u.wY4.SETTINGS_AND_PREFERENCES}),this.setState({saving:!0}),this.props.preferencesData.validated){var a=function(e,t){var a=[];return Object.keys(e).forEach((function(r){if(t[r]!==e[r]){var n=r.split("_"),s={channel:n[1],channelType:n[0],id:e[r]};a.push(s)}})),a}(e,this.getContactInfoData());this.props.setCommunicationPreferences(a,this.state.applyToAllPremises),this.setState({initialData:a})}setTimeout((function(){t.setState({saving:!1})}),1e3)}},{key:"validateDialogBoxInput",value:function(e){var t={};return e.emailId?M(e.emailId)||(t.emailId=this.customErrorMsg.EMAIL_INVALID):t.emailId=this.customErrorMsg.REQUIRED,this.setState({isInvalidEmail:!1}),t}},{key:"closeDialogBox",value:function(){var e=this;this.setState({dialogBoxOpen:!1,isInvalidEmail:!1}),this.state.formControl&&setTimeout((function(){var t=document.getElementById(e.state.formControl.fieldName);t&&_.findDOMNode(t).focus()}),1e3)}},{key:"openDialogBox",value:function(e){this.setState({dialogBoxOpen:!0,formControl:e}),this.context.rc.analytics.trackEvent(u.FiA.PREFERENCE,{shown:u.eSs.TABS.CONTACT_INFO,clicked:u.eSs.EDIT,widget:u.wY4.SETTINGS_AND_PREFERENCES})}},{key:"openInEditableMode",value:function(){this.props.setEditableMode(this.props.isSessionSSO)}},{key:"triggerEmailValidation",value:function(e){var t=this;this.setState({validating:!0}),this.props.validateEmail(e.emailId),setTimeout((function(){var e={validating:!1,isInvalidEmail:!0};t.props.preferencesData.isInvalidEmail?t.context.rc.analytics.trackEvent(u.FiA.PREFERENCE,{shown:u.eSs.TABS.CONTACT_INFO,clicked:u.eSs.EDIT,success:!1,widget:u.wY4.SETTINGS_AND_PREFERENCES}):(t.context.rc.analytics.trackEvent(u.FiA.PREFERENCE,{shown:u.eSs.TABS.CONTACT_INFO,clicked:u.eSs.EDIT,success:!0,widget:u.wY4.SETTINGS_AND_PREFERENCES}),e.isInvalidEmail=!1,t.closeDialogBox()),t.setState(e)}),1e3)}},{key:"render",value:function(){var e=this,t=this.props,a=t.preferencesData,r=a.validated,n=a.isEditable,s=a.showSMS,i=a.fetchContactInfoFailed,c=a.fetchContactInfoSuccess,d=t.translations,p=t.isSessionSSO,E=t.showSmsDisclaimer,f=this.state,g=f.validating,h=f.saving,b=f.dialogBoxOpen,S=f.isInvalidEmail,T=f.isPrimaryEmailPresent,v=f.isInvalidValue,y=function(e){return w()({field:!0,"field-enabled":!e&&!(r&&!n),"field-disabled":!(r&&!n)})},C=w()({"input-wrapper":r}),_=w()("submit-btn ".concat((0,l.wG)()?" color-accessible":""),{disabled:h||!r||n||v}),D=w()("btn","submit",{disabled:g||S}),k=w()("btn","cancel",{disabled:g});return(0,m.jsxs)(P.Z,{className:"contact-info-form",children:[(0,m.jsx)(A.J9,{enableReinitialize:!0,initialValues:this.state.initialData,validate:function(t){return e.validateInput(t)},onSubmit:function(t){return e.submitResponse(t)},children:(0,m.jsxs)(A.l0,{noValidate:!0,role:"form","aria-label":d.PREFERENCE_TAB_CONTACT_INFORMATION,children:[this.formControls.map((function(t,a){return(0,m.jsxs)(o.Fragment,{children:[a<2||s?(0,m.jsxs)(N.ZP,{container:!0,direction:"row",justifyContent:"center",className:"input-wrapper","data-widget-name":u.wY4.SETTINGS_AND_PREFERENCES,"data-text-color":"foreground_500",children:[(0,m.jsx)(N.ZP,{item:!0,xs:12,sm:5,children:(0,m.jsx)("label",{className:"input-label",htmlFor:t.fieldName,children:t.label})}),(0,m.jsx)(N.ZP,{item:!0,xs:12,sm:7,children:(0,m.jsxs)(N.ZP,{container:!0,direction:"row",justifyContent:"center",alignItems:"center",children:[(0,m.jsx)(N.ZP,{item:!0,xs:r&&!n?12:9,sm:9,"data-widget-name":u.wY4.SETTINGS_AND_PREFERENCES,"data-text-color":"foreground_500","data-bg-color":"background_300",children:(0,m.jsxs)("div",{className:C,children:["email"===t.type||!r||n?(0,m.jsx)(A.gN,{type:t.type,id:t.fieldName,name:t.fieldName,className:y(t.hasValue),disabled:!r||n,autoComplete:"off",innerRef:function(t){return e.inputRefs.push(t)}}):(0,m.jsx)(A.gN,{name:t.fieldName,render:function(a){var s=a.field;return(0,m.jsx)(L(),(0,R.Z)((0,R.Z)({mask:e.maskedString},s),{},{disabled:!r||n,autoComplete:"off",id:t.fieldName,className:y(t.hasValue)}))}}),(0,m.jsx)("div",{className:"error-msg-wrapper",children:(0,m.jsx)(A.Bc,{name:t.fieldName,component:"div",className:"error-message"})})]})}),(0,m.jsx)(N.ZP,{item:!0,xs:3,"data-widget-name":u.wY4.SETTINGS_AND_PREFERENCES,"data-bg-color":"background_300","data-text-color":"primary_500",children:r||p&&!T?n?(0,m.jsx)(x.Z,{btnText:d["PREFERENCE.EDIT"],btnBackground:"rgb(".concat(e.configColors["--background_300"],")"),hoverColor:"rgb(".concat(e.configColors["--background_300"],")"),btnTextTransform:"none",btnTextSize:"16px",ariaLabel:t.editBtnAriaLabel,btnTextColor:"rgb(".concat(e.configColors["--primary_500"],")"),iconLeft:"edit",iconMarginRight:"8px",onClick:e.openInEditableMode,paddingBottom:"20px",dataFocusElement:(0,l.IR)()}):"":(0,m.jsx)(x.Z,{btnText:d["PREFERENCE.EDIT"],btnBackground:"rgb(".concat(e.configColors["--background_300"],")"),hoverColor:"rgb(".concat(e.configColors["--background_300"],")"),btnTextTransform:"none",btnTextSize:"16px",ariaLabel:t.editBtnAriaLabel,btnTextColor:"".concat(((0,l.wG)(),"rgb(".concat(e.configColors["--primary_500"],")"))),iconLeft:"edit",iconMarginRight:"8px",onClick:function(){return e.openDialogBox(t)},paddingBottom:"20px",dataFocusElement:(0,l.IR)()})})]})})]}):"",s&&1===a?(0,m.jsx)("div",{className:"divider"}):""]},a)})),(0,m.jsx)("br",{}),E&&s&&(0,m.jsx)(N.ZP,{container:!0,direction:"row",alignItems:"center",justifyContent:"flex-end",children:(0,m.jsx)(N.ZP,{item:!0,xs:12,children:(0,m.jsx)("div",{className:"disclaimer-container",children:d["PREFERENCES.CONTANT_INFO.SMS_DISCLAIMER"]})})}),(0,m.jsx)(N.ZP,{container:!0,direction:"row",alignItems:"center",justifyContent:"flex-end",children:(0,m.jsxs)(N.ZP,{item:!0,xs:12,sm:7,children:[this.props.premisesDetails&&this.props.premisesDetails.premises&&this.props.premisesDetails.premises.length>1&&(0,m.jsx)("div",{className:"btn-container",children:(0,m.jsx)(F.Z,{className:"premises-btn",label:d["PREFERENCE.PREMISES_BUTTON_TEXT"],labelPlacement:"end",disabled:h||!r||n||v,"data-widget-name":u.wY4.SETTINGS_AND_PREFERENCES,"data-text-color":"foreground_400",control:(0,m.jsx)(O.Z,{value:d["PREFERENCE.PREMISES_BUTTON_TEXT"],classes:{checked:"premises-checkbox-btn"},onChange:function(){return e.setState({applyToAllPremises:!e.state.applyToAllPremises})},checked:this.state.applyToAllPremises,disableRipple:!0,color:"default",inputProps:{"aria-label":d["PREFERENCE.PREMISES_BUTTON_CONTACT_ADA_TEXT"]}})})}),(0,m.jsx)("div",{className:"btn-container","data-widget-name":u.wY4.SETTINGS_AND_PREFERENCES,"data-bg-color":"primary_500","data-text-color":"foreground_300",children:(0,m.jsx)("button",{type:"submit",className:_,disabled:h||!r||n||v,children:h?d["PREFERENCE.BUTTONS.SAVING"]:d["PREFERENCE.BUTTONS.SAVE_CHANGES"]})}),(0,m.jsxs)("div",{className:"message-wrapper",children:[i?(0,m.jsx)("span",{className:"error-text",dangerouslySetInnerHTML:{__html:d["PREFERENCE.SOMETHING_WENT_WRONG"]},"data-widget-name":u.wY4.SETTINGS_AND_PREFERENCES,"data-text-color":"bgl_red_500"}):"",c?(0,m.jsx)("span",{className:"".concat((0,l.wG)()?"success-text-accessible":"success-text"),dangerouslySetInnerHTML:{__html:d["PREFERENCE.TAB.CONTACT_INFO.SAVE_SUCCESS"]},"data-widget-name":u.wY4.SETTINGS_AND_PREFERENCES,"data-text-color":"bgl_green_400"}):""]})]})})]})}),(0,m.jsx)(I.Z,{open:b,onClose:this.closeDialogBox,"aria-labelledby":"form-dialog-title",classes:{root:"dialog-box-root-container",paper:"dialog-box-container"},role:"dialog",children:(0,m.jsxs)("div",{className:"dialog-box",children:[(0,m.jsxs)("div",{className:"header","data-widget-name":u.wY4.SETTINGS_AND_PREFERENCES,"data-text-color":"foreground_500",children:[d["PREFERENCE.TAB.CONTACT_INFO.EDIT_NOTE.P1"]," ",(0,m.jsx)("span",{className:"current",children:d["PREFERENCE.TAB.CONTACT_INFO.EDIT_NOTE.P2"]})," ",d["PREFERENCE.TAB.CONTACT_INFO.EDIT_NOTE.P3"]]}),(0,m.jsx)(A.J9,{initialValues:{emailId:""},validate:function(t){return e.validateDialogBoxInput(t)},onSubmit:function(t){return e.triggerEmailValidation(t)},children:function(t){var a=t.errors;return(0,m.jsxs)(A.l0,{className:"dialog-box-form",role:"form","aria-label":d.CONTACT_INFO_ARIA_LABEL,children:[(0,m.jsxs)("label",{className:"dialog-email-label","data-widget-name":u.wY4.SETTINGS_AND_PREFERENCES,"data-text-color":"foreground_400",children:[d["PREFERENCE.VALIDATE_EMAIL_LABEL"],(0,m.jsxs)("div",{className:"dialog-input-wrapper","data-widget-name":u.wY4.SETTINGS_AND_PREFERENCES,"data-border-color":"background_500",children:[(0,m.jsx)(A.gN,{type:"email",name:"emailId",placeholder:d["PREFERENCE.VALIDATE_PRIMARY_EMAIL_PLACEHOLDER"],className:"dialog-input",autoComplete:"off","aria-describedby":S||Object.keys(a).length?"error-message":null,"aria-invalid":S||Object.keys(a).length}),(0,m.jsx)(A.Bc,{name:"emailId",component:"div",className:"error-message",id:"error-message"}),S?(0,m.jsx)("div",{className:"error-message",id:"error-message",children:d["PREFERENCE.EMAIL_INVALID"]}):""]})]}),(0,m.jsxs)("div",{className:"dialog-btn-grp",children:[(0,m.jsx)("span",{"data-widget-name":u.wY4.SETTINGS_AND_PREFERENCES,"data-text-color":"foreground_300","data-bg-color":"primary_500",className:"btn-container",children:(0,m.jsx)("button",{type:"submit",className:D,disabled:g||S,"data-widget-name":u.wY4.SETTINGS_AND_PREFERENCES,"data-text-color":"foreground_500","aria-describedby":S||Object.keys(a).length?"error-message":null,children:g?d["PREFERENCE.BUTTONS.SUBMITTING"]:d["PREFERENCE.BUTTONS.SUBMIT"]})}),(0,m.jsx)("span",{"data-widget-name":u.wY4.SETTINGS_AND_PREFERENCES,"data-text-color":"foreground_300","data-bg-color":"background_500",className:"btn-container",children:(0,m.jsx)("button",{type:"button",onClick:e.closeDialogBox,className:k,disabled:g,children:d["PREFERENCE.BUTTONS.CANCEL"]})})]})]})}})]})})]})}}]),a}(o.Component);Z.contextType=g.zO;var B=a(86521);var G=a(14427),Y=a(11198);function U(e){var t=function(t){return(0,l.Z7)(e.translations["SMS.RESUBSCRIBE_ALERT"],function(e){return{PHONE_NUMBER:e.id,UTILITY_NUMBER:e.twilioMessageSourceNumber}}(t))};return(0,m.jsx)(m.Fragment,{children:(0,m.jsx)("div",{className:"channel-blocked-alert-container","data-widget-name":e.widgetName,"data-bg-color":"primary_200",children:(0,m.jsx)(I.Z,{maxWidth:"md",role:"dialog",open:e.showChannelBlockedAlert,className:"modal alert-dialog",children:(0,m.jsxs)("div",{className:"alert-dialog-box-wrapper",children:[(0,m.jsx)("div",{className:"alert-dialog-close",children:(0,m.jsx)(Y.Z,{classes:{root:"close-icon"},onClick:function(){return e.handleChannelBlockedDialog()},tabIndex:"0",role:"button"})}),(0,m.jsx)("div",{className:"alert-dialog-content",children:e.alertDialogData.map((function(e,a){if(e.channel===u.XHW.SMS.toUpperCase()&&e.blocked)return(0,m.jsx)("div",{className:"alert-dialog-text",dangerouslySetInnerHTML:{__html:t(e)}},a)}))})]})})})})}var H=function(e){(0,s.Z)(a,e);var t=(0,i.Z)(a);function a(e){var n;return(0,r.Z)(this,a),(n=t.call(this,e)).handleChannelBlockedDialog=function(){n.setState({showChannelBlockedAlert:!n.state.showChannelBlockedAlert})},n.state={showChannelBlockedAlert:!1},n.validateEmail=n.validateEmail.bind((0,S.Z)(n)),n.handleChannelBlockedDialog=n.handleChannelBlockedDialog.bind((0,S.Z)(n)),n}return(0,n.Z)(a,[{key:"componentDidMount",value:function(){if(!this.props.preferencesData.contactInfoData){var e={},t="masked",a=this.props.configs["DASHBOARD.PREFERENCES.CONTACT_INFO.UNMASK_IN_SSO"],r=this.context.rc.session.isSessionSSO(),n=this.context.rc.session.isCobrowsingMode();r&&(a||n)&&(t="unmasked",e={"validation-text":this.props.session.userProfile.email}),this.props.fetchCommunicationPreferences(this.context.rc,this.props.session.userProfile.userId,t,e,r)}this.context.rc.analytics.trackEvent(u.FiA.PREFERENCE,{viewed:!0,shown:u.eSs.TABS.CONTACT_INFO},this.props)}},{key:"validateEmail",value:function(e){var t={"validation-text":e};this.props.fetchCommunicationPreferences(this.context.rc,this.props.session.userProfile.userId,"unmasked",t)}},{key:"componentDidUpdate",value:function(e){var t=this;this.props.preferencesData&&this.props.preferencesData.blockedPreferencesData&&e.preferencesData.blockedPreferencesData!==this.props.preferencesData.blockedPreferencesData&&this.props.preferencesData.blockedPreferencesData.map((function(e){e.channel===u.XHW.SMS.toUpperCase()&&e.blocked&&t.setState({showChannelBlockedAlert:e.blocked})}))}},{key:"render",value:function(){var e=this;return(0,m.jsx)(m.Fragment,{children:this.props.preferencesData.contactInfoData?(0,m.jsxs)(o.Fragment,{children:[(0,m.jsx)(Z,{preferencesData:this.props.preferencesData,validateEmail:function(t){return e.validateEmail(t)},setCommunicationPreferences:function(t,a){return e.props.setCommunicationPreferences(e.context.rc,e.props.session.userProfile.userId,t,a)},setEditableMode:function(t){return e.props.setEditableMode(t)},resetCommunicationPreferences:function(){return e.props.resetCommunicationPreferences()},translations:this.props.translationsData.data,showSmsDisclaimer:this.props.configs.showSmsDisclaimer,session:this.props.session,isSessionSSO:this.context.rc.session.isSessionSSO(),fuelType:this.props.session.userProfile.fuelType,premisesDetails:this.props.session.premisesDetails}),this.props.preferencesData.blockedPreferencesData&&(0,m.jsx)(U,{showChannelBlockedAlert:this.state.showChannelBlockedAlert,translations:this.props.translationsData.data,handleChannelBlockedDialog:function(){return e.handleChannelBlockedDialog()},alertDialogData:this.props.preferencesData.blockedPreferencesData})]}):(0,m.jsx)(G.Z,{className:"alert-loading"})})}}]),a}(o.Component);H.contextType=g.zO;var V=(0,f.EN)((0,c.$j)((function(e){return{session:e.session,preferencesData:e.preferencesData,translationsData:e.translationsData,queryParams:e.queryParams,configs:e.configs.data}}),(function(e){return{fetchCommunicationPreferences:function(t,a,r,n,s){return e(function(e,t,a,r){var n=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return function(s){e.apiClient.get("/v2.0/dashboard/users/"+t+"/communication/"+a,{params:r}).then((function(e){switch(a){case"masked":s({type:B.K3,payload:e.data});break;case"unmasked":var t=(0,R.Z)((0,R.Z)({},e.data),{},{isSSO:n});s({type:B.kr,payload:t})}}))}}(t,a,r,n,s))},setCommunicationPreferences:function(t,a,r,n){return e(function(e,t,a,r){var n={"apply-to-all-premises":r};return function(r){var s="/2.1/communication-preferences/users/"+t+"/homes/1";e.apiClient.post(s,a,{params:n}).then((function(e){e.error?r({type:B.SM}):(r({type:B.A_,payload:e.data}),r({type:B.j_}))}))}}(t,a,r,n))},setEditableMode:function(t){return e((0,B.$P)(t))},resetCommunicationPreferences:function(){return e((0,B.rL)())}}}))(H)),W=[u.XHW.EMAIL,u.XHW.SMS],z="PREFERENCE.TAB.ALERT_TYPE.OPTIONS",X=function(e){for(var t in e)if(void 0===e.key)return!1;return!0},q=function(e,t){var a=e.alertPreferenceList,r=[];return a.forEach((function(e){var a=e.eventName,n=[],s={email:t["PREFERENCE.EMAIL"],sms:t["PREFERENCE.TEXT"]};W.forEach((function(t){n.push({name:t,displayName:s[t],subscribed:e["".concat(t,"Subscribed")],eventName:a,show:function(){var a=!0;switch(t){case u.XHW.EMAIL:a=e.showEmailConfig;break;case u.XHW.SMS:a=e.showSMSConfig}return a}})})),r.push({eventName:a,name:t["".concat(z,".").concat(a,".HEADING")],description:t["".concat(z,".").concat(a,".DESCRIPTION")],metaData:X(e.metaData)?null:e.metaData,channels:n})})),r},$=function(e,t,a,r){var n={};a&&(n["measurement-type"]=(0,l.nY)(a));var s=e.toUpperCase().split("/"),i=u.oVm[s[s.length-1]],o=t.measurementToUserTypeMappings;return i&&(0,l.tk)(o,r)&&(n["measurement-type"]=(0,l.nY)(i)),n},J=function(e,t,a,r){var n=[],s={email:t["PREFERENCE.EMAIL"],sms:t["PREFERENCE.TEXT"],paper:t["PREFERENCE.MAIL"]};return e.forEach((function(e){var i=e.metaData&&e.metaData[u.cxB],o="".concat(z,".").concat(e.eventName),c=r?t["".concat(o,".").concat(a,".HEADING.SOLAR")]:t["".concat(o,".").concat(a,".HEADING")],l=r?t["".concat(o,".").concat(a,".DESCRIPTION.SOLAR")]:t["".concat(o,".").concat(a,".DESCRIPTION")],d=c||t["".concat(o,".HEADING")],p=l||t["".concat(o,".DESCRIPTION")];n.push({eventName:e.eventName,name:d,description:p,metaData:X(e.metaData)?null:{BUDGET_THRESHOLD_AMOUNT:isNaN(i)||!i?"":i,isInvalidInput:isNaN(i)||0===i},deliveryModes:[{name:u.XHW.EMAIL,displayName:s.email,show:e.showEmailConfig,subscribed:e.emailSubscribed},{name:u.XHW.SMS,displayName:s.sms,show:e.showSMSConfig,subscribed:e.smsSubscribed},{name:u.XHW.PAPER,displayName:s.paper,show:e.showPaperConfig,subscribed:e.paperSubscribed}]})})),n},Q=a(4942),K=a(29439),ee=a(26915),te=a(6306),ae=a(19536),re=a(23306),ne=a(42461),se=a(41727),ie=a(15480),oe=a(90575),ce=a(98492),le=a(41872),de=(0,ee.ZL)()((function(e,t){var a;return{root:{width:"100%",flex:"1 1 auto",marginTop:"1px"},heading:(0,Q.Z)({fontSize:e.typography.pxToRem(20),fontWeight:e.typography.fontWeightRegular,color:"rgb(".concat(t.configColors["--foreground_500"],")")},e.breakpoints.down("sm"),{fontSize:e.typography.pxToRem(17)}),accSummRoot:{background:"rgb(".concat(t.configColors["--background_300"],")")},alertContent:(0,Q.Z)({display:"flex",flexDirection:"row",justifyContent:"space-between",width:"100%"},e.breakpoints.down("sm"),{flexDirection:"column",alignItems:"flex-end"}),alertDescription:(0,Q.Z)({fontStyle:"normal",fontSize:"16px",lineHeight:"20px",color:"rgb(".concat(t.configColors["--foreground_500"],")"),textAlign:"left",paddingRight:"20px",marginBottom:"10px"},e.breakpoints.down("sm"),{fontSize:e.typography.pxToRem(16),paddingRight:0}),channelContainer:{display:"table",flexDirection:"column"},channelName:{fontSize:"16px",lineHeight:"20px",textAlign:"left",color:"rgb(".concat(t.configColors["--foreground_500"],")"),paddingRight:"25px",display:"block"},label:(a={},(0,Q.Z)(a,e.breakpoints.down("sm"),{marginBottom:"10px"}),(0,Q.Z)(a,"display","inline-block"),(0,Q.Z)(a,"lineHeight","35px"),(0,Q.Z)(a,"color","rgb(".concat(t.configColors["--foreground_500"],")")),a),labelPlacementStart:{marginLeft:10,marginRight:10,display:"flex",justifyContent:"space-between"},channelDetails:{display:"table",flexDirection:"row",justifyContent:"space-between",alignItems:"center",backgroundColor:"rgb(".concat(t.configColors["--background_400"],")"),padding:"10px",borderRadius:"10px",width:"135px"},channelCheckBox:{padding:"0px",color:"rgb(".concat(t.configColors["--primary_500"],")"),borderRadius:0,"&.Mui-disabled":{color:"rgb(".concat(t.configColors["--foreground_400"],")")}},checked:{color:"rgb(".concat(t.configColors["--primary_500"],")")},checkedColor:{"&.checked":{color:"rgb(".concat(t.configColors["--background_300"],")")}},divider:{paddingTop:"8px",paddingBottom:"8px"},overridesFontFamily:(0,Q.Z)({},e.breakpoints.down("sm"),{marginBottom:"10px"}),panelDetails:{flexDirection:"column",background:"rgb(".concat(t.configColors["--background_300"],")")},metaData:{display:"flex",flexDirection:"column",justifyContent:"flex-end",marginTop:30},inputWrapper:(0,Q.Z)({display:"flex",minHeight:"60px",justifyContent:"flex-end"},e.breakpoints.down("sm"),{flexDirection:"column",alignItems:"flex-end"}),innerInputWrapper:{display:"flex",flexDirection:"column"},input:(0,Q.Z)({border:"1px solid rgb(".concat(t.configColors["--background_400"],")"),borderRadius:"4px",marginLeft:15,paddingLeft:15,width:"300px",backgroundColor:"rgb(".concat(t.configColors["--background_400"],")"),color:"rgb(".concat(t.configColors["--foreground_500"],")")},e.breakpoints.down("sm"),{marginLeft:0}),expandIcon:{color:"rgb(".concat(t.configColors["--primary_500"],")")},metaDataFooter:{paddingTop:15,textAlign:"right"},metaDataFooterContent:(0,Q.Z)({color:"rgb(".concat(t.configColors["--foreground_500"],")"),fontSize:"0.8rem",width:"66%",float:"right"},e.breakpoints.down("sm"),{width:"100%"}),validationError:{color:"rgb(".concat(t.configColors["--bgl_red_500"],")"),width:"300px",paddingLeft:"15px"},inputDisabled:{cursor:"not-allowed"},focusVisible:{border:"1px solid rgb(".concat(t.configColors["--primary_500"],")")}}})),ue=o.forwardRef((function(e,t){var a=de(e).classes,r=e.alert,n=e.eventType,s=o.useState((function(){var t={eventName:r.eventName,error:!1,activeEvent:n||r.eventName};return r.channels.forEach((function(a){t[a.name]=a.subscribed,t["".concat(a.name,"Subscribed")]=e["".concat(a.name,"Subscribed")]})),t.budgetThresholdAmount=r.metaData&&r.metaData.BUDGET_THRESHOLD_AMOUNT?parseInt(r.metaData.BUDGET_THRESHOLD_AMOUNT):"",t})),i=(0,K.Z)(s,2),c=i[0],l=i[1];r.channels.forEach((function(a){var n,s;e["".concat(a.name,"Subscribed")]!==c["".concat(a.name,"Subscribed")]&&(t.current=(0,R.Z)((0,R.Z)({},c),{},(n={},(0,Q.Z)(n,"".concat(a.name),e["".concat(a.name,"Subscribed")]),(0,Q.Z)(n,"".concat(a.name,"Subscribed"),e["".concat(a.name,"Subscribed")]),n)),l((0,R.Z)((0,R.Z)({},c),{},(s={},(0,Q.Z)(s,"".concat(a.name),e["".concat(a.name,"Subscribed")]),(0,Q.Z)(s,"".concat(a.name,"Subscribed"),e["".concat(a.name,"Subscribed")]),(0,Q.Z)(s,"activeEvent",r.eventName),s))))}));var d,p=function(a){return function(n){var s,i,o=r.channels.some((function(e){return a===e.name?n.target.checked:c[e.name]}));l((0,R.Z)((0,R.Z)({},c),{},(s={},(0,Q.Z)(s,a,n.target.checked),(0,Q.Z)(s,"error",o&&!j(c.budgetThresholdAmount)),s))),t.current=(0,R.Z)((0,R.Z)({},c),{},(i={},(0,Q.Z)(i,a,n.target.checked),(0,Q.Z)(i,"error",o&&!j(c.budgetThresholdAmount)),i)),e.updateButtonState()}};return(0,m.jsx)("div",{className:a.root,id:c.eventName,children:(0,m.jsxs)(oe.Z,{defaultExpanded:!0,expanded:c.activeEvent===c.eventName,onChange:(d=c.eventName,function(e,t){l((0,R.Z)((0,R.Z)({},c),{},{activeEvent:!!t&&d}))}),children:[(0,m.jsx)(ce.Z,{expandIcon:(0,m.jsx)(te.Z,{}),"aria-controls":"panel1a-content",id:"panel1a-header",classes:{root:a.accSummRoot,expandIcon:a.expandIcon},"data-widget-name":u.wY4.SETTINGS_AND_PREFERENCES,"data-text-color":"primary_500",children:(0,m.jsx)(E.Z,{className:a.heading,"data-widget-name":u.wY4.SETTINGS_AND_PREFERENCES,"data-text-color":"foreground_500",children:r.name})}),(0,m.jsxs)(le.Z,{className:a.panelDetails,children:[(0,m.jsxs)("div",{className:a.alertContent,children:[(0,m.jsx)(E.Z,{className:a.alertDescription,"data-widget-name":u.wY4.SETTINGS_AND_PREFERENCES,"data-text-color":"foreground_400",children:r.description}),(0,m.jsx)("div",{className:a.channelContainer,"data-widget-name":u.wY4.SETTINGS_AND_PREFERENCES,"data-bg-color":"background_300",children:r.channels.map((function(t,n){return(0,m.jsxs)("div",{children:[t.show()?(0,m.jsx)("div",{className:a.channelDetails,children:(0,m.jsx)(F.Z,{label:t.displayName,labelPlacement:"start",classes:{label:a.channelName,labelPlacementStart:a.labelPlacementStart},disabled:!e["".concat(t.name,"Subscribed")],"data-widget-name":u.wY4.SETTINGS_AND_PREFERENCES,"data-text-color":"foreground_400",control:(0,m.jsx)(O.Z,{className:a.channelCheckBox,classes:{checked:a.checked},value:t.name,onChange:p(t.name),checked:c["".concat(t.name)],disableRipple:!0,color:"default","aria-label":c.eventName,focusVisibleClassName:a.focusVisible})})}):"",r.channels[n+1]&&r.channels[n+1].show()?(0,m.jsx)("div",{className:a.divider,children:(0,m.jsx)(ae.Z,{})}):""]},n)}))})]}),r.metaData&&r.eventName===u.xbb?(0,m.jsxs)("div",{className:a.metaData,children:[(0,m.jsxs)("div",{className:a.inputWrapper,"data-widget-name":u.wY4.SETTINGS_AND_PREFERENCES,"data-text-color":"background_400","data-bg-color":"primary_200",children:[(0,m.jsx)(re.Z,{"data-text-color":"foreground_500",htmlFor:"budget-threshold-amount",classes:{root:a.label},children:e.translations["PREFERENCE.MONTHLY_BUDGET_AMOUNT"]}),(0,m.jsxs)("div",{className:a.innerInputWrapper,children:[(0,m.jsx)(ne.Z,{id:"budget-threshold-amount",value:c.budgetThresholdAmount,onChange:function(a){return function(r){var n,s=r.target.value;s&&(s=s.trim()),l((0,R.Z)((0,R.Z)({},c),{},(n={},(0,Q.Z)(n,a,s),(0,Q.Z)(n,"error",!j(s)),n))),t.current=(0,R.Z)((0,R.Z)({},c),{},{metaData:(0,Q.Z)({},a,s),error:!j(s)}),e.updateButtonState()}}("budgetThresholdAmount"),startAdornment:(0,m.jsx)(se.Z,{position:"start",children:e.configs.data.electric_cost_unit}),disableUnderline:!0,className:a.input,classes:{root:a.overridesFontFamily,disabled:a.inputDisabled},autoComplete:"off",disabled:!r.channels.some((function(t){return e["".concat(t.name,"Subscribed")]}))||!(c.email||c.sms),"aria-describedby":"component-error-text",inputProps:{maxLength:5}}),r.channels.some((function(e){return c[e.name]}))&&c.error||e.isError?(0,m.jsx)(ie.Z,{id:"component-error-text",className:a.validationError,"data-widget-name":u.wY4.SETTINGS_AND_PREFERENCES,"data-text-color":"bgl_red_500",children:e.translations["PREFERENCE.ERROR.MONTHLY_BUDGET_AMOUNT"]}):""]})]}),(0,m.jsx)("div",{className:a.metaDataFooter,children:(0,m.jsx)(E.Z,{className:a.metaDataFooterContent,"data-widget-name":u.wY4.SETTINGS_AND_PREFERENCES,"data-color-text":"foreground_400",children:e.translations["PREFERENCE.MONTHLY_BUDGET_AMOUNT_DESCRIPTION"]})})]}):""]})]})})}));ue.displayName="BCLSimpleExpansionPanel";var pe=ue,Ee=a(17592),fe=a(70024),ge=(0,ee.ZL)()((function(e,t){return{root:{width:"100%"},heading:(0,Q.Z)({fontSize:e.typography.pxToRem(20),fontWeight:e.typography.fontWeightRegular,color:"rgb(".concat(t.configColors["--foreground_500"],")")},e.breakpoints.down("sm"),{fontSize:e.typography.pxToRem(17)}),mainPanelDetails:{display:"flex",flexDirection:"column",background:"rgb(".concat(t.configColors["--background_300"],")")},alertContent:{display:"flex",flexDirection:"row",justifyContent:"space-between",width:"100%",marginBottom:"16px"},alertDescription:(0,Q.Z)({fontStyle:"normal",fontSize:"18px",lineHeight:"22px",color:"rgb(".concat(t.configColors["--foreground_500"],")"),textAlign:"left"},e.breakpoints.down("sm"),{fontSize:e.typography.pxToRem(16)}),accSummRoot:{background:"rgb(".concat(t.configColors["--background_300"],")")},expandIcon:{color:"rgb(".concat(t.configColors["--primary_500"],")")},focusVisible:{borderTop:"1px solid rgb(".concat(t.configColors["--primary_500"],")"),borderRadius:"0"}}})),me=(0,Ee.ZP)(fe.Z)((function(e){e.theme;return{"& .MuiSwitch-switchBase":{color:"rgba(var(--foreground_300), 1)",padding:"9px !important","&.Mui-checked":{color:"rgba(var(--foreground_300), 1)","& + .MuiSwitch-track":{backgroundColor:"rgba(var(--primary_500), 1)",opacity:1}}},checked:{},track:{}}})),he=function(e){var t=o.useState(!1),a=(0,K.Z)(t,2),r=a[0],n=a[1],s=ge(e).classes,i=function(t){return function(a){n(!0),e.updateNotificationPreferences(t,a.target.checked)}};return(0,m.jsx)("div",{className:s.root,children:(0,m.jsxs)(oe.Z,{defaultExpanded:!0,children:[(0,m.jsx)(ce.Z,{expandIcon:(0,m.jsx)(te.Z,{}),"aria-controls":"panel1a-content",id:"panel1a-header",classes:{root:s.accSummRoot,expandIcon:s.expandIcon},"data-widget-name":u.wY4.SETTINGS_AND_PREFERENCES,"data-text-color":"primary_500","data-focus-element":!(r||!(0,l.IR)())&&(0,l.IR)(),children:(0,m.jsx)(E.Z,{className:s.heading,"data-widget-name":u.wY4.SETTINGS_AND_PREFERENCES,"data-text-color":"foreground_500",children:e.translations["PREFERENCE.NOTIFICATION_RECEIVE_TYPE.HEADING"]})}),(0,m.jsxs)(le.Z,{className:s.mainPanelDetails,children:[e.showEmailConfig?(0,m.jsxs)("div",{className:s.alertContent,children:[(0,m.jsx)(E.Z,{className:s.alertDescription,"data-widget-name":u.wY4.SETTINGS_AND_PREFERENCES,"data-text-color":"foreground_400",children:e.translations["PREFERENCE.NOTIFICATION_RECEIVE_TYPE.EMAIL"]}),(0,m.jsx)(F.Z,{control:(0,m.jsx)(me,{checked:e.emailSubscribed,onChange:i("email"),color:"default","data-widget-name":u.wY4.SETTINGS_AND_PREFERENCES,"data-bg-color":"primary_500","data-text-color":"foreground_300",focusVisibleClassName:s.focusVisible,inputProps:{"aria-label":e.translations["DASHBOARD.LABEL.RECIEVE_EMAIL"],"aria-checked":e.emailSubscribed,role:"checkbox"}})})]}):"",e.showSMSConfig?(0,m.jsxs)("div",{className:s.alertContent,children:[(0,m.jsx)(E.Z,{className:s.alertDescription,"data-widget-name":u.wY4.SETTINGS_AND_PREFERENCES,"data-text-color":"foreground_400",children:(0,m.jsx)("span",{dangerouslySetInnerHTML:{__html:e.translations["PREFERENCE.NOTIFICATION_RECEIVE_TYPE.TEXT"]}})}),(0,m.jsx)(F.Z,{control:(0,m.jsx)(me,{role:"checkbox","aria-label":e.translations["DASHBOARD.LABEL.RECIEVE_SMS"],"aria-checked":e.smsSubscribed,checked:e.smsSubscribed,onChange:i("sms"),"data-widget-name":u.wY4.SETTINGS_AND_PREFERENCES,"data-bg-color":"primary_500","data-text-color":"foreground_300",focusVisibleClassName:s.focusVisible})})]}):""]})]})})};function be(e){var t=w()("submit-btn",{disabled:e.isSaving||e.isPristine||e.isError});return(0,m.jsxs)(P.Z,{className:"save-panel",children:[(0,m.jsx)("div",{className:"description",dangerouslySetInnerHTML:{__html:function(){var t=e.translations["PREFERENCE.TABS.ALERT_TYPE.AGREEMENT"],a=[{key:"{linkUrl}",value:e.configs.data?e.configs.data["privacyLink_"+(0,l.Xu)()]:"#"},{key:"{className}",value:"link"},{key:"{tosLinkUrl}",value:e.configs.data?e.configs.data["termsLink_"+(0,l.Xu)()]:"#"}];return t=(0,l.$j)(t,a)}()},"data-widget-name":u.wY4.SETTINGS_AND_PREFERENCES,"data-text-color":"foreground_500","data-link-color":"primary_500"}),(0,m.jsxs)("div",{className:"btn-container","data-widget-name":u.wY4.SETTINGS_AND_PREFERENCES,"data-bg-color":"primary_500","data-text-color":"foreground_300",children:[(0,m.jsx)("button",{type:"submit",className:t,onClick:function(){return e.updateAlertPreferences()},disabled:e.isSaving||e.isPristine||e.isError,children:e.isSaving?e.translations["PREFERENCE.BUTTONS.SAVING"]:e.translations["PREFERENCE.BUTTONS.SAVE_CHANGES"]}),(0,m.jsxs)("div",{className:"message-wrapper",children:[e.setAlertTypesFailed?(0,m.jsx)("span",{role:"alert","aria-live":"assertive",className:"error-text",dangerouslySetInnerHTML:{__html:e.translations["PREFERENCE.SOMETHING_WENT_WRONG"]},"data-widget-name":u.wY4.SETTINGS_AND_PREFERENCES,"data-text-color":"bgl_red_500"}):"",e.setAlertTypesSuccess?(0,m.jsx)("span",{role:"alert","aria-live":"assertive",className:"success-text",dangerouslySetInnerHTML:{__html:e.translations["PREFERENCE.TAB.ALERT_TYPE.SAVE_SUCCESS"]},"data-widget-name":u.wY4.SETTINGS_AND_PREFERENCES,"data-text-color":"bgl_green_400"}):""]})]})]})}var Se=a(88291),Ne=(0,ee.ZL)()((function(e,t){return{root:{width:"100%",padding:"20px 30px"},container:{width:"100%",padding:0},deliveryModeContainer:{width:"100%",padding:0,display:"flex",alignItems:"center",justifyContent:"space-between","&:nth-of-type(1)":{marginTop:"10px"}},heading:{fontSize:"14px",fontWeight:"700",color:"rgb(".concat(t.configColors["--foreground_500"],")"),textTransform:"uppercase"},deliveryModeName:{fontStyle:"normal",fontSize:"16px",fontWeight:"600",lineHeight:"20px",margin:"9px 0",color:"rgb(".concat(t.configColors["--foreground_500"],")")},label:{fontWeight:400,fontSize:"16px",color:"rgb(".concat(t.configColors["--foreground_400"],")"),paddingRight:5}}}));function Te(e){var t=Ne(e).classes,a=u.wY4.SETTINGS_AND_PREFERENCES,r=(0,Ee.ZP)(fe.Z)((function(t){t.theme;return{"& .MuiSwitch-switchBase":{color:"rgb(".concat(e.configColors["--foreground_300"],")"),padding:"9px !important","&.Mui-checked":{color:"rgb(".concat(e.configColors["--foreground_300"],")"),"& + .MuiSwitch-track":{backgroundColor:"".concat(((0,l.wG)(),"rgb(".concat(e.configColors["--primary_500"],")"))),opacity:1}}},checked:{},track:{}}})),n=[];return e.showEmailConfig&&n.push({subscribed:e.emailSubscribed,name:u.XHW.EMAIL,translationId:"EMAIL"}),e.showSMSConfig&&n.push({subscribed:e.smsSubscribed,name:u.XHW.SMS,translationId:"TEXT"}),e.showPaperConfig&&e.paperAllowedForRole&&n.push({subscribed:e.paperSubscribed,name:u.XHW.PAPER,translationId:"PAPER"}),(0,m.jsxs)(T.Z,{maxWidth:!1,disableGutters:!0,classes:{root:t.root},children:[(0,m.jsx)(E.Z,{className:t.heading,"data-widget-name":a,"data-text-color":"foreground_500",children:e.translations["PREFERENCE.NOTIFICATION_RECEIVE_TYPE.HEADING"]}),(0,m.jsx)(T.Z,{disableGutters:!0,classes:{root:t.container},children:n.map((function(n){return(0,m.jsxs)(T.Z,{disableGutters:!0,classes:{root:t.deliveryModeContainer},children:[(0,m.jsx)(E.Z,{className:t.deliveryModeName,"data-widget-name":a,"data-text-color":"foreground_400",children:(0,m.jsx)("span",{dangerouslySetInnerHTML:{__html:e.translations["PREFERENCE.NOTIFICATION_RECEIVE_TYPE.".concat(n.translationId)]}})}),(0,m.jsx)(F.Z,{label:n.subscribed?e.translations.ON:e.translations.OFF,labelPlacement:"start",classes:{label:t.label},control:(0,m.jsx)(r,{checked:n.subscribed,onChange:(s=n.name,function(t){e.updateDeliveryModes(s,t.target.checked)}),"data-widget-name":a,"data-bg-color":"primary_500","data-text-color":"foreground_300",configColors:e.configColors})})]},n.name);var s}))})]})}var xe=a(24193),ve=(0,ee.ZL)()((function(e,t){return{container:{padding:"20px 35px 30px",textAlign:"center"},description:{lineHeight:"20px",textAlign:"center",marginBottom:"16px",fontSize:"12px",color:"rgb(".concat(t.configColors["--foreground_500"],")"),"& .link":{color:"rgb(".concat(t.configColors["--primary_500"],")"),fontWeight:"500",textDecoration:"underline"}},btnContainer:{display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column"},submitButton:{width:"200px",height:"48px",background:"".concat(((0,l.wG)(),"rgb(".concat(t.configColors["--primary_500"],")"))),borderRadius:"4px",lineHeight:"20px",alignItems:"center",textAlign:"center",cursor:"pointer",fontSize:"16px",textTransform:"none",color:"rgb(".concat(t.configColors["--foreground_300"],")"),"&:hover":{background:"".concat(((0,l.wG)(),"rgb(".concat(t.configColors["--primary_500"],")"))),color:"rgb(".concat(t.configColors["--foreground_300"],")")},"&:disabled":{color:"rgb(".concat(t.configColors["--foreground_300"],")"),cursor:"not-allowed",textTransform:"none",background:"".concat((0,l.wG)()?"rgb(".concat(t.configColors["--primary_500"],", .6)"):"rgba(".concat(t.configColors["--primary_500"],", .6)"))}},disabledButton:{opacity:.6,textTransform:"none",color:"rgb(".concat(t.configColors["--foreground_300"],")"),cursor:"not-allowed"},messageWrapper:{margin:"10px 0",minHeight:"20px"},errorText:{color:"rgb(".concat(t.configColors["--bgl_red_500"],")")},successText:{color:"".concat((0,l.wG)()?"rgb(".concat(t.configColors["--bgl_green_500"],")"):"rgb(".concat(t.configColors["--bgl_green_400"],")"))},premisesBtn:{color:"rgb(".concat(t.configColors["--foreground_500"],")"),fontSize:"16px"},premisesCheckBoxBtn:{color:"rgb(".concat(t.configColors["--primary_500"],")")}}}));function ye(e){var t=ve(e).classes,a=u.wY4.SETTINGS_AND_PREFERENCES;return(0,m.jsxs)(T.Z,{disableGutters:!0,classes:{root:t.container},children:[(0,m.jsx)(T.Z,{classes:{root:t.description},dangerouslySetInnerHTML:{__html:function(){var t=e.translations["PREFERENCE.TABS.ALERT_TYPE.AGREEMENT"],a=[{key:"{linkUrl}",value:e.configs?e.configs["privacyLink_"+(0,l.Xu)()]:"#"},{key:"{className}",value:"link"},{key:"{tosLinkUrl}",value:e.configs?e.configs["termsLink_"+(0,l.Xu)()]:"#"}];return t=(0,l.$j)(t,a)}()},"data-widget-name":a,"data-text-color":"foreground_400","data-link-color":"primary_500"}),(0,m.jsxs)(T.Z,{disableGutters:!0,classes:{root:t.btnContainer},"data-widget-name":a,"data-bg-color":"primary_500","data-text-color":"foreground_300",children:[e.premisesDetails&&e.premisesDetails.premises&&e.premisesDetails.premises.length>1&&(0,m.jsx)(F.Z,{className:t.premisesBtn,label:e.translations["PREFERENCE.PREMISES_BUTTON_TEXT"],labelPlacement:"end",disabled:e.isButtonDisabled,"data-widget-name":u.wY4.SETTINGS_AND_PREFERENCES,"data-text-color":"foreground_400",control:(0,m.jsx)(O.Z,{value:e.translations["PREFERENCE.PREMISES_BUTTON_TEXT"],classes:{checked:t.premisesCheckBoxBtn},onChange:function(){return e.handleClick()},checked:e.applyToAllPremises&&!e.isButtonDisabled,disableRipple:!0,color:"default",inputProps:{"aria-label":e.translations["PREFERENCE.PREMISES_BUTTON_ALERT_ADA_TEXT"]}})}),(0,m.jsx)(xe.Z,{type:"submit",classes:{root:t.submitButton,disabled:t.disabledButton},onClick:function(){return e.updateAlertPreferences()},disabled:e.isButtonDisabled,children:e.isSaving?e.translations["PREFERENCE.BUTTONS.SAVING"]:e.translations["PREFERENCE.BUTTONS.SAVE_CHANGES"]}),(e.setAlertTypesFailed||e.setAlertTypesSuccess)&&(0,m.jsxs)(T.Z,{disableGutters:!0,classes:{root:t.messageWrapper},children:[e.setAlertTypesFailed?(0,m.jsx)(E.Z,{classes:{root:t.errorText},dangerouslySetInnerHTML:{__html:e.translations["PREFERENCE.SOMETHING_WENT_WRONG"]},"data-widget-name":a,"data-text-color":"bgl_red_500"}):"",e.setAlertTypesSuccess?(0,m.jsx)(E.Z,{classes:{root:t.successText},dangerouslySetInnerHTML:{__html:e.translations["PREFERENCE.TAB.ALERT_TYPE.SAVE_SUCCESS"]},"data-widget-name":a,"data-text-color":"bgl_green_400"}):""]})]})]})}var Ce=(0,ee.ZL)()((function(e,t){var a;return{root:{width:"100%",padding:0,boxShadow:"none","&.Mui-expanded":{margin:0,boxShadow:"none","&:before":{backgroundColor:"rgba(".concat(t.configColors["--background_700"],", .12)"),opacity:1}},"&.Mui-disabled":{backgroundColor:"rgb(".concat(t.configColors["--background_300"],")")}},expanded:{},disabled:{backgroundColor:"rgb(".concat(t.configColors["--background_300"],")")},alertOuterContainer:{paddingTop:0,paddingBottom:0},expansionPanelSummaryContent:{marginTop:"26px",marginBottom:"20px",display:"flex",alignItems:"center","&$summaryExpanded":{marginTop:"26px",marginBottom:"20px"},"& .icon":{color:"rgb(".concat(t.configColors["--primary_500"],")"),fontSize:"25px",marginRight:"10px",border:"1px solid",borderRadius:"50%",display:"flex",height:"35px",width:"35px",justifyContent:"center",alignItems:"center",padding:0}},summaryExpanded:{},summaryDisabled:{display:"none"},alertContainer:{width:"100%",padding:"16px 0",display:"flex",borderBottom:"1px solid rgb(".concat(t.configColors["--background_500"],")"),flexWrap:"wrap"},alertLeftContainer:(0,Q.Z)({padding:0,flex:1,marginRight:"10px"},e.breakpoints.down(600),{minWidth:"fit-content",marginBottom:"5px"}),alertRightContainer:{padding:"0 10px",flexBasis:"135px",display:"flex",flexDirection:"column",backgroundColor:"rgb(".concat(t.configColors["--background_300"],")"),borderRadius:"10px",marginRight:"0"},heading:{fontSize:"16px",fontWeight:"500",lineHeight:"20px",color:"rgb(".concat(t.configColors["--foreground_500"],")")},alertDescription:{fontSize:"14px",lineHeight:"20px",color:"rgb(".concat(t.configColors["--foreground_500"],")"),margin:"8px 0 0"},channelDetails:{display:"table",flexDirection:"row",justifyContent:"space-between",alignItems:"center",padding:"8px 0",backgroundColor:"rgb(".concat(t.configColors["--background_400"],")"),borderRadius:"10px",borderTop:"1px solid rgba(".concat(t.configColors["--background_700"],", .12)"),"&:nth-of-type(1)":{borderTop:"0"}},channelName:{fontSize:"16px",lineHeight:"20px",textAlign:"left",color:"rgb(".concat(t.configColors["--foreground_500"],")"),paddingRight:"25px",display:"block",width:"75px"},labelPlacementStart:{marginLeft:10,marginRight:10},channelCheckBox:{padding:"0px",color:"rgb(".concat(t.configColors["--primary_500"],")"),borderRadius:0,"&.Mui-disabled":{color:"rgb(".concat(t.configColors["--foreground_400"],")")}},checked:{color:"".concat(((0,l.wG)(),"rgb(".concat(t.configColors["--primary_500"],")")))},metaDataContainer:{display:"flex",flexDirection:"column",justifyContent:"flex-end",marginTop:30,padding:0},inputWrapper:(0,Q.Z)({display:"flex",padding:0,justifyContent:"flex-end"},e.breakpoints.down("sm"),{flexDirection:"column",alignItems:"flex-end"}),innerInputWrapper:{display:"flex",flexDirection:"column",padding:0,flex:0},label:(a={},(0,Q.Z)(a,e.breakpoints.down("sm"),{marginBottom:"10px"}),(0,Q.Z)(a,"display","inline-block"),(0,Q.Z)(a,"lineHeight","35px"),(0,Q.Z)(a,"flex",1),(0,Q.Z)(a,"textAlign","right"),(0,Q.Z)(a,"color","".concat((0,l.wG)()?"rgb(".concat(t.configColors["--primary_500"],")"):"rgb(".concat(t.configColors["--foreground_500"],")"))),a),input:(0,Q.Z)({border:"1px solid rgb(".concat(t.configColors["--background_400"],")"),borderRadius:"4px",marginLeft:15,paddingLeft:15,width:"300px",backgroundColor:"rgb(".concat(t.configColors["--primary_200"],")")},e.breakpoints.down("sm"),{marginLeft:0}),inputDisabled:{cursor:"not-allowed"},validationError:{color:"rgb(".concat(t.configColors["--bgl_red_500"],")"),width:"300px",paddingLeft:"15px"},metaDataFooter:{display:"flex",justifyContent:"flex-end",textAlign:"right",padding:"15px 0 0",flexBasis:"100%"},metaDataFooterContent:(0,Q.Z)({color:"".concat((0,l.wG)()?"rgb(".concat(t.configColors["--primary_500"],")"):"rgb(".concat(t.configColors["--foreground_400"],")")),fontSize:"0.8rem",padding:0,width:"66%"},e.breakpoints.down("sm"),{width:"100%"}),measurementTypeName:{fontSize:"22px",color:"rgb(".concat(t.configColors["--foreground_400"],")"),fontWeight:600,lineHeight:"27px"},expandIcon:{color:"rgb(".concat(t.configColors["--primary_500"],")"),fontSize:"2.5rem"}}}));function Re(e){var t=Ce(e).classes,a=u.oVm[e.measurementType],r=u.wY4.SETTINGS_AND_PREFERENCES,n=e.allMeasurementTypes&&e.allMeasurementTypes.length,s=e.userAlertPreferences.find((function(e){return e.eventName===u.xbb})),i=s&&s.deliveryModes.find((function(e){return e.name===u.XHW.EMAIL})),c=s&&e.emailSubscribed&&i.show&&i.subscribed,l=s&&s.deliveryModes.find((function(e){return e.name===u.XHW.SMS})),d=s&&e.smsSubscribed&&l.show&&l.subscribed,p=function(t){var a=t.deliveryModes.filter((function(e){return e.show})),r=!0;return 1===a.length&&a[0].name===u.XHW.PAPER&&(r=e.paperAllowedForRole),r};return(0,m.jsxs)(oe.Z,{classes:{root:t.root,expanded:t.expanded,disabled:t.disabled},defaultExpanded:!0,disabled:!a||1===n,children:[(0,m.jsx)(ce.Z,{expandIcon:(0,m.jsx)(te.Z,{classes:{root:t.expandIcon}}),classes:{content:t.expansionPanelSummaryContent,expanded:t.summaryExpanded,disabled:t.summaryDisabled},children:a&&n>1&&(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("span",{className:"icon bidgely-icon-".concat(a)}),(0,m.jsx)(E.Z,{className:t.measurementTypeName,"data-widget-name":r,"data-text-color":"foreground_400",children:e.translations["PREFERENCE.TAB.ALERT_TYPE_".concat(e.measurementType)]})]})}),e.userAlertPreferences.map((function(a,n){var s=a.deliveryModes&&a.deliveryModes.filter((function(e){return e&&!0===e.show})).length,i=s&&40*s;return(0,m.jsx)(le.Z,{classes:{root:t.alertOuterContainer},children:p(a)?(0,m.jsxs)(T.Z,{disableGutters:!0,classes:{root:t.alertContainer},children:[(0,m.jsxs)(T.Z,{disableGutters:!0,classes:{root:t.alertLeftContainer},children:[(0,m.jsx)(E.Z,{className:t.heading,"data-widget-name":r,"data-text-color":"foreground_400",children:a.name}),(0,m.jsx)(E.Z,{className:t.alertDescription,"data-widget-name":r,"data-text-color":"foreground_400",children:a.description})]}),(0,m.jsx)(T.Z,{disableGutters:!0,classes:{root:t.alertRightContainer},style:{maxHeight:"".concat(i,"px")},children:a.deliveryModes.map((function(n,s){return(0,m.jsx)(o.Fragment,{children:(n.name===u.XHW.PAPER&&e.paperAllowedForRole||n.name!==u.XHW.PAPER)&&n.show?(0,m.jsx)(T.Z,{disableGutters:!0,classes:{root:t.channelDetails},children:(0,m.jsx)(F.Z,{label:n.displayName,labelPlacement:"start",classes:{label:t.channelName,labelPlacementStart:t.labelPlacementStart},disabled:!e["".concat(n.name,"Subscribed")],"data-widget-name":r,"data-text-color":"foreground_400",control:(0,m.jsx)(O.Z,{className:t.channelCheckBox,classes:{checked:t.checked},value:n.name,onChange:function(t){return e.updateEventDeliveryModes(t,a.eventName,n.name,e.measurementType)},checked:e["".concat(n.name,"Subscribed")]&&n.subscribed,disableRipple:!0,color:"default"})})}):""},s)}))}),a.metaData&&a.eventName===u.xbb&&(0,m.jsxs)(T.Z,{disableGutters:!0,classes:{root:t.metaDataContainer},children:[(0,m.jsxs)(T.Z,{disableGutters:!0,classes:{root:t.inputWrapper},"data-widget-name":r,"data-text-color":"background_400","data-bg-color":"primary_200",children:[(0,m.jsx)(re.Z,{"data-text-color":"foreground_500",htmlFor:"budget-threshold-amount",classes:{root:t.label},children:e.translations["PREFERENCE.MONTHLY_BUDGET_AMOUNT"]}),(0,m.jsxs)(T.Z,{disableGutters:!0,classes:{root:t.innerInputWrapper},children:[(0,m.jsx)(ne.Z,{id:"budget-threshold-amount",value:e.budgetThreshold,onChange:function(t){return e.changeBudgetThreshold(t,e.measurementType)},startAdornment:(0,m.jsx)(se.Z,{position:"start",children:e.configs.electric_cost_unit}),disableUnderline:!0,classes:{root:t.input,disabled:t.inputDisabled},autoComplete:"off",disabled:!(c||d),"aria-describedby":"component-error-text"}),(c||d)&&(0,m.jsx)(ie.Z,{id:"component-error-text",className:t.validationError,"data-widget-name":r,"data-text-color":"bgl_red_500",children:a.metaData.isInvalidInput?e.translations["PREFERENCE.ERROR.MONTHLY_BUDGET_AMOUNT"]:e.budgetError?e.translations["PREFERENCE.ERROR.MONTHLY_BUDGET_AMOUNT_RANGE"]:""})]})]}),(0,m.jsx)(T.Z,{disableGutters:!0,classes:{root:t.metaDataFooter},children:(0,m.jsx)(E.Z,{className:t.metaDataFooterContent,"data-widget-name":r,"data-color-text":"foreground_400",children:e.translations["PREFERENCE.MONTHLY_BUDGET_AMOUNT_DESCRIPTION"]})})]})]},n):""},n)}))]})}var _e=function(e){(0,s.Z)(a,e);var t=(0,i.Z)(a);function a(e){var n;return(0,r.Z)(this,a),(n=t.call(this,e)).state={emailSubscribed:!1,showEmailConfig:!1,smsSubscribed:!1,showSMSConfig:!1,paperSubscribed:!1,showPaperConfig:!1,alertsMap:{},updatedAlertsMap:{},isButtonDisabled:!0,isBudgetAmountInvalid:!1,applyToAllPremises:!1},n}return(0,n.Z)(a,[{key:"componentDidMount",value:function(){this.context.rc.analytics.trackEvent(u.FiA.PREFERENCE,{viewed:!0,shown:u.eSs.TABS.ALERT_TYPE,version:u.G_n.V2},this.props),this.fetchAlertType()}},{key:"componentWillUnmount",value:function(){this.props.resetAlertPreferences()}},{key:"componentDidUpdate",value:function(e,t){var a=this,r=this.props,n=r.preferencesData,s=n.alertPreferencesMap,i=n.savingAlertTypes,o=r.translations,d=this.context.rc.session.isSolarUser();if(!(0,c.wU)(s,e.preferencesData.alertPreferencesMap)){var p=Object.keys(s);this.setState({emailSubscribed:s[p[0]].emailSubscribed,showEmailConfig:s[p[0]].showEmailConfig,smsSubscribed:s[p[0]].smsSubscribed,showSMSConfig:s[p[0]].showSMSConfig,paperSubscribed:s[p[0]].paperSubscribed,showPaperConfig:s[p[0]].showPaperConfig});for(var E=0;E<p.length;E++)if(!this.state.alertsMap[p[E]]){var f=p[E]===u.DKx?this.props.session.userProfile.fuelType.toUpperCase():p[E],g=J(s[p[E]].alertPreferenceList,o,f,d),m=null===g||void 0===g?void 0:g.find((function(e){return e.eventName===u.xbb}));this.setState({alertsMap:(0,R.Z)((0,R.Z)({},this.state.alertsMap),{},(0,Q.Z)({},p[E],g)),updatedAlertsMap:(0,R.Z)((0,R.Z)({},this.state.updatedAlertsMap),{},(0,Q.Z)({},p[E],[])),budgetThreshold:m&&m.metaData?Math.round(m.metaData[u.cxB]):0,budgetError:!1})}}if(this.state.isBudgetAmountInvalid!==t.isBudgetAmountInvalid&&this.setState({isButtonDisabled:this.isSaveButtonToBeDisabled()}),this.state.smsSubscribed!==t.smsSubscribed||this.state.emailSubscribed!==t.emailSubscribed||this.state.paperSubscribed!==t.paperSubscribed){for(var h=Object.keys(s),b=0;b<h.length;b++){var S=this.state.alertsMap[h[b]],N=S&&S.find((function(e){return e.eventName===u.xbb}));if(N)for(var T=Object.keys(N.deliveryModes),x=0;x<T.length;x++){var v=N.deliveryModes[T[x]];if(this.state["".concat(v.name,"Subscribed")]&&v&&v.subscribed&&N.metaData.isInvalidInput)return v.name===u.XHW.EMAIL&&this.state.emailSubscribed||v.name===u.XHW.SMS&&this.state.smsSubscribed?void this.setState({isBudgetAmountInvalid:!0}):void this.setState({isBudgetAmountInvalid:!1});this.setState({isBudgetAmountInvalid:!1})}}this.setState({isButtonDisabled:this.isSaveButtonToBeDisabled()})}for(var y=Object.keys(this.state.updatedAlertsMap),C=0;C<y.length;C++)t.updatedAlertsMap[y[C]]&&this.state.updatedAlertsMap[y[C]].length!==t.updatedAlertsMap[y[C]].length&&this.setState({isButtonDisabled:this.isSaveButtonToBeDisabled()});if(!i&&e.preferencesData.savingAlertTypes){var _=!1,A=(0,l.kI)(s),P=Object.keys(A);P.forEach((function(e){(A[e].emailSubscribed&&!a.state.emailSubscribed||A[e].smsSubscribed&&!a.state.smsSubscribed)&&(_=!0),A[e].emailSubscribed=a.state.emailSubscribed,A[e].smsSubscribed=a.state.smsSubscribed,A[e].paperSubscribed=a.state.paperSubscribed,(0,l.kI)(a.state.updatedAlertsMap)[e].forEach((function(t){var a=A[e].alertPreferenceList.find((function(e){return e.eventName===t.eventName}));(a.emailSubscribed&&!t.emailSubscribed||a.smsSubscribed&&!t.smsSubscribed)&&(_=!0),a.emailSubscribed=t.emailSubscribed,a.smsSubscribed=t.smsSubscribed,a.paperSubscribed=t.paperSubscribed,a.metaData=(0,l.kI)(t.metaData)}))})),this.props.setAlertPreferencesMap(A);var I=(0,l.kI)(this.state.updatedAlertsMap);(P=Object.keys(A)).forEach((function(e){I[e]=[]})),this.setState({updatedAlertsMap:I}),this.props.configs["DASHBOARD.PREFERENCES.UNSUBSCRIBE_SURVEY_ENABLED"]&&_&&this.goToFeedback()}}},{key:"fetchAlertType",value:function(){for(var e=this.props.session.userTypeDetails.measurementToUserTypeMappings,t=0;t<e.length;t++)this.props.fetchAlertPreferences(this.context.rc,this.props.session.userProfile.userId,e[t].measurementType)}},{key:"updateDeliveryModes",value:function(e,t){this.props.resetAlertPreferences(),this.state.isSaving||(this.setState((0,Q.Z)({},"".concat(e,"Subscribed"),t)),this.context.rc.analytics.trackEvent(u.FiA.PREFERENCE,{shown:u.eSs.TABS.ALERT_TYPE,clicked:e,subscribe:t,widget:u.wY4.SETTINGS_AND_PREFERENCES,version:u.G_n.V2}))}},{key:"isSaveButtonToBeDisabled",value:function(){var e=this.props.preferencesData.alertPreferencesMap,t=Object.keys(e);if(this.state.isBudgetAmountInvalid)return!0;for(var a=this.context.rc.session.getUserRole(),r=-1!==JSON.parse(this.props.configs["PREFERENCE.PAPER.ALLOWED_ROLES"]).indexOf(a),n=[],s=0;s<t.length;s++)for(var i=(0,l.kI)(this.state.alertsMap[t[s]])||[],o=0;o<i.length;o++){var c=i[o].deliveryModes.filter((function(e){return e.show&&e.subscribed}));c&&c.length&&(c[0].name!==u.XHW.PAPER||r)&&(n=n.concat(c))}if((this.state.emailSubscribed||this.state.smsSubscribed||r&&this.state.paperSubscribed)&&!n.length)return!0;if(this.state.emailSubscribed!==e[t[0]].emailSubscribed||this.state.smsSubscribed!==e[t[0]].smsSubscribed||this.state.paperSubscribed!==e[t[0]].paperSubscribed)return!1;for(var d=0;d<t.length;d++)if(this.state.updatedAlertsMap&&this.state.updatedAlertsMap[t[d]]&&this.state.updatedAlertsMap[t[d]].length>0)return!1;return!0}},{key:"updateEventDeliveryModes",value:function(e,t,a,r){if(this.props.resetAlertPreferences(),!this.state.isSaving){var n=(0,l.kI)(this.state.alertsMap[r]),s=n.find((function(e){return e.eventName===t}));s.deliveryModes.find((function(e){return e.name===a})).subscribed=e.target.checked,this.setState({alertsMap:(0,R.Z)((0,R.Z)({},this.state.alertsMap),{},(0,Q.Z)({},r,n)),updatedAlertsMap:this.getModifiedUpdatedAlertMap(s,t,r)})}}},{key:"changeBudgetThreshold",value:function(e,t){var a=e.target.value;if(!this.state.isSaving&&(/^[\d,]*$/.test(a)||""===a)){var r=parseFloat(a),n=(0,l.kI)(this.state.alertsMap)[t],s=n.find((function(e){return e.eventName===u.xbb})),i=r<=10||r>=1e3;s.metaData[u.cxB]=a,s.metaData.isInvalidInput=isNaN(r)||r<=0,this.setState({alertsMap:(0,R.Z)((0,R.Z)({},this.state.alertsMap),{},(0,Q.Z)({},t,n)),updatedAlertsMap:this.getModifiedUpdatedAlertMap(s,u.xbb,t,a),budgetThreshold:a,budgetError:i})}}},{key:"getModifiedUpdatedAlertMap",value:function(e,t,a,r){var n=(0,l.kI)(this.state.updatedAlertsMap),s=e.deliveryModes.find((function(e){return e.name===u.XHW.EMAIL})).subscribed&&this.state.emailSubscribed,i=e.deliveryModes.find((function(e){return e.name===u.XHW.SMS})).subscribed&&this.state.smsSubscribed,o=e.deliveryModes.find((function(e){return e.name===u.XHW.PAPER})).subscribed&&this.state.paperSubscribed,c={eventName:t,emailSubscribed:s,smsSubscribed:i,paperSubscribed:o,alertSubscribed:s||i||o,metaData:{}};if(t===u.xbb){c.metaData[u.cxB]=r||e.metaData[u.cxB];var d=(this.state.emailSubscribed&&e.deliveryModes[0].subscribed||this.state.smsSubscribed&&e.deliveryModes[1].subscribed)&&e.metaData.isInvalidInput;this.setState({isBudgetAmountInvalid:d})}var p=(0,l.kI)(this.props.preferencesData.alertPreferencesMap)[a].alertPreferenceList.find((function(e){return e.eventName===t})),E=this.isEqualToOriginalAlertPref(c,p),f=n[a].findIndex((function(e){return e.eventName===t}));return n[a].splice(f,-1===f?0:1),E||n[a].push(c),n}},{key:"isEqualToOriginalAlertPref",value:function(e,t){return e.emailSubscribed===(t.emailSubscribed&&this.state.emailSubscribed)&&e.smsSubscribed===(t.smsSubscribed&&this.state.smsSubscribed)&&e.paperSubscribed===(t.paperSubscribed&&this.state.paperSubscribed)&&(0===Object.keys(e.metaData).length&&0===Object.keys(t.metaData).length||(!isNaN(parseInt(e.metaData[u.cxB]))&&e.metaData[u.cxB])===(!isNaN(parseInt(t.metaData[u.cxB]))&&t.metaData[u.cxB]))}},{key:"updateAlertPreferences",value:function(){var e=this.state,t=e.updatedAlertsMap,a=e.emailSubscribed,r=e.smsSubscribed,n=e.paperSubscribed;this.context.rc.analytics.trackEvent(u.FiA.PREFERENCE,{shown:u.eSs.TABS.ALERT_TYPE,clicked:u.eSs.SAVE_CHANGES,widget:u.wY4.SETTINGS_AND_PREFERENCES,version:u.G_n.V2}),this.props.setSavingAlertTypes();for(var s=Object.keys(t),i=(0,l.kI)(this.props.preferencesData.alertPreferencesMap)[s[0]],o=!1,c=0,d=0;d<s.length;d++){var p={emailSubscribed:a,smsSubscribed:r,paperSubscribed:n,alertPreferenceList:(0,l.kI)(t[s[d]])};if(a!==i.emailSubscribed||r!==i.smsSubscribed||n!==i.paperSubscribed||0!==p.alertPreferenceList.length){var E=1===c&&!o;this.setState({isButtonDisabled:!0}),this.props.setAlertPreferences(this.context.rc,this.props.session.userProfile.userId,p,u.oVm[s[d]]&&s[d],this.state.applyToAllPremises,E),c++,E&&(o=!0)}}}},{key:"goToFeedback",value:function(){var e=[{name:"user-hash",value:this.props.session.userHash.value},{name:"feedback-type",value:u.x51.NEUTRAL},{name:"event-type",value:"UNSUBSCRIBE"},{name:"delivery-mode",value:"Http"},{name:"locale",value:this.props.locale}],t=(0,Se.UM)({pathname:window.location.origin+d.Cp},e);window.open(t,"_self")}},{key:"handleClick",value:function(){this.setState({applyToAllPremises:!this.state.applyToAllPremises})}},{key:"render",value:function(){var e,t,a=this,r=v.V.getColors().colors,n=this.state,s=n.showEmailConfig,i=n.showSMSConfig,o=n.showPaperConfig,c=n.emailSubscribed,l=n.smsSubscribed,d=n.paperSubscribed,u=n.isButtonDisabled,p=n.alertsMap,E=this.props,f=E.translations,g=E.configs,h=E.preferencesData,b=h.setAlertTypesFailed,S=h.setAlertTypesSuccess,N=h.savingAlertTypes,T=this.context.rc.session.getUserRole(),x=-1!==JSON.parse(g["PREFERENCE.PAPER.ALLOWED_ROLES"]).indexOf(T),y=function(e,t){if(t)for(var a=(t=JSON.parse(t)).length-1;a>=0;a--){var r=e.indexOf(t[a]);-1!==r&&(e.splice(r,1),e.unshift(t[a]))}return e}(Object.keys(p),g["ALERT_PAGE.MEASUREMENT_TYPE.ORDER"]);return v.V.getConfiguration().socialLogin&&y.includes("ELECTRIC")&&(p.ELECTRIC=(e=p.ELECTRIC,t=JSON.parse(g.EVMC_SUPPORTED_EMAIL_ALERT_PREFERENCES||"[]"),e.filter((function(e){return t.includes(e.eventName)})))),(0,m.jsxs)(P.Z,{classes:{root:"alert-v2-container"},children:[0===Object.keys(p).length?(0,m.jsx)(G.Z,{}):"",(0,m.jsx)(Te,{configColors:r,translations:f,showEmailConfig:s,showSMSConfig:i,showPaperConfig:o,emailSubscribed:c,smsSubscribed:l,paperSubscribed:d,updateDeliveryModes:function(e,t){return a.updateDeliveryModes(e,t)},paperAllowedForRole:x}),y.map((function(e,t){return(0,m.jsx)(Re,{configColors:r,translations:f,userAlertPreferences:p[e],configs:g,measurementType:e,emailSubscribed:c,smsSubscribed:l,paperSubscribed:d,updateEventDeliveryModes:function(e,t,r,n){return a.updateEventDeliveryModes(e,t,r,n)},changeBudgetThreshold:function(e,t){return a.changeBudgetThreshold(e,t)},paperAllowedForRole:x,allMeasurementTypes:y,budgetThreshold:a.state.budgetThreshold,budgetError:a.state.budgetError},t)})),(0,m.jsx)(ye,{configColors:r,translations:f,configs:g,updateAlertPreferences:function(){return a.updateAlertPreferences()},applyToAllPremises:this.state.applyToAllPremises,premisesDetails:this.props.session.premisesDetails,isSaving:N,setAlertTypesFailed:b,setAlertTypesSuccess:S,isButtonDisabled:u,handleClick:function(){return a.handleClick()}})]})}}]),a}(o.Component);_e.contextType=g.zO;var Ae=(0,f.EN)((0,c.$j)((function(e){return{session:e.session,preferencesData:e.preferencesData,translations:e.translationsData.data,configs:e.configs.data,locale:e.configs.locale,queryParams:e.queryParams}}),(function(e){return{fetchAlertPreferences:function(t,a,r){return e(function(e,t,a){var r={templateName:u.N8j.FETCH_ALERT_TYPE};return a&&(r["measurement-type"]=a),function(n){var s="/v2.0/dashboard/users/"+t+"/communication/alert-preference";e.apiClient.get(s,{params:r}).then((function(e){n({type:B.Nb,payload:{alertList:e.data,measurementType:a}})}))}}(t,a,r))},setAlertPreferences:function(t,a,r,n,s,i){return e(function(e,t,a,r,n,s){var i={templateName:u.N8j.SET_ALERT_TYPE,"apply-to-all-premises":n,notify:s};return r&&(i["measurement-type"]=r),function(r){var n="/v2.0/dashboard/users/"+t+"/communication/alert-preference";e.apiClient.post(n,a,{params:i}).then((function(e){e.error?r({type:B._G}):r({type:B.tc})}))}}(t,a,r,n,s,i))},setSavingAlertTypes:function(){return e((0,B.$K)())},setAlertPreferencesMap:function(t){return e((0,B.W9)(t))},resetAlertPreferences:function(){return e((0,B._w)())}}}))(_e));function Pe(e,t){return e.emailSubscribed&&!t.emailSubscribed||e.smsSubscribed&&!t.smsSubscribed}var Ie=function(e){(0,s.Z)(a,e);var t=(0,i.Z)(a);function a(e){var n;(0,r.Z)(this,a),(n=t.call(this,e)).userPanelRefs=[];for(var s=0;s<n.props.alertTypes.alertPreferenceList.length;s++)n.userPanelRefs.push(o.createRef());return n.state={email:n.props.alertTypes.emailSubscribed,sms:n.props.alertTypes.smsSubscribed,saving:!1,isPristine:!0,eventType:n.props.eventType,userAlertPreferences:n.props.userAlertPreferences,isError:!1,budgetAmount:null},n.configColors=v.V.getColors().colors,n.updateAlertPreferences=n.updateAlertPreferences.bind((0,S.Z)(n)),n.scrollToExpansionPanel=n.scrollToExpansionPanel.bind((0,S.Z)(n)),n.goToFeedback=n.goToFeedback.bind((0,S.Z)(n)),n}return(0,n.Z)(a,[{key:"componentDidUpdate",value:function(e){var t=this;if(this.state.eventType&&this.scrollToExpansionPanel(this.state.eventType),e.userAlertPreferences!==this.props.userAlertPreferences){this.setState((0,R.Z)((0,R.Z)({},this.state),{},{userAlertPreferences:this.props.userAlertPreferences}));var a=null;this.props.userAlertPreferences.forEach((function(e){e.eventName===u.xbb&&e.metaData&&e.metaData.BUDGET_THRESHOLD_AMOUNT&&(a=parseInt(e.metaData.BUDGET_THRESHOLD_AMOUNT),t.setState({budgetAmount:a}))}))}}},{key:"componentWillUnmount",value:function(){this.props.resetAlertPreferences()}},{key:"scrollToExpansionPanel",value:function(e){var t=e&&document.getElementById("".concat(e))?document.getElementById("".concat(e)).offsetTop-80:0;window.scroll({top:t,behavior:"smooth"}),this.setState({eventType:null})}},{key:"updateAlertPreferences",value:function(){var e=this;this.context.rc.analytics.trackEvent(u.FiA.PREFERENCE,{shown:u.eSs.TABS.ALERT_TYPE,clicked:u.eSs.SAVE_CHANGES,widget:u.wY4.SETTINGS_AND_PREFERENCES,version:u.G_n.V1});var t=this.props.configs.data["DASHBOARD.PREFERENCES.UNSUBSCRIBE_SURVEY_ENABLED"],a=function(e){var t=e.notifications,a=e.alertModes,r={emailSubscribed:t.email,smsSubscribed:t.sms,alertPreferenceList:[]};return a.forEach((function(e){if(e&&e.current){var t={metaData:{},alertSubscribed:!1},a=e.current,n=a.eventName;t.eventName=n,W.forEach((function(e){t["".concat(e,"Subscribed")]=a[e],a[e]&&(t.alertSubscribed=!0)})),t.metaData[u.cxB]=null,a.metaData&&n===u.xbb&&(t.metaData[u.cxB]=parseInt(a.metaData.budgetThresholdAmount)),r.alertPreferenceList.push(t)}})),r}({notifications:this.state,alertModes:this.userPanelRefs}),r=function(e,t){if(Pe(e,t))return!0;for(var a=e.alertPreferenceList,r=t.alertPreferenceList,n=0;n<r.length;n++){for(var s=null,i=0;i<a.length;i++)if(a[i].eventName===r[n].eventName){s=a[i];break}if(Pe(s,r[n]))return!0}return!1}(this.props.alertTypes,a),n=t&&r?this.goToFeedback:null;this.setState({saving:!0}),this.props.resetAlertPreferences(),this.props.updateUserAlertPreferences(a,n),setTimeout((function(){e.setState({saving:!1,isPristine:!0,isError:!1})}),1e3)}},{key:"updateNotificationPreferences",value:function(e,t){var a,r=this,n=this.state.userAlertPreferences,s=!1;n.forEach((function(a){a.channels.map((function(n){return n.name===e&&(n.subscribed=t),n.subscribed&&a.eventName===u.xbb&&!j(r.state.budgetAmount)&&(s=!0),n}))})),this.setState((0,R.Z)((0,R.Z)({},this.state),{},(a={},(0,Q.Z)(a,e,t),(0,Q.Z)(a,"isPristine",!1),(0,Q.Z)(a,"isError",s),(0,Q.Z)(a,"userAlertPreferences",n),a))),this.props.resetAlertPreferences(),this.context.rc.analytics.trackEvent(u.FiA.PREFERENCE,{shown:u.eSs.TABS.ALERT_TYPE,clicked:e,subscribe:t,version:u.G_n.V1,widget:u.wY4.SETTINGS_AND_PREFERENCES})}},{key:"updateButtonState",value:function(){var e={isError:!1,isPristine:!1};this.userPanelRefs.forEach((function(t){if(t&&t.current){var a=t.current;a.eventName===u.xbb&&(a.metaData&&(e.budgetAmount=a.metaData.budgetThresholdAmount),e.isError=t.current.error)}})),this.setState(e),this.props.resetAlertPreferences()}},{key:"goToFeedback",value:function(){var e=[{name:"user-hash",value:this.props.userHash.value},{name:"feedback-type",value:u.x51.NEUTRAL},{name:"event-type",value:"UNSUBSCRIBE"},{name:"delivery-mode",value:"Http"},{name:"locale",value:this.props.configs.locale}],t=(0,Se.UM)({pathname:window.location.origin+d.Cp},e);window.open(t,"_self")}},{key:"render",value:function(){var e=this,t=this.props,a=t.setAlertTypesFailed,r=t.setAlertTypesSuccess,n=t.alertTypes,s=n.showSMSConfig,i=n.showEmailConfig,o=this.state,c=o.userAlertPreferences,d=o.email,u=o.sms,p=o.saving,E=o.isPristine,f=o.isError;return(0,m.jsxs)(P.Z,{children:[(0,m.jsx)("div",{className:"alert-type-expansion-panel ".concat((0,l.wG)()?"color-accessible":""),children:(0,m.jsx)(he,{showEmailConfig:i,showSMSConfig:s,emailSubscribed:d,smsSubscribed:u,updateNotificationPreferences:function(t,a){return e.updateNotificationPreferences(t,a)},translations:this.props.translations,configColors:this.configColors})}),c.map((function(t,a){return(0,m.jsx)("div",{className:"alert-type-expansion-panel",children:(0,m.jsx)(pe,{alert:t,isError:f,emailSubscribed:d,smsSubscribed:u,ref:e.userPanelRefs[a],updateButtonState:function(){return e.updateButtonState()},translations:e.props.translations,eventType:e.state.eventType,configColors:e.configColors,configs:e.props.configs})},a)})),(0,m.jsx)(be,{updateAlertPreferences:this.updateAlertPreferences,isSaving:p,isPristine:E,isError:f,setAlertTypesFailed:a,setAlertTypesSuccess:r,translations:this.props.translations,configs:this.props.configs})]})}}]),a}(o.Component);Ie.contextType=g.zO;var De=Ie,we=function(e){(0,s.Z)(a,e);var t=(0,i.Z)(a);function a(){return(0,r.Z)(this,a),t.apply(this,arguments)}return(0,n.Z)(a,[{key:"componentDidMount",value:function(){if(this.props.preferencesData.alertTypes){var e;e=q(this.props.preferencesData.alertTypes,this.props.translationsData.data),this.props.updateAlertPreferencesList(e)}else this.fetchAlertTypes();this.context.rc.analytics.trackEvent(u.FiA.PREFERENCE,{viewed:!0,shown:u.eSs.TABS.ALERT_TYPE,version:u.G_n.V1},this.props)}},{key:"componentDidUpdate",value:function(e){var t=this,a=[],r=this.props.translationsData?this.props.translationsData.data:{};e.preferencesData.alertTypes!==this.props.preferencesData.alertTypes&&this.props.preferencesData.alertTypes&&(a=q(this.props.preferencesData.alertTypes,r),this.props.updateAlertPreferencesList(a)),this.props.preferencesData.alertsUpdated&&setTimeout((function(){t.fetchAlertTypes()}),600),this.props.match.path!==e.match.path&&(this.props.clearAlertPreferences(),this.fetchAlertTypes())}},{key:"fetchAlertTypes",value:function(){var e=$(this.props.match.path,this.props.session.userTypeDetails,this.props.session.userProfile.fuelType,this.props.configs.data);this.props.fetchAlertTypes(this.context.rc,this.props.session.userProfile.userId,e)}},{key:"updateUserAlertPreferences",value:function(e,t){this.props.setAlertTypes(this.context.rc,this.props.session.userProfile.userId,e,$(this.props.match.path,this.props.session.userTypeDetails,this.props.session.userProfile.fuelType,this.props.configs.data),t)}},{key:"render",value:function(){var e=this,t=this.props,a=t.preferencesData,r=a.alertPreferences,n=a.alertTypes,s=a.setAlertTypesFailed,i=a.setAlertTypesSuccess,o=a.eventType,c=t.translationsData,l=t.configs,d=t.session;return(0,m.jsx)(m.Fragment,{children:n?(0,m.jsx)(De,{userAlertPreferences:r,alertTypes:n,setAlertTypesFailed:s,setAlertTypesSuccess:i,updateUserAlertPreferences:function(t,a){return e.updateUserAlertPreferences(t,a)},resetAlertPreferences:function(){return e.props.resetAlertPreferences()},translations:c.data,configs:l,eventType:o,session:this.props.session,userHash:d.userHash}):(0,m.jsx)(G.Z,{className:"alert-loading"})})}}]),a}(o.Component);we.contextType=g.zO;var ke=(0,f.EN)((0,c.$j)((function(e){return{session:e.session,preferencesData:e.preferencesData,translationsData:e.translationsData,configs:e.configs,queryParams:e.queryParams}}),(function(e){return{fetchAlertTypes:function(t,a,r){return e(function(e,t,a){return function(r){var n="/v2.0/dashboard/users/"+t+"/communication/alert-preference";e.apiClient.get(n,{params:a}).then((function(e){r({type:B.ML,payload:e.data})}))}}(t,a,r))},setAlertTypes:function(t,a,r,n,s){return e(function(e,t,a,r,n){return function(s){var i="/v2.0/dashboard/users/"+t+"/communication/alert-preference";e.apiClient.post(i,a,{params:r}).then((function(e){e.error?s({type:B.NU}):(s({type:B.HO}),s({type:B.OH}),n&&n())}))}}(t,a,r,n,s))},updateAlertPreferencesList:function(t){return e((0,B.Yr)(t))},resetAlertPreferences:function(){return e((0,B._w)())},clearAlertPreferences:function(){return e((0,B.KO)())}}}))(we)),Le=a(74268),Fe=a(54299),Oe=a(1550),je=function(e){(0,s.Z)(a,e);var t=(0,i.Z)(a);function a(e){var n;return(0,r.Z)(this,a),(n=t.call(this,e)).state={initialSelectedLanguage:"",selectedLanguage:"",isSaving:!1,disabled:!0},n}return(0,n.Z)(a,[{key:"componentDidMount",value:function(){var e=(0,b.Z)(this.props.languagesList).filter((function(e){return e.selected}))[0].communicationLanguage;this.setState({initialSelectedLanguage:e,selectedLanguage:e})}},{key:"componentDidUpdate",value:function(e){var t=this.props.preferencesData,a=t.languageSaveSuccess,r=t.languageSaveFailed;(a&&!e.preferencesData.languageSaveSuccess||r&&!e.preferencesData.languageSaveFailed)&&this.setState({isSaving:!1,disabled:!0,initialSelectedLanguage:this.state.selectedLanguage})}},{key:"changeSelectedAnswer",value:function(e){this.props.clearLanguageListResponse(),this.state.isSaving||this.setState({selectedLanguage:e.target.value,disabled:e.target.value===this.state.initialSelectedLanguage})}},{key:"saveLanguagePreference",value:function(){var e=(0,b.Z)(this.props.languagesList).map((function(e){return e.communicationLanguage}));e.splice(e.indexOf(this.state.selectedLanguage),1),e.unshift(this.state.selectedLanguage),this.setState({isSaving:!0,disabled:!0}),this.context.rc.analytics.trackEvent(u.FiA.PREFERENCE,{shown:u.eSs.TABS.SETTINGS,clicked:u.eSs.SAVE_CHANGES,previousLanguage:this.state.initialSelectedLanguage,selectedLanguage:this.state.selectedLanguage,widget:u.wY4.SETTINGS_AND_PREFERENCES}),this.props.clearLanguageListResponse(),this.props.saveLanguagePreference(e)}},{key:"render",value:function(){var e=this,t=this.props,a=t.translations,r=t.languagesList,n=t.widgetName,s=t.preferencesData,i=s.languageSaveSuccess,o=s.languageSaveFailed,c=v.V.getColors().colors,d=this.state.disabled,u=((0,l.wG)(),"--primary_500");return(0,m.jsx)(P.Z,{className:"settings-container ".concat((0,l.wG)()?"settings-container-accessible":""),role:"dialog",children:r&&(0,m.jsxs)("div",{className:"settings-item language",children:[(0,m.jsx)("p",{className:"settings-title","data-widget-name":n,"data-text-color":"foreground_500",tabIndex:"0","aria-live":"assertive",role:"alert",children:a["PREFERENCE.SETTINGS.LANGUAGE.TITLE"]}),(0,m.jsx)("p",{className:"settings-subtitle","data-widget-name":n,"data-text-color":"foreground_500",tabIndex:"0","aria-live":"assertive",role:"alert",children:a["PREFERENCE.SETTINGS.LANGUAGE.SUBTITLE"]}),(0,m.jsx)("div",{className:"settings-input-container",children:(0,m.jsx)(Oe.Z,{children:(0,m.jsx)(Fe.Z,{"aria-label":a["DASHBOARD.LABEL.LANGUAGE"],name:"language",value:this.state.selectedLanguage,onChange:function(t){return e.changeSelectedAnswer(t)},children:r.map((function(e){return(0,m.jsx)(F.Z,{value:e.communicationLanguage,tabIndex:"0","data-focus-element":!!(0,l.IR)()&&(0,l.IR)(),control:(0,m.jsx)(Le.Z,{classes:{colorSecondary:"radio-color",checked:"selected"},"data-widget-name":n,"data-text-color":"primary_400","data-active-color":"primary_500",inputProps:{"aria-label":e.communicationLanguage}}),label:e.communicationLanguage,classes:{label:"radio-label"}},e.communicationLanguage)}))})})}),(0,m.jsx)("p",{className:"settings-disclaimer","data-widget-name":n,"data-text-color":"foreground_500",children:a["PREFERENCE.SETTINGS.LANGUAGE.DISCLAIMER"]}),(0,m.jsx)(x.Z,{cssClassName:"settings-button",textColor:"rgb(".concat(c["--foreground_300"],")"),btnTextSize:"16px",btnBackground:d?"rgba(".concat(c[u],", .6)"):"rgb(".concat(c[u],")"),btnText:this.state.isSaving?a["PREFERENCE.SETTINGS.LANGUAGE.SAVING"]:a["PREFERENCE.SETTINGS.LANGUAGE.SAVE"],btnTextTransform:"none",btnHeight:"48px",btnWidth:"200px",onClick:function(){return e.saveLanguagePreference()},disabled:d,hoverColor:"rgb(".concat(c["--primary_500"],")"),hoverTextColor:"rgb(".concat(c["--foreground_300"],")"),activeColor:"rgb(".concat(c["--primary_500"],")"),activeTextColor:"rgb(".concat(c["--foreground_300"],")"),"data-widget-name":n,"data-text-color":"foreground_300","data-bg-color":"primary_500","data-disabled-bg-color":"primary_500","data-hover-color":"primary_500","data-hover-text-color":"foreground_300"}),i&&(0,m.jsx)("p",{className:"settings-message success",dangerouslySetInnerHTML:{__html:a["PREFERENCE.SETTINGS.LANGUAGE.SUCCESS"]},"data-widget-name":n,"data-text-color":"bgl_green_400"}),o&&(0,m.jsx)("p",{className:"settings-message failure",dangerouslySetInnerHTML:{__html:a["PREFERENCE.SETTINGS.LANGUAGE.FAILURE"]},"data-widget-name":n,"data-text-color":"bgl_red_500"})]})})}}]),a}(o.Component);je.contextType=g.zO;var Me=function(e){(0,s.Z)(a,e);var t=(0,i.Z)(a);function a(){return(0,r.Z)(this,a),t.apply(this,arguments)}return(0,n.Z)(a,[{key:"componentDidMount",value:function(){this.context.rc.analytics.trackEvent(u.FiA.PREFERENCE,{viewed:!0,shown:u.eSs.TABS.SETTINGS},this.props)}},{key:"render",value:function(){var e=this;return(0,m.jsx)(je,{session:this.props.session,translations:this.props.translations,preferencesData:this.props.preferencesData,languagesList:this.props.configs.languagesList,saveLanguagePreference:function(t){return e.props.saveLanguagePreference(e.props.session.userProfile.userId,t,u.wY4.SETTINGS_AND_PREFERENCES)},clearLanguageListResponse:function(){return e.props.clearLanguageListResponse()},userId:this.props.session.userProfile.userId,widgetName:u.wY4.SETTINGS_AND_PREFERENCES})}}]),a}(o.Component);Me.contextType=g.zO;var Ze=(0,f.EN)((0,c.$j)((function(e){return{session:e.session,configs:e.configs,translations:e.translationsData.data,preferencesData:e.preferencesData,queryParams:e.queryParams}}),(function(e){return{clearLanguageListResponse:function(){return e((0,B.JQ)())},saveLanguagePreference:function(t,a,r){return e(function(e,t,a,r){var n={};return(0,p.JF)()&&(n.templateName=r),function(r){e.apiClient.post("/v2.1/notifications/user/"+t+"/languages/",a,{options:n}).then((function(e){e.error?r({type:B.BS}):r({type:B.UF,payload:e.data})}))}}(t,a,r))}}}))(Me)),Be=function(e){(0,s.Z)(a,e);var t=(0,i.Z)(a);function a(){return(0,r.Z)(this,a),t.apply(this,arguments)}return(0,n.Z)(a,[{key:"getContentChild",value:function(){switch(this.props.activePane){case u.eSs.TABS.CONTACT_INFO:return V;case u.eSs.TABS.SETTINGS:return Ze;case u.eSs.TABS.ALERT_TYPE:case u.eSs.TABS.ALERT_TYPE_ELECTRIC:case u.eSs.TABS.ALERT_TYPE_GAS:return this.props.alertPageVersion===u.G_n.V1?ke:Ae}}},{key:"render",value:function(){var e=this.getContentChild();return(0,m.jsx)(m.Fragment,{children:(0,m.jsx)(e,{})})}}]),a}(o.Component),Ge=function(e){(0,s.Z)(a,e);var t=(0,i.Z)(a);function a(e){var n;(0,r.Z)(this,a),(n=t.call(this,e)).updateActivePane=n.updateActivePane.bind((0,S.Z)(n)),n.getActiveTabAndRoute=n.getActiveTabAndRoute.bind((0,S.Z)(n));var s=n.getActiveTabAndRoute().currentTabType;return n.state={activePane:s,userAddress:""},n}return(0,n.Z)(a,[{key:"componentDidMount",value:function(){var e=this.props.session.userProfile,t=e&&e.homeAccounts&&e.homeAccounts.address?(0,l.yd)(e.homeAccounts.address):"";this.setState({userAddress:t})}},{key:"componentDidUpdate",value:function(e,t){var a=this.getActiveTabAndRoute().currentTabType;if(this.props.isRunModeSdk||a===this.state.activePane||this.setState({activePane:a}),(0,l.IR)()&&this.refs&&this.refs.preferenceContainer&&t.activePane!==this.state.activePane){var r=this.refs.preferenceContainer.childNodes[0].querySelector('[data-focus-element="true"]');r&&_.findDOMNode(r).focus()}}},{key:"getActiveTabAndRoute",value:function(){var e=this.props,t=e.queryParams,a=e.location,r=t.tabType||this.props.widgetConfigs.prefrencesDefaultTab,n=a.pathname.split("/").pop();switch("/".concat(n)){case d.qP:r=u.eSs.TABS.ALERT_TYPE;break;case d.L4:r=u.eSs.TABS.CONTACT_INFO;break;case d.BF:r=u.eSs.TABS.SETTINGS;break;default:r=r||u.eSs.TABS.ALERT_TYPE}return{currentTabType:r}}},{key:"updateActivePane",value:function(e,t){(0,l.BC)(t)||e!==this.state.activePane&&(this.props.isRunModeSdk||this.props.history.push("".concat(this.props.routePath,"/").concat(u.eSs.URLS[e])),this.setState((function(){return{activePane:e}})))}},{key:"render",value:function(){var e=this,t=!(!this.props.queryParams||!this.props.queryParams.hidePageTitle),a=this.props.widgetStrings.title,r=this.props.isRunModeSdk,n=this.props.widgetConfigs.hideAddress,s=this.props.widgetConfigs.showTabs,i=this.props.widgetConfigs.alertsVersion,o=(0,b.Z)(JSON.parse(this.props.widgetConfigs.preferencesTabs)),c=this.props.widgetConfigs.showHeader;return(0,m.jsx)(m.Fragment,{children:this.props.widgetStrings&&this.props.preferencesData?(0,m.jsx)(T.Z,{disableGutters:!0,className:"preference-content ".concat(r?"wc":"dashboard"),role:"region","aria-label":a,children:(0,m.jsxs)(N.ZP,{container:!0,direction:"row",justifyContent:"center",alignItems:"center",children:[!r&&(0,m.jsxs)(m.Fragment,{children:[!t&&c&&(0,m.jsx)(N.ZP,{item:!0,xs:12,children:(0,m.jsx)("h1",{className:"header-title","data-widget-name":u.wY4.SETTINGS_AND_PREFERENCES,"data-text-color":"foreground_400",children:a})}),!t&&!n&&(0,m.jsx)(N.ZP,{item:!0,xs:12,className:"header-address",children:(0,m.jsx)("span",{"data-widget-name":u.wY4.SETTINGS_AND_PREFERENCES,"data-text-color":"foreground_400",children:this.state.userAddress})})]}),r&&c&&(0,m.jsx)("div",{className:"widget-header-cont",children:(0,m.jsx)("span",{role:"heading","aria-level":2,"data-widget-name":u.wY4.SETTINGS_AND_PREFERENCES,"data-text-color":"foreground_400",children:a})}),(0,m.jsxs)(N.ZP,{item:!0,xs:12,container:!0,direction:"column",className:"preference-row-wrapper",children:[s&&(0,m.jsx)(C,{updatePane:function(t,a){return e.updateActivePane(t,a)},activePane:this.state.activePane,widgetStrings:this.props.widgetStrings,responsiveness:this.props.responsiveness,preferencesTabs:o}),(0,m.jsx)(Be,{activePane:this.state.activePane,alertPageVersion:i})]})]})}):(0,m.jsx)(m.Fragment,{})})}}]),a}(o.Component),Ye=(0,f.EN)((0,c.$j)((function(e){return{session:e.session,preferencesData:e.preferencesData,queryParams:e.queryParams,responsiveness:e.responsiveness}}))(Ge)),Ue=(a(70862),a(61939)),He=a(21629),Ve=(a(82574),function(e){(0,s.Z)(a,e);var t=(0,i.Z)(a);function a(){return(0,r.Z)(this,a),t.apply(this,arguments)}return(0,n.Z)(a,[{key:"componentDidMount",value:function(){this.context.runMode===u.K8z||(0,l.Iw)("PREFERENCES_PAGE.TITLE",this.props.translations.data,this.props.configs.data)}},{key:"render",value:function(){var e=this.context.rc.session.isSolarUser(),t=this.context.runMode===u.K8z;return(0,m.jsxs)(m.Fragment,{children:[this.props.session.userProfile&&(0,m.jsx)(Ye,{widgetStrings:this.props.widgetStrings,widgetConfigs:this.props.widgetConfigs,isRunModeSdk:t,routePath:d.Md}),!t&&this.props.configs&&this.props.configs.data&&this.props.configs.data["DASHBOARD.PREFERENCE_PAGE.FOOTER.SHOW"]?(0,m.jsx)(h,{session:this.props.session,configs:this.props.configs,translations:this.props.translations,footerNote:this.props.translations.data["FOOTER.PREFERENCE_PAGE.FOOTER_NOTE"],uuid:this.props.session.userProfile.userId,queryParams:this.props.queryParams,isSolar:e,userTypeDetails:this.props.configs.userType}):""]})}}]),a}(o.Component));Ve.contextType=g.zO;var We=(0,Ue.$)(He.Z$.USER_PREFERENCES,(0,c.$j)((function(e){return{session:e.session,configs:e.configs,translations:e.translationsData,queryParams:e.queryParams}}))(Ve))}}]);