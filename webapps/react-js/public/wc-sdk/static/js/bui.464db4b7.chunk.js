"use strict";(self.webpackChunkmeraki=self.webpackChunkmeraki||[]).push([[657],{69415:function(e,t,i){i.r(t),i.d(t,{default:function(){return Q}});var s=i(1413),a=i(15671),o=i(43144),n=i(97326),r=i(60136),l=i(98557),c=i(47313),p=i(1084),h=i(14427),d=i(16404),g=i(19615),u=i(11322),A=i(88291),f=i(96534),S=i(97240),m=i(28485),E=i(65280),v=i(56955),C=i(46417);function b(e){var t=e.items,i=e.selectedItem,s=e.onToggleItem,a=e.ariaLabel;return(0,C.jsx)("div",{className:"bcl-list-slider ".concat((0,v.wG)()?"slider-color-accessible":""),"data-widget-name":e.widgetName,"data-bg-color":"primary_200",children:(0,C.jsx)(m.Z,{TabScrollButtonProps:{disabled:!1},className:"bcl-list-tabs",variant:"scrollable",scrollButtons:!!e.scrollable&&"auto",classes:{scrollButtons:"bcl-list-arrows",scroller:"scroller",indicator:"indicator"},value:i,"aria-label":a,children:t.map((function(t){return(0,C.jsx)(E.Z,{label:t.value,className:"bcl-list-tab ".concat(i===t.id?"bcl-list-tab-active":""),value:t.id,onClick:function(){return s(t.id)},"data-widget-name":e.widgetName,"data-active-bg-color":"background_300","data-border-color":"background_300"},t.id)}))})})}var D=i(76720),w=i(54299),I=i(83929),T=i(50917),N=i(10792),U=i(46495),y=null,x=function(e){(0,r.Z)(i,e);var t=(0,l.Z)(i);function i(e){var s;return(0,a.Z)(this,i),(s=t.call(this,e)).onModeChange=s.onModeChange.bind((0,n.Z)(s)),s.onToggleAppliance=s.onToggleAppliance.bind((0,n.Z)(s)),s.onGranularityChange=s.onGranularityChange.bind((0,n.Z)(s)),s.filterAnchorEl=c.createRef(),s.tabList=c.createRef(),s}return(0,o.Z)(i,[{key:"componentDidUpdate",value:function(e){if(this.props.setFilterAnchorEl(this.filterAnchorEl.current),!y&&(0,v.IR)()&&this.tabList&&this.tabList.current){var t=this.tabList.current;Array.from(t.querySelectorAll(d.bTR)).forEach((function(e){"true"===e.ariaSelected&&(y=e)}))}}},{key:"onViewChange",value:function(e){this.context.rc.analytics.trackEvent(d.FiA.INSIGHTS,{clicked:d.GNf.VIEWS_TOGGLE,view:e,widget:d.wY4.INSIGHTS.USAGE,version:d.zZZ.V2}),this.context.rc.analytics.trackGtmEvent("action-click",{pageName:d.FiA.INSIGHTS,click:d.GNf.VIEWS_TOGGLE,view:e});var t=this.props.configs["INSIGHTS.APPLIANCE.SHOW_OTHER_MODES"],i=this.props.insightsUsageV2Data.insightUsageV2Controls,a=i.view;if(e!==a){var o=i.mode;if(e!==d.H5d.APPLIANCE||t){var n=(0,f.qx)(this.context.rc,this.props.session.userProfile,this.props.configs,e,this.props.ratePlanNumber);o=-1!==n.indexOf(o.toUpperCase())?o:d.DEY[n[n.length-1]]}else o=d.DEY.YEAR;this.props.updateControl({view:e,mode:o,autoVoiceOver:!0}),this.setState((0,s.Z)((0,s.Z)({},this.state),{},{selectedView:e}));var r=this.props.insightsUsageV2Data.insightsUsageV2ChartData[o],l=r.apiResponse,c=r.timeRange,p=this.props.widgetConfigs.showMinuteUsage,h=this.props.widgetConfigs.skipOngoingBC||this.props.widgetConfigs.skipOngoingBcUsage,g=e===d.H5d.APPLIANCE||a===d.H5d.APPLIANCE,u=this.context.rc.session.isSolarUser(),S=o===d.DEY.DAY&&p;l&&!(h||S||u&&g)||this.props.fetchInsightsUsageData(o,e,c.start,c.end),this.context.runMode!==d.K8z&&this.props.history.push((0,A.UM)(this.props.location,[{name:"usage-view",value:e},{name:"usage-mode",value:o.toUpperCase()}]))}}},{key:"onModeChange",value:function(e){this.context.rc.analytics.trackEvent(d.FiA.INSIGHTS,{clicked:d.GNf.MODES_TOGGLE,mode:e,widget:d.wY4.INSIGHTS.USAGE,version:d.zZZ.V2}),this.context.rc.analytics.trackGtmEvent("action-click",{pageName:d.FiA.INSIGHTS,click:d.GNf.MODES_TOGGLE,mode:e});var t=this.props.insightsUsageV2Data.insightUsageV2Controls,i=t.view;if(e!==t.mode&&t.timeOfUse!==d.u0K.TYPE)this.props.updateControl({mode:e,autoVoiceOver:!0});else{var s=d.NMd.ALL.type;this.props.updateControl({mode:e,timeOfUse:s,autoVoiceOver:!0})}this.props.updateControl({selectedAppliance:i===d.H5d.APPLIANCE&&t.mode!==e?e===d.DEY.YEAR?t.prevSelectedAppliance:d.N$L:t.selectedAppliance,autoVoiceOver:!0,prevSelectedAppliance:e!==d.DEY.YEAR&&t.mode===d.DEY.YEAR?t.selectedAppliance:t.prevSelectedAppliance}),this.props.fetchInsightsUsageData(e,i)}},{key:"onToggleAppliance",value:function(e){e!==this.props.insightsUsageV2Data.insightUsageV2Controls.selectedAppliance&&(this.props.updateControl({selectedAppliance:e,autoVoiceOver:!0}),this.context.runMode!==d.K8z&&this.props.history.push((0,A.UM)(this.props.location,[{name:"app-id",value:e}])),this.context.rc.analytics.trackEvent(d.FiA.INSIGHTS,{clicked:d.GNf.APPLIANCE_TOGGLE,applianceId:e,widget:d.wY4.INSIGHTS.USAGE,version:d.zZZ.V2}),this.context.rc.analytics.trackGtmEvent("action-click",{pageName:d.FiA.INSIGHTS,click:d.GNf.APPLIANCE_TOGGLE,applianceId:e}))}},{key:"onGranularityChange",value:function(e){this.context.rc.analytics.trackEvent(d.FiA.INSIGHTS,{clicked:d.GNf.GRANULARITY_TOGGLE,granularity:e,widget:d.wY4.INSIGHTS.USAGE,version:d.zZZ.V2}),this.context.rc.analytics.trackGtmEvent("action-click",{pageName:d.FiA.INSIGHTS,click:d.GNf.GRANULARITY_TOGGLE,granularity:e});var t=this.props.insightsUsageV2Data.insightUsageV2Controls,i=this.props.insightsUsageV2Data.insightsUsageV2ChartData[t.mode].timeRange;this.props.updateControl({granularity:e}),this.props.fetchInsightsUsageData(t.mode,t.view,i.start,i.end,void 0,e)}},{key:"render",value:function(){var e=this,t=this.props,i=t.showFilterBtn,a=t.widgetName,o=t.insightsUsageV2Data,n=t.intermediateData,r=t.applianceList,l=t.handleArrowClick,c=t.handleFilterModal,p=t.intervalDetails,h=t.translations,g=t.enableApplianceSelection,u=t.enableModeSelection,A=t.configs,m=t.widgetStrings,E=t.isShowADABtn,D=this.context.rc.session.isSolarUser(),y=(this.props.allowedViews,n.usagePageDetectedAppliances),x=o.insightUsageV2Controls,G=(0,f.zl)(this.props.widgetConfigs),L=(0,f.Di)(x,G),O=o.isChartLoading||o.apiError,k=this.props.configs["INSIGHTS.APPLIANCE.SHOW_OTHER_MODES"],R=d.H5d.APPLIANCE===o.insightUsageV2Controls.view&&d.DEY.YEAR==o.insightUsageV2Controls.mode,H=y.map((function(e){var t=k&&e==d.N$L?m.totalApplianceLabel:r[e];return{id:parseInt(e),value:t}})),V=function(e){switch(e){case d.DEY.YEAR.toUpperCase():return m.usageModeYear;case d.DEY.MONTH.toUpperCase():return m.usageModeMonth;case d.DEY.DAY.toUpperCase():return m.usageModeDay}},M=(0,f.qx)(this.context.rc,this.props.session.userProfile,A).map((function(e){return{id:d.DEY[e],value:V(e)}})),P=h["INSIGHTS.USAGE.ADA.LABEL"],Y=h["DASHBOARD.INSIGHT_USAGE.TIME_FILTER.ADA_LABEL"],Z=h["DASHBOARD.INSIGHT_USAGE.APPLIANCES_FILTER.ADA_LABEL"],_=o.apiError;return(0,C.jsx)("div",{className:"insights-usage-controller-v2","aria-hidden":O,children:(0,C.jsxs)("div",{className:"insights-usage-header ".concat((0,v.wG)()?"color-accessibility":""),children:[(0,C.jsxs)("div",{className:"main-controls",children:[(0,C.jsx)(N.Z,(0,s.Z)((0,s.Z)({},this.props),{},{isSolar:D,controls:o.insightUsageV2Controls})),(0,C.jsxs)("div",{className:"interval-selector ".concat((0,v.IR)()?"ada-btn-wrapper":""),children:[(0,C.jsx)(S.Z,{widgetName:a,enableLeftArrow:o.enableLeftArrow,enableRightArrow:o.enableRightArrow,intervalDetails:p,handleArrowClick:l,direction:1,disableAda:_,previousBtnLabel:h["DASHBOARD.INSIGHT_USAGE_INTERVAL.PREVIOUS_".concat(x.mode.toUpperCase())],nextBtnLabel:h["DASHBOARD.INSIGHT_USAGE_INTERVAL.NEXT_".concat(x.mode.toUpperCase())],translations:h}),(0,v.IR)()&&E?(0,C.jsx)("button",{ref:"usageAdaRef",className:"accessibility-cta insights-page",tabIndex:_?-1:0,"aria-label":P,onClick:function(){return e.props.handleADA(e.refs.usageAdaRef)},children:(0,C.jsx)("span",{className:"bidgely-icon-accessibility"})}):""]})]}),(0,C.jsxs)("div",{className:"sub-controls ".concat((0,v.IR)()?"sub-controls-color-accessibility":""),"data-widget-name":a,"data-bg-color":"primary_200",children:[(0,C.jsxs)("div",{className:"sub-controls-left",children:[!k&&g&&g(x.view)&&y.length&&!O?(0,C.jsx)(b,{selectedItem:parseInt(x.selectedAppliance),items:H,onToggleItem:function(t){return e.onToggleAppliance(t)},widgetName:a,ariaLabel:Z,scrollable:!0}):"",u&&u(x.view)&&M.length>=1&&(0,C.jsx)(b,{selectedItem:x.mode,items:M,onToggleItem:function(t){return e.onModeChange(t)},widgetName:a,ariaLabel:Y}),R&&k&&g&&g(x.view)&&(0,C.jsx)(U.Z,{selectedItem:parseInt(x.selectedAppliance),items:H,onToggleItem:function(t){return e.onToggleAppliance(t)},ariaLabel:Z,dropDownWidth:"120px"})]}),i&&!_?(0,C.jsx)("div",{ref:this.filterAnchorEl,className:"sub-controls-right",children:i(x.mode,x.view)&&c&&(0,C.jsxs)("button",{className:"insights-usage-filter",onClick:function(){return c(!0,e.refs.filterRef)},ref:"filterRef",tabIndex:_?-1:0,children:[(0,C.jsx)("span",{className:"filter-icon"}),(0,C.jsx)("span",{className:"filter-text",children:this.props.filterLabel})]})}):""]}),x.granularity&&L&&(0,C.jsx)("div",{className:"sub-controls ".concat((0,v.IR)()?"sub-controls-color-accessibility":""),"data-widget-name":a,"data-bg-color":"primary_200",children:(0,C.jsx)(w.Z,{row:!0,"aria-labelledby":"row-radio-buttons-group-label",name:"row-radio-buttons-group",value:x.granularity,onChange:function(t){return e.onGranularityChange(Number.parseInt(t.target.value))},children:G.map((function(e,t){return(0,C.jsx)(I.Z,{classes:{root:"granularity-label"},value:e,control:(0,C.jsx)(T.Z,{checked:x.granularity==e,value:e}),label:"".concat(e," ").concat(h["DASHBOARD.COMMON.MIN"])},t)}))})})]})})}}]),i}(c.Component);x.contextType=D.zO;var G=(0,p.$j)((function(e){return{session:e.session,configs:e.configs.data,translations:e.translationsData.data,applianceList:e.appliances.appliancesList,intermediateData:e.intermediateData}}),(function(e){return{updateControl:function(t){return e((0,u.WL)(t))}}}))(x),L=i(93433),O=i(27507),k=i(75260),R=i(69140),H=i(57284),V=(i(83450),i(21629)),M=i(57034),P=i(41294),Y=function(e){(0,r.Z)(i,e);var t=(0,l.Z)(i);function i(e){var s;return(0,a.Z)(this,i),(s=t.call(this,e)).handleRatePlanDialog=function(){s.setState({showRatePlanDialog:!s.state.showRatePlanDialog})},s.navigateToShc=s.navigateToShc.bind((0,n.Z)(s)),s.configColors=g.V.getColors().colors,s.showOtherModesForAppliance=s.props.configs["INSIGHTS.APPLIANCE.SHOW_OTHER_MODES"],s.state={totalConsumption:0,showRatePlanDialog:!1},s}return(0,o.Z)(i,[{key:"getDateFormatForMode",value:function(e){switch(e){case d.DEY.YEAR:return this.props.widgetConfigs.dateFormatYear;case d.DEY.MONTH:return this.props.widgetConfigs.dateFormatMonth;case d.DEY.DAY:return this.props.widgetConfigs.dateFormatDay}}},{key:"getHighchartsOptions",value:function(e,t,i){var a=this,o=e===d.UEz.DEMAND_CHARGE,n=e===d.UEz.MAX_DEMAND_GRAPH,r=this.props.insightsUsageV2Data,l=r.insightUsageV2Controls.selectedAppliance,c=parseInt(l)==d.N$L,p=(0,f.VW)(this.props.configs,i),h=r.insightUsageV2Controls.mode,g=r.insightsUsageV2ChartData[h].apiResponse,u=r.insightUsageV2Controls.view,A=u===d.H5d.USAGE||u===d.H5d.APPLIANCE&&(0,f.xB)(this.context.rc,this.props.configs)===d.AgQ.ENERGY?d.AgQ.USAGE:d.AgQ.COST,S=this.props.session.userProfile.fuelType,m=this.props.widgetConfigs.weatherUnit,E=this.props.translations.data,C=this,b=u===d.H5d.COST&&h!==d.DEY.YEAR,D=this.props.widgetConfigs.showMinuteUsage,w=D&&(0,f.fH)(h,u),I=this.props.isMobileView,T=g&&g.length/24,N=w&&e===d.UEz.USAGE&&1!==T,U=N?this.props.widgetConfigs.dateFormatMins:this.getDateFormatForMode(h),y=this.props.configs["INSIGHTS.USAGE.TIER_TOU.VIEW"]||!1,x=(0,f.xB)(this.context.rc,this.props.configs);h===d.DEY.YEAR?g=(0,f.Jq)(g,this.props.insightsUsageV2Data.yearOffset):u===d.H5d.COST&&D&&h===d.DEY.DAY&&g&&(g=(0,f.YR)(g));var G=(0,f.f6)(g);G!==this.state.totalConsumption&&this.setState({totalConsumption:G});var L=w&&g?(0,f.YR)(g):g,O=o?this.prepareDemandChargeSeries(L):this.prepareChartData(h,g);O=n?this.prepareMaxDemandGraphSeries(g):O;var k=h===d.DEY.YEAR?d.DEY.MONTH:d.DEY.DAY,R=(0,f.qx)(this.context.rc,this.props.session.userProfile,this.props.configs),H=(0,f.qE)(this.context.rc,this.props.session,this.props.configs),V=R.indexOf(k.toUpperCase())>=0&&H.indexOf(A.toUpperCase())>=0,M=function(e){if(e&&V&&!n){var t=u!==d.H5d.APPLIANCE||a.showOtherModesForAppliance?u:x===d.AgQ.ENERGY?d.H5d.USAGE:d.H5d.COST;g&&g[e.index]&&h!==d.DEY.DAY&&(C.context.rc.analytics.trackGtmEvent("action-click",{pageName:d.FiA.INSIGHTS,click:"chartData",mode:k,view:t}),C.context.rc.analytics.trackEvent(d.FiA.INSIGHTS,{pageName:d.FiA.INSIGHTS,clicked:"chartData",mode:k,view:t,userType:g[e.index].userType,planNumber:g[e.index].planNumber,intervalStart:g[e.index].intervalStart,intervalEnd:g[e.index].intervalEnd,widget:d.wY4.INSIGHTS.USAGE,version:d.zZZ.V2}),C.props.fetchInsightsUsageData(k,t,g[e.index].intervalStart+1,g[e.index].intervalEnd))}};p=(0,s.Z)((0,s.Z)({},p),{},{chart:{height:o||u===d.H5d.USAGE&&t||n?200:"auto",backgroundColor:"rgb(".concat(this.configColors["--background_300"],")"),renderTo:"container",events:{load:function(e){d.H5d.APPLIANCE==u&&d.DEY.DAY==h&&e.target&&e.target.series&&e.target.series.length&&(0,f.OM)(e.target,I,r.peakHours)}}},xAxis:(0,f.yy)(o?L:g,h,u,U,E,o,I,N,C.props.configs),yAxis:(0,f.dp)(A,S,m,o,n,h,u,C.props.isSolar,C.props.configs,I),plotOptions:(0,s.Z)((0,s.Z)({},p.plotOptions),{},{series:(0,s.Z)((0,s.Z)({states:{inactive:{opacity:u===d.H5d.APPLIANCE?.2:1,enabled:u===d.H5d.APPLIANCE}}},p.plotOptions.series),{},{cursor:V&&h!==d.DEY.DAY?"pointer":"normal",point:{events:{click:function(e){return M(e.target||null),!0}}},events:{click:function(e){return M(e.point||null),document.activeElement&&document.activeElement.blur(),!0},legendItemClick:function(){return!1}}}),column:(0,s.Z)((0,s.Z)({},p.plotOptions.column),{},{cursor:V&&h!==d.DEY.DAY?"pointer":"normal"})}),legend:b?(0,s.Z)((0,s.Z)({},p.legend),{},{reversed:u===d.H5d.COST,squareSymbol:!1,symbolHeight:0,symbolWidth:0,symbolRadius:0,useHTML:!0,labelFormatter:function(){return(0,f.w8)(this,E)}}):(0,s.Z)((0,s.Z)({},p.legend),{},{reversed:u!==d.H5d.USAGE,labelFormatter:function(){return this.name===d.IXo.NAME?C.props.widgetStrings.temperatureLabel:this.name}}),tooltip:(0,s.Z)((0,s.Z)({},p.tooltip),{},{outside:!1,backgroundColor:null,borderWidth:0,formatter:function(){return(0,f.Vg)(C.context.rc,this,g,h,u,C.props.configs,E,o,n,S,N?U:null,C.props.isSolar,C.props.applianceList,C.props.widgetStrings,y)}}),series:O}),(0,v.IR)()&&(p.accessibility={enabled:!i,point:{valueDescriptionFormat:null,descriptionFormatter:function(e){return(0,f.H7)(C.context.rc,g,e,N,o,C.props.isSolar,u,h,U,S,C.props.configs,E)}},series:{valueDescriptionFormat:null,descriptionFormatter:function(e){var t=e.name===d.IXo.NAME?C.props.widgetStrings.temperatureLabel:e.name;return t+=", series ".concat(e.index+1," of ").concat(e.chart.series.length," with ").concat(e.points.length," data points.")}}});var P=(0,v.rK)(this.props.widgetConfigs,this.props.isSolar);P&&(p.yAxis[0].reversedStacks=!0);var Y=P&&!I&&h===d.DEY.YEAR&&(u==d.H5d.COST||u==d.H5d.APPLIANCE&&c);return p.yAxis[0].stackLabels={enabled:Y,useHTML:!0,formatter:function(e,t){var i=this.x>=g.length?g.length-1:this.x,s=g[i],a=s.cost>0?s.cost:this.total;return this.isNegative||a<=0?null:'<div style="border: 1px solid #8590A3; border-radius: 7px; color: #37445E; background-color: #fff; padding: 1px 7px;">'.concat((0,v.xB)({cost:a,showCurrency:!0,round:!0}),"</div>")}},p}},{key:"handleLinkClick",value:function(e){return(0,A.ju)(e,this.props.session,this.props.configs,this.props.history)}},{key:"getTouLabel",value:function(e){switch(e){case d.NMd.ALL.type:return this.props.widgetStrings.filterModal.usageTouAll;case d.NMd.OFF_PEAK.type:return this.props.widgetStrings.filterModal.usageTouOffPeak;case d.NMd.MID_PEAK.type:return this.props.widgetStrings.filterModal.usageTouMidPeak;case d.NMd.ON_PEAK.type:return this.props.widgetStrings.filterModal.usageTouOnPeak}}},{key:"getTierLabel",value:function(e){switch(e){case"0":return this.props.widgetStrings.filterModal.usageTier0;case"1":return this.props.widgetStrings.filterModal.usageTier1;case"2":return this.props.widgetStrings.filterModal.usageTier2}}},{key:"getPeakDemandDisclaimer",value:function(e){switch(e){case d.DEY.YEAR:return this.props.widgetStrings.peakDemandYear;case d.DEY.MONTH:return this.props.widgetStrings.peakDemandMonth;case d.DEY.DAY:return this.props.widgetStrings.peakDemandDay}}},{key:"getTouDisclaimer",value:function(e){switch(e){case d.DEY.YEAR:return this.props.widgetStrings.touDisclaimerYear;case d.DEY.MONTH:return this.props.widgetStrings.touDisclaimerMonth;case d.DEY.DAY:return this.props.widgetStrings.touDisclaimerDay}}},{key:"prepareChartData",value:function(e,t){var i=this,s=this.props.isSolar,a=this.props.insightsUsageV2Data,o=[],n=a.insightUsageV2Controls,r=n.view,l=n.graphStyle,c=(0,f.xB)(this.context.rc,this.props.configs),p=this.props.configs["DASHBOARD.USAGE.PEAK_HOURS_LEGEND_ICON"],h=n.selectedAppliance,g=this.props.translations.data,u=n.timeOfUse===d.u0K.TYPE&&n.mode!==d.DEY.YEAR?d.NMd.ALL.type:n.timeOfUse,A=(0,f.HT)(this.props.session.userProfile,this.props.configs),S=parseInt(h)===parseInt(d.N$L),m=(0,v.rK)(this.props.widgetConfigs,s),E=!!this.props.configs["INSIGHTS.USAGE.TIER_TOU.VIEW"]&&this.props.configs["INSIGHTS.USAGE.TIER_TOU.VIEW"],C=l==d.LPx.AREA,b=this.props.configs["INSIGHTS.USAGE.PEAK_DEMAND_APPLIANCE.SHOW"];if(t){var D=(0,f.Ot)(t,e,this.props.applianceList,s,r,this.props.isModalTableEnabled,this.props.configs,C),w=[];this.props.widgetConfigs.showTemperatureSeries&&(w=(0,f.HE)(t));var I=r===d.H5d.COST||r===d.H5d.APPLIANCE?(0,f.MF)(t,e,!(0,f.qc)(w)):[],T=null,N=null,U=(0,f.zM)(D,e,d.uRV.COST),y=(0,f.zM)(D,e,d.uRV.ENERGY);(0,f.qc)(w)||(T={name:d.IXo.NAME,type:d.IXo.GRAPH_TYPE,yAxis:1,data:w,excludeSeries:!0,marker:{symbol:"circle",lineWidth:2,radius:this.props.isMobileView?2:4,lineColor:"rgb(".concat(this.configColors[d.IXo.COLOR_V2],")"),fillColor:"rgb(".concat(this.configColors[d.IXo.FILL_COLOR],")")},color:"rgb(".concat(this.configColors[d.IXo.COLOR],")"),zIndex:2,connectNulls:!0}),(0,f.qc)(I)||(N=e===d.DEY.YEAR?{name:d.u0K.NAME,type:l,data:I,color:u===d.NMd.ALL.type||u===d.u0K.TYPE?"rgb(".concat(this.configColors[d.u0K.COLOR],")"):"rgb(".concat(this.configColors[d.NA.COLOR],")"),borderWidth:0}:{name:d.u0K.NAME,type:b?"line":"scatter",data:I,lineWidth:0,tooltip:{enabled:!1},borderWidth:0,color:"rgb(".concat(this.configColors[d.u0K.COLOR],")"),zIndex:1,marker:{radius:6,symbol:"url(".concat(d.u0K.ICON,")"),width:this.props.isMobileView?12:16,height:this.props.isMobileView?17:21}});var x=(0,f.dN)(t,m);switch(r){case d.H5d.APPLIANCE:var G=m&&parseInt(h)===parseInt(d.N$L),O=(0,f.Bk)();if(d.DEY.DAY==e&&this.showOtherModesForAppliance&&a.peakHours&&a.peakHours.length&&o.push({name:this.props.widgetStrings.peakHoursStr,type:"line",data:[],excludeSeries:!0,color:"rgb(".concat(O.onPeak,", 0.2)"),borderWidth:0,states:{inactive:{enabled:!1}},accessibility:{enabled:!1},showInLegend:!0,marker:{symbol:"url(".concat(p,")")}}),T&&o.push(T),G){var k=(0,f.Qb)({chargeName:"other charges"}),R=D[k.itemCostKey];R&&R.length&&!(0,f.qc)(R)&&o.push({name:this.props.widgetStrings.otherChargesLabel,type:l,data:(0,L.Z)(R),borderWidth:0,color:"rgb(".concat(this.configColors[d.ZBm[k.configKey].color],")")}),x.length&&x.map((function(e){var t=(0,f.Qb)(e);D[t.costKey]&&D[t.costKey].length&&o.push({name:e.chargeNameText,type:l,data:c===d.AgQ.COST?(0,L.Z)(D[t.costKey]):(0,L.Z)(D[t.energyKey]),borderWidth:0,color:"rgb(".concat(i.configColors[d.ZBm[t.configKey].color],")")})})),N&&o.push(N)}parseInt(h)===parseInt(d.N$L)||this.showOtherModesForAppliance||o.push({name:this.props.widgetStrings.otherAppliances,type:l,data:(0,f.cK)(d.H5d.APPLIANCE,h,D,c,e,t,s,this.props.applianceList,G),borderWidth:0,color:"rgb(".concat(this.configColors[d.NA.COLOR],")"),visible:!S});var H=(0,f.sL)(this.props.applianceList),V=[];H.forEach((function(e){var t=(0,f.Vb)(e,d.AgQ.COST),s=(0,f.Vb)(e,d.AgQ.ENERGY);(c===d.AgQ.COST?(0,f.qc)(D[t]):(0,f.qc)(D[s]))||(-1!==A.indexOf(e)&&V.push(e),parseInt(h)===parseInt(e)&&parseInt(h)!=d.N$L?o.push({name:i.props.applianceList[h],type:l,data:c===d.AgQ.COST?(0,L.Z)(D[t]):(0,L.Z)(D[s]),borderWidth:0,color:"rgb(".concat(i.configColors[d.lss[e]],")"),visible:parseInt(h)===parseInt(e),minPointLength:3}):parseInt(h)==d.N$L&&o.push({name:i.props.applianceList[e],type:l,data:c===d.AgQ.COST?(0,L.Z)(D[t]):(0,L.Z)(D[s]),borderWidth:0,color:"rgb(".concat(i.configColors[d.lss[e]],")"),visible:parseInt(h)===parseInt(e)||S,minPointLength:3}))})),V.reverse(),V.unshift(d.N$L),this.props.setDetectedAppliances({usagePageDetectedAppliances:V}),(c===d.AgQ.COST?(0,f.qc)(D.dataNACost):(0,f.qc)(D.dataNAEnergy))||parseInt(h)!==parseInt(d.N$L)||o.push({name:d.NA.NAME,type:l,data:c===d.AgQ.COST?(0,L.Z)(D.dataNACost):(0,L.Z)(D.dataNAEnergy),borderWidth:0,states:{inactive:{enabled:!1}},showInLegend:!1,color:"rgb(".concat(this.configColors[d.NA.COLOR],")")});var M=c===d.AgQ.COST?(0,L.Z)(D.dataOngoingCost):(0,L.Z)(D.dataOngoingEnergy);(0,f.qc)(M)||o.push({name:d.O6l.NAME,type:l,data:M,borderWidth:0,states:{inactive:{enabled:!1}},showInLegend:!1,color:"rgb(".concat(this.configColors[d.O6l.COLOR],")"),visible:S,minPointLength:3});break;case d.H5d.COST:if(T&&o.push(T),m){var P=(0,f.Qb)({chargeName:"other charges"});D[P.costKey]&&D[P.costKey].length&&!(0,f.qc)(D[P.costKey])&&o.push({name:this.props.widgetStrings.otherChargesLabel,type:l,data:(0,L.Z)(D[P.costKey]),borderWidth:0,color:"rgb(".concat(this.configColors[d.ZBm[P.configKey].color],")")})}if(m&&x.length&&x.map((function(e){var t=(0,f.Qb)(e);D[t.costKey]&&D[t.costKey].length&&o.push({name:e.chargeNameText,type:l,data:c===d.AgQ.COST?(0,L.Z)(D[t.costKey]):(0,L.Z)(D[t.energyKey]),borderWidth:0,color:"rgb(".concat(i.configColors[d.ZBm[t.configKey].color],")")})})),N&&m&&o.push(N),D){var Y=(0,f.pE)(D,e,d.uRV.COST,m);this.prepareTouData(D,o,u,e,d.H5d.COST,d.uRV.COST,m),this.prepareTierData(D,o,d.uRV.COST),this.prepareNonTierTouData(D,o,U,Y,d.H5d.COST,!0,m)}N&&!m&&o.push(N);break;case d.H5d.USAGE:if(s&&D.solarData&&Object.keys(D.solarData).forEach((function(e){var t=d.Rxt[e].color,s=l==d.LPx.AREA;!(0,f.qc)(D.solarData[e])&&("estimatedSolar"!==e||!(0,v.oF)(i.props.session.userProfile.userType))&&o.push({name:g["SOLAR.LEGEND_TEXT.".concat(e)],type:"estimatedSolar"===e?d.Rxt[e].graphStyle:l,data:(0,L.Z)(D.solarData[e]),enableMouseTracking:"estimatedSolar"!==e,borderWidth:0,color:"rgb(".concat(i.configColors[t],")"),minPointLength:3,lineWidth:s?0:2,stack:s?0:void 0})})),D){var Z=(0,f.pE)(D,e,d.uRV.ENERGY,!1);E&&!s?e===d.DEY.DAY?D.isFixedChargeApplicable.length<=24?(this.prepareTouData(D,o,u,e,d.H5d.USAGE,d.uRV.ENERGY),this.prepareTierData(D,o,d.uRV.ENERGY)):this.prepareNonTierTouData(D,o,y,Z,d.H5d.USAGE,E):(this.prepareTouData(D,o,u,e,d.H5d.USAGE,d.uRV.ENERGY),this.prepareTierData(D,o,d.uRV.ENERGY),this.prepareNonTierTouData(D,o,y,Z,d.H5d.USAGE,E)):(Z=(0,L.Z)(D["data"+(0,v.LF)(e)+d.uRV.ENERGY]),this.prepareNonTierTouData(D,o,y,Z,d.H5d.USAGE,E))}T&&!s&&o.push(T)}return o}}},{key:"prepareDemandChargeSeries",value:function(e){var t=[],i=(0,f._6)(e);return(0,f.qc)(i)||t.push({name:this.props.widgetStrings.peakDemand,type:d.RPR.GRAPH_TYPE,data:i,marker:{symbol:"circle",lineWidth:2,lineColor:"rgb(".concat(this.configColors[d.RPR.COLOR],")"),fillColor:"rgb(".concat(this.configColors[d.RPR.FILL_COLOR],")")},color:"rgb(".concat(this.configColors[d.RPR.COLOR],")")}),t}},{key:"prepareMaxDemandGraphSeries",value:function(e){var t,i=[],s=(0,f.Lh)(e);return t=(0,f.vq)(s),(0,f.qc)(s)||i.push({name:this.props.widgetStrings.maxDemand,type:d.ukd.GRAPH_TYPE,data:s,step:!0,marker:{enabled:!1},color:"rgb(".concat(this.configColors[d.ukd.COLOR],")")}),t.length&&i.push({name:this.props.widgetStrings.maxDemandUnavailable,type:d.ukd.GRAPH_TYPE,data:t,marker:{enabled:!1},dashStyle:"dot",color:"rgb(".concat(this.configColors[d.ukd.UNAVAILABLE_COLOR],")")}),i}},{key:"navigateToShc",value:function(e,t){this.context.rc.analytics.trackEvent(d.FiA.INSIGHTS,{clicked:d.CoK,tab:d.Q2X.USAGE,widget:d.wY4.INSIGHTS.USAGE,version:d.zZZ.V2}),this.context.rc.analytics.trackGtmEvent("action-click",{pageName:d.FiA.INSIGHTS,clicked:d.CoK}),(0,v.yp)()||(0,A.K2)(t)?window.open(t):(0,A.m3)(V.Z$.INSIGHTS_USAGE,this.props.history,this.props.location,e,t)}},{key:"getLiveAnnouncerMsg",value:function(e,t,i,s){var a;return e.isChartLoading?a=this.props.widgetStrings.dataLoading:!e.isChartLoading&&s?a=(0,f.Hh)(i,t):e.isChartLoading||s||(a=(0,v.Z7)(t["DASHBOARD.USAGE_INSIGHTS.DATA.ADA_DESC"],{view:i.view,mode:i.mode,interval:this.props.intervalDetails})),a}},{key:"prepareTouData",value:function(e,t,i,s,a,o){var n=this,r=this.props.insightsUsageV2Data.insightUsageV2Controls.graphStyle;e.touData&&!(0,f.o9)(e.touData)&&(i!==d.NMd.ALL.type&&s!==d.DEY.DAY&&t.push({name:this.props.widgetStrings.otherAppliances,type:r,data:(0,f.cK)(a,i,e,null,s),borderWidth:0,color:"rgb(".concat(this.configColors[d.NA.COLOR],")")}),Object.keys(d.NMd).map((function(s){var a="data"+d.NMd[s].itemizationKey+o;return s===d.NMd.ALL.type||(0,f.qc)(e.touData[a])||t.push({name:n.getTouLabel(s),type:r,data:(0,L.Z)(e.touData[a]),borderWidth:0,color:"rgb(".concat(n.configColors[d.NMd[s].color],")"),visible:i===d.NMd.ALL.type||i===d.NMd[s].type}),t})))}},{key:"prepareTierData",value:function(e,t,i){var s=this,a=this.props.insightsUsageV2Data.insightUsageV2Controls.graphStyle;e.tierData&&!(0,f.o9)(e.tierData)&&Object.keys(d.ccv).map((function(o){return(0,f.qc)(e.tierData["dataTier"+o+i])||t.push({name:s.getTierLabel(o),type:a,data:(0,L.Z)(e.tierData["dataTier"+o+i]),borderWidth:0,color:"rgb(".concat(s.configColors[d.ccv[o].color],")")}),t}))}},{key:"prepareNonTierTouData",value:function(e,t,i,s,a,o){var n=this.props.insightsUsageV2Data,r=n.insightUsageV2Controls.graphStyle,l=n.insightUsageV2Controls,c=this.props.isSolar,p=(0,v.rK)(this.props.widgetConfigs,c),h=this.props.widgetStrings.applianceTotal;if(c?h=this.props.widgetStrings.applianceTotalSolar:p&&a===d.H5d.COST&&l.mode===d.DEY.YEAR&&(h=this.props.widgetStrings.energyCharges),c||a===d.Q2X.USAGE||e.isFixedChargeApplicable&&-1!==e.isFixedChargeApplicable.findIndex((function(e){return!0===e}))&&i)return(0,f.qc)(s)||t.push({name:h,type:r,data:s,borderWidth:0,lineWidth:0,color:"rgb(".concat(this.configColors["--data_colors_graph_primary"],")")}),t}},{key:"getChartDisclaimer",value:function(e,t,i,s,a){var o,n=this.props.widgetStrings.chartTopDisclaimer,r=this.props.insightsUsageV2Data.insightUsageV2Controls,l=(0,f.zl)(this.props.widgetConfigs),c=this.props.translations.data;if(e===d.H5d.APPLIANCE)o=a?n.applianceSolar:n.appliance;else if(e===d.H5d.COST)o=n.cost,o=(o=i?o.fixed:s?o.tou:o.tier)[t.toLowerCase()];else if(o=(o=a?n.usageSolar:n.usage)[t.toLowerCase()],"day"==t.toLowerCase()&&(0,f.Di)(r,l)){var p=r.granularity||60,h=a?n.usageSolar.dayGranularity:n.usage.dayGranularity;o=(0,v.Z7)(h,{duration:c["INSIGHTS.USAGE.GRANULARITY.".concat(p)]})}return o}},{key:"handleTouLinkAndDialog",value:function(e,t){this.context.rc.analytics.trackEvent(d.FiA.INSIGHTS,{clicked:t.label,tab:d.Q2X.USAGE,widget:d.wY4.INSIGHTS.USAGE,version:d.zZZ.V2}),this.context.rc.analytics.trackGtmEvent("action-click",{pageName:d.FiA.INSIGHTS,clicked:d.CoK}),"RatePlanDialog"===t.dialog?this.handleRatePlanDialog():(0,v.yp)()||(0,A.K2)(t.link)?window.open(t.link):(0,A.m3)(V.Z$.INSIGHTS_USAGE,this.props.history,this.props.location,e,t.link)}},{key:"render",value:function(){var e=this,t=this.props,i=t.widgetName,a=t.insightsUsageV2Data,o=t.billProjectionData,n=t.isMobileView,r=t.configs,l=t.isSolar,p=t.widgetConfigs,g=(0,f.zl)(p),u=a.insightUsageV2Controls,A=this.props.translations.data,S=a.disclaimers,m=a.insightsUsageV2ChartData[u.mode].apiResponse,E=!(0,f.Ud)(u,m,a.yearOffset,this.showOtherModesForAppliance,(0,f.xB)(this.context.rc,this.props.configs))||a.apiError,b=a.isChartLoading||a.apiError||!a.isChartLoading&&E,D=this.props.widgetConfigs.showDemandCharge&&(0,f.zm)(m,a.yearOffset,u.view,u.mode),w=this.props.widgetConfigs.showMaxDemandCharge,I=this.props.widgetStrings.maxDemandGraphDisclaimer;w=w&&(0,f.Ym)(m,u.view,u.mode);var T=this.getPeakDemandDisclaimer(u.mode),N=this.props.widgetStrings.surveyPrompt,U=(0,v.sE)(r,this.props.session.userProfile.userType),y=(0,f._y)(o,m,u.view,u.mode.toUpperCase()),x=this.getHighchartsOptions(d.UEz.DEMAND_CHARGE,!1,b),G=u.mode!==d.DEY.YEAR&&u.view===d.H5d.COST,L=(0,v.Kn)(this.props.session,r),V=this.getHighchartsOptions(d.UEz.MAX_DEMAND_GRAPH,!1,b),Y=p.shcNavUrl,Z=this.context.runMode===d.K8z,_=p.ctaEnabled,j=L&&-1!==L.indexOf("shc"),F=!Z&&(_||j)||Z&&Y,B=this.getChartDisclaimer(u.view,u.mode,u.isFixedRatePlan,u.isTouDataPresent,l),W=u.isDemandChargeDataPresent,K=(0,v.rK)(p,l);B=K&&u.view!==d.H5d.USAGE?"":B;var z=null,q=u.mode,Q="";if((u.view===d.H5d.COST||u.view===d.H5d.APPLIANCE&&(0,f.xB)(this.context.rc,this.props.configs)===d.AgQ.COST)&&(Q=W?this.props.widgetStrings.demandChargeDisclaimer:this.props.widgetStrings.billChargeDisclaimer,Q+=u.view===d.H5d.COST&&u.isTouDataPresent?this.getTouDisclaimer(u.mode):""),K)if(u.view===d.H5d.APPLIANCE)Q=this.props.widgetStrings.fullBillChargesApplianceDisclaimer,this.showOtherModesForAppliance&&(u.mode===d.DEY.MONTH?Q=this.props.widgetStrings.fbChargesApplianceMonthDisclaimer:u.mode===d.DEY.DAY&&(Q=this.props.widgetStrings.fbChargesApplianceDayDisclaimer));else if(u.view===d.H5d.COST&&u.mode===d.DEY.YEAR)Q=this.props.widgetStrings.fullBillChargesCostYearDisclaimer;else if(u.view===d.H5d.COST&&u.mode===d.DEY.MONTH){var $=a.insightsUsageV2ChartData[u.mode].billCycleData;z=(0,f.a8)($,A),Q=this.props.widgetStrings.fullBillChargesCostMonthDisclaimer}else u.view===d.H5d.COST&&u.mode===d.DEY.DAY&&(Q=this.props.widgetStrings.fullBillChargesCostDayDisclaimer);var X="";(0,v.tk)(this.props.session.userTypeDetails.measurementToUserTypeMappings,this.props.configs)&&(X+="fuel-type=".concat(this.props.session.userProfile.fuelType)),Q=(0,v.Z7)(Q,{QUERY_PARAMS:X});var J="",ee=this.state.totalConsumption;if(u.view===d.H5d.USAGE&&l){var te="INSIGHTS.USAGE.SUB_CHART_DISCLAIMER.SOLAR."+u.mode.toUpperCase();J=A[te+=ee<0?".EXPORT":""];var ie=[{key:"{netGridConsumption}",value:ee=(0,v.ub)({usage:Math.abs(ee),showUsageUnit:!0,fuelType:this.props.session.userProfile.fuelType})}];J=(0,v.$j)(J,ie)}var se=a.autoVoiceOver?this.getLiveAnnouncerMsg(a,A,u,E):"";x.responsive={rules:[{condition:{maxWidth:800},chartOptions:{chart:{height:"auto"}}},{condition:{maxWidth:480},chartOptions:{legend:{itemStyle:{fontSize:"12px",width:120},align:"center",verticalAlign:"bottom",layout:"horizontal",alignColumns:!0,itemWidth:160,width:"auto",padding:3,itemMarginTop:0,itemMarginBottom:20}}},{condition:{maxWidth:320},chartOptions:{legend:{itemStyle:{fontSize:"12px",width:100},align:"center",verticalAlign:"bottom",layout:"horizontal",alignColumns:!0,itemWidth:120,width:"auto",padding:3,itemMarginTop:0,itemMarginBottom:20}}}]};var ae=this.getHighchartsOptions(d.UEz.USAGE,D,b),oe=d.H5d.APPLIANCE===a.insightUsageV2Controls.view&&ae&&ae.series&&1===ae.series.length&&ae.series[0].name===d.IXo.NAME;ae.responsive={rules:[{condition:{maxWidth:800},chartOptions:{chart:{height:"auto"}}},{condition:{maxWidth:480},chartOptions:{chart:{animation:!1,height:440},legend:{itemStyle:{fontSize:"12px",width:G?140:100},align:"center",verticalAlign:"bottom",layout:"horizontal",alignColumns:!0,itemWidth:120,width:"auto",padding:3,itemMarginTop:10,itemMarginBottom:10}}},{condition:{maxWidth:320},chartOptions:{chart:{animation:!1,height:440},legend:{itemStyle:{fontSize:"12px",width:140},align:"center",verticalAlign:"bottom",layout:"horizontal",alignColumns:!0,itemWidth:160,width:"auto",padding:3,itemMarginTop:10,itemMarginBottom:10}}}]},(Z||(0,v.yp)())&&(Q=Q.replace("<a",'<a style="pointer-events: none;cursor: default;"'));var ne=(0,v.ib)(a.touUser)&&d.H5d.USAGE!==a.insightUsageV2Controls.view,re=ne&&a.insightUsageV2Controls.view?JSON.parse(r["INSIGHTS.USAGE.".concat(a.insightUsageV2Controls.view,".TOU_CTA")]):"",le=(0,P.Bt)(a.ratePlanImageData);return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsxs)("div",(0,s.Z)((0,s.Z)({className:"insights-usage-content ".concat(n?" mobile-view":"","\n              ").concat((0,v.wG)()?"usage-color-accessible":"")},(0,v.IR)()?{role:"group"}:{}),{},{children:[(0,C.jsx)(H.Z,{msg:se}),a.isChartLoading&&(0,C.jsx)("div",{className:"insight-content-loading","data-widget-name":i,"data-bg-color":"background_300",children:(0,C.jsx)(h.Z,{})}),(0,C.jsxs)("div",{"data-widget-name":i,"data-show-appliances-colors":"true","data-graph-label-color":"foreground_400",children:[N&&(0,C.jsx)("div",{className:"usage-chart-disclaimer-v2",children:N}),D&&!w&&(0,C.jsxs)(c.Fragment,{children:[(0,C.jsx)("div",{className:"usage-chart-disclaimer-v2",children:T}),(0,C.jsx)(O.Z,{controller:this.props.controller,options:x,immutable:!0})]}),w&&(0,C.jsxs)(c.Fragment,{children:[(0,C.jsx)("div",{className:"usage-chart-max-demand-disclaimer-v2",children:I}),(0,C.jsx)(O.Z,{controller:this.props.controller,options:V,immutable:!0})]}),!b&&(0,C.jsxs)("div",{onClick:function(t){return e.handleLinkClick(t)},className:"usage-chart-disclaimer-v2 "+(y?"bp-shown":""),children:[B,!n&&(0,C.jsx)("span",{dangerouslySetInnerHTML:{__html:Q}}),n&&Q&&(0,C.jsx)(k.q,{arrow:!1,placement:"top",interactive:!0,title:(0,C.jsx)("span",{dangerouslySetInnerHTML:{__html:Q}}),configColors:this.configColors,name:"\u24d8"}),l&&!a.isChartLoading&&(0,C.jsx)("p",{className:"usage-chart-sub-disclaimer-v2",dangerouslySetInnerHTML:{__html:J}})]}),z&&z.totalText&&z.dpTxtArr.length&&(0,C.jsxs)("div",{className:"usage-chart-bill-cycle-calc",children:[(0,C.jsx)("strong",{children:z.totalText}),(0,C.jsxs)("span",{children:[" ( ",z.dpTxtArr.join(" + ")," )"]})]}),y&&U&&(0,C.jsx)("div",{className:"usage-chart-projection",children:(0,C.jsx)("p",{dangerouslySetInnerHTML:{__html:(o.data.projectionPrice?(0,v.Z7)(A["DASHBOARD.USAGE.PROJECTED_BILL"],{projectedBill:(0,v.xB)({cost:o.data.projectionPrice,showCurrency:!0})}):"")+" "+(o.data.budgetThresholdAmount?(0,v.Z7)(A["DASHBOARD.USAGE.BUDGET"],{budget:(0,v.xB)({cost:o.data.budgetThresholdAmount,showCurrency:!0})}):"")}})}),a.isChartLoading||!E&&!oe?"":(0,C.jsx)("div",{className:"usage-data-not-available".concat(n?" mobile-view":""),"data-widget-name":i,"data-bg-color":"background_300",tabIndex:0,children:(0,f.Hh)(u,A,g)}),!a.isChartLoading&&!E&&a.apiError&&(0,C.jsx)("div",{className:"api-error-message usage-v2","data-widget-name":d.wY4.INSIGHTS.USAGE,"data-text-color":"foreground_500",tabIndex:0,children:this.props.widgetStrings.apiError}),(0,C.jsx)(O.Z,(0,s.Z)({controller:this.props.controller,options:ae,immutable:!0,liveAnnouncerMsg:se,fuelType:this.props.session.userProfile.fuelType,billProjectionData:this.props.billProjectionData,userId:this.props.session.userProfile.userId,fetchInsightsUsageData:this.props.fetchInsightsUsageData,checkdisclaimer:T,chartDisclaimer:B,billChargesDisclaimer:Q,isModalTableEnabled:this.props.isModalTableEnabled,isInsights:!0,handleADA:this.props.handleADA,widgetName:i,enableLeftArrow:this.props.enableLeftArrow,enableRightArrow:this.props.enableRightArrow,intervalDetails:this.props.intervalDetails,handleArrowClick:this.props.handleArrowClick,isApplianceSelectionEnabled:this.props.isApplianceSelectionEnabled,isModeSelectionEnabled:this.props.isModeSelectionEnabled,setFilterAnchorEl:this.props.setFilterAnchorEl,usageType:a.insightUsageV2Controls.view===d.H5d.USAGE||a.insightUsageV2Controls.view===d.H5d.APPLIANCE&&(0,f.xB)(this.context.rc,this.props.configs)===d.AgQ.ENERGY?d.AgQ.USAGE:d.AgQ.COST,adaModalTitle:this.props.showHeader?A["INSIGHTS.USAGE.TOP_HEADER"]:A["INSIGHTS_MENU_ITEM.USAGE"],errorMessage:(0,f.Hh)(u,A,g),disclaimerUsage:S,dataUnavailable:E||oe,isChartLoading:a.isChartLoading,mode:q},this.props)),!a.isChartLoading&&(0,C.jsxs)("div",{className:"insightsv2-usage-chart-btn-cont",children:[F&&(0,C.jsx)(R.Z,{btnVariant:"outlined",tabIndex:b?"-1":"0",btnText:this.props.widgetStrings.btnShc,disableRipple:!0,btnBackground:"rgb(".concat(this.configColors["--background_300"],")"),borderColor:"".concat(((0,v.wG)(),"rgb(".concat(this.configColors["--primary_500"],")"))),textColor:"".concat(((0,v.wG)(),"rgb(".concat(this.configColors["--primary_500"],")"))),hoverColor:"rgb(".concat(this.configColors["--background_300"],")"),btnTextTransform:"none",onClick:function(t){return e.navigateToShc(t,Y)}}),ne&&(0,C.jsx)("div",{className:"".concat(F&&ne?"tou-cta":""),children:(0,C.jsx)(R.Z,{btnVariant:"outlined",tabIndex:b?"-1":"0",btnText:re.label,disableRipple:!0,btnBackground:"rgb(".concat(this.configColors["--background_300"],")"),borderColor:"".concat(((0,v.wG)(),"rgb(".concat(this.configColors["--primary_500"],")"))),textColor:"".concat(((0,v.wG)(),"rgb(".concat(this.configColors["--primary_500"],")"))),hoverColor:"rgb(".concat(this.configColors["--background_300"],")"),btnTextTransform:"none",onClick:function(t){return e.handleTouLinkAndDialog(t,re)}})})]}),(0,C.jsx)("div",{className:"insights-usage-disclaimer-cont",children:!a.isChartLoading&&S.length>0&&S.map((function(e){return(0,C.jsxs)("p",{className:"insights-usage-disclaimer-text",children:[A[d.F0k[e].icon]," ",A[d.F0k[e].id]]},e)}))})]})]})),(0,C.jsx)(M.Z,{ratePlanDialogData:le,widgetStrings:this.props.widgetStrings,isMobileView:n,open:this.state.showRatePlanDialog,handleClose:this.handleRatePlanDialog})]})}}]),i}(c.Component);Y.contextType=D.zO;var Z=(0,p.$j)((function(e){return{session:e.session,configs:e.configs.data,translations:e.translationsData,applianceList:e.appliances.appliancesList}}),(function(e){return{setDetectedAppliances:function(t){return e((0,u.nh)(t))},updateArrowsState:function(t){return e((0,u.mR)(t))},updateOffset:function(t){return e((0,u.b7)(t))}}}))(Y),_=i(69099),j=i(63669),F=i(61120),B=i(7745);function W(e){var t=e.translations,i=g.V.getColors().colors,s=JSON.parse(e.widgetConfigs.solarPeakInfo);return(0,C.jsxs)("div",{className:"solar-tou-info-content",children:[(0,C.jsxs)("div",{className:"tou-info-header","data-text-color":"foreground_400",children:[(0,C.jsx)("div",{className:"tou-info-title",children:e.widgetStrings.title}),(0,C.jsx)("div",{className:"tou-info-subtitle",children:e.widgetStrings.subTitle})]}),(0,C.jsxs)("div",{className:"solar-tou-info-wrapper",children:[(0,C.jsx)("div",{className:"tou-info-unit",children:e.widgetStrings.rateUnit}),(0,C.jsx)("div",{className:"rate-items",children:s.map((function(e){return(0,C.jsxs)("div",{className:"tou-info-item",children:[(0,C.jsx)("div",{children:t["INSIGHT_USAGE.SOLAR.TOU.INFO.".concat(e.peakId)]}),(0,C.jsx)("div",{children:t["INSIGHT_USAGE.SOLAR.TOU.INFO.".concat(e.peakId,".TIME")]}),(0,C.jsx)("div",{className:"tou-info-rate",style:{backgroundColor:"rgb(".concat(i["--"+e.color],")")},children:e.rate})]},e.peakId)}))})]})]})}var K=i(61939),z=i(21911),q=function(e){(0,r.Z)(i,e);var t=(0,l.Z)(i);function i(e){var s;return(0,a.Z)(this,i),(s=t.call(this,e)).widgetTrackingInfo=void 0,s.filterAnchorEl=void 0,s.state={openFilter:!1,isModalTableEnabled:!1,currentRef:null,filterRef:null},s.isGraphStyleSelectionEnabled=s.isGraphStyleSelectionEnabled.bind((0,n.Z)(s)),s.isApplianceSelectionEnabled=s.isApplianceSelectionEnabled.bind((0,n.Z)(s)),s.isModeSelectionEnabled=s.isModeSelectionEnabled.bind((0,n.Z)(s)),s.isRateSelectionEnabled=s.isRateSelectionEnabled.bind((0,n.Z)(s)),s.isDemandChargeSelectionEnabled=s.isDemandChargeSelectionEnabled.bind((0,n.Z)(s)),s.getDetectedAppliances=s.getDetectedAppliances.bind((0,n.Z)(s)),s.handleFilterModal=s.handleFilterModal.bind((0,n.Z)(s)),s.onUpdateFilter=s.onUpdateFilter.bind((0,n.Z)(s)),s.fetchInsightsUsageData=s.fetchInsightsUsageData.bind((0,n.Z)(s)),s.handleArrowClick=s.handleArrowClick.bind((0,n.Z)(s)),s.setFilterAnchorEl=s.setFilterAnchorEl.bind((0,n.Z)(s)),s.filterAnchorEl=null,s.handleADA=s.handleADA.bind((0,n.Z)(s)),s.onViewChange=s.onViewChange.bind((0,n.Z)(s)),s}return(0,o.Z)(i,[{key:"componentDidMount",value:function(){this.widgetTrackingInfo=this.context.rc.analytics.createWidgetInfo(d.xDZ.INSIGHTS_USAGE,"V2");var e=(0,A.xu)(this.props.location),t=this.props.insightsUsageV2Data.insightUsageV2Controls,i=this.getInsightsUsageView(e),s=(0,f.qx)(this.context.rc,this.props.session.userProfile,this.props.configs),a=(0,f.nT)(this.context.rc,this.props.session.userProfile,this.props.configs),o=s.indexOf(a)||0,n=e&&e.usageMode&&(0,f.F3)(e.usageMode,i,s,this.props.session,this.props.insightsUsageV2Data.touUser)?(0,v.LF)(e.usageMode):-1!==o&&i!==d.H5d.APPLIANCE?(0,v.LF)(s[o]):t.mode,r=e&&e.appId?e.appId:null,l=t.granularity;!l&&this.props.widgetConfigs.supportedGranularities&&(l=JSON.parse(this.props.widgetConfigs.supportedGranularities)[0],this.props.updateControl({granularity:l})),r&&this.props.updateControl({selectedAppliance:r});var c=e&&e.billStart?e.billStart:"",p=e&&e.billEnd?e.billEnd:"",h=e&&e.appId?e.appId:"";this.fetchInsightsUsageData(n,i,c,p,!1,l,h),(0,v.sE)(this.props.configs,this.props.session.userProfile.userType)&&!this.props.billProjectionData&&this.props.fetchBillProjectionData(this.context.rc,this.props.session.userProfile.userId,{dateFormat:this.props.widgetConfigs.dateFormat,templateName:null,locale:this.props.locale,computeLastYear:!1,measurementType:this.props.session.userProfile.fuelType}),this.context.rc.analytics.trackEvent(d.FiA.INSIGHTS,{viewed:!0,shown:d.Q2X.USAGE,version:d.zZZ.V2},this.props)}},{key:"componentDidUpdate",value:function(e){if(this.widgetTrackingInfo&&e.insightsUsageV2Data.isChartLoading&&!this.props.insightsUsageV2Data.isChartLoading){var t=this.props.insightsUsageV2Data.apiError?d.WW8.ERROR:(0,f.TW)(this.props.insightsUsageV2Data)?d.WW8.SUCCESS:d.WW8.DATA_NOT_AVAILABLE,i=this.props.insightsUsageV2Data.errorInfo;this.context.rc.analytics.logWidgetInfo(this.widgetTrackingInfo,t,i),this.widgetTrackingInfo=null}if(this.props.insightsUsageV2Data&&this.props.location!==e.location&&this.props.history.action===d.Txz.POP){var s=(0,A.xu)(this.props.location,!1),a={},o=s.appId||d.N$L;a.selectedAppliance=o,s.usageMode&&(a.mode=d.DEY[s.usageMode]),s.usageView&&(a.view=s.usageView),(0,v.Qr)(a)||this.props.updateControl(a)}}},{key:"getInsightsUsageView",value:function(e){var t=this.props.insightsUsageV2Data.insightUsageV2Controls.view;if(e.usageView||!t){var i=(0,f.qE)(this.context.rc,this.props.session,this.props.configs),s=(0,f.nA)(this.context.rc,this.props.session.userProfile,this.props.configs),a=s?i.indexOf(s):0;a=a<0?0:a,t=e&&e.usageView&&-1!==i.indexOf(e.usageView)?e.usageView:i[a]}return t}},{key:"fetchInsightsUsageData",value:function(e,t,i,s){var a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=arguments.length>5?arguments[5]:void 0,n=arguments.length>6?arguments[6]:void 0;if(t&&(this.props.updateControl({view:t}),this.context.runMode!==d.K8z))if(t===d.H5d.APPLIANCE){var r=this.props.insightsUsageV2Data.insightUsageV2Controls.prevSelectedAppliance,l=e!==d.DEY.YEAR?d.N$L:r||d.N$L;l=n||l,this.props.updateControl({selectedAppliance:l,prevSelectedAppliance:this.props.insightsUsageV2Data.insightUsageV2Controls.selectedAppliance}),this.props.history.push((0,A.UM)(this.props.location,[{name:"usage-view",value:t},{name:"usage-mode",value:e.toUpperCase()},{name:"app-id",value:l}]))}else this.props.history.push((0,A.UM)(this.props.location,[{name:"usage-view",value:t},{name:"usage-mode",value:e.toUpperCase()}]));this.props.updateControl({mode:e});var c=(0,f.aj)(this.props.insightsUsageV2Data),p=this.props.widgetConfigs.showMinuteUsage,h=this.props.configs["INSIGHTS.APPLIANCE.SHOW_OTHER_MODES"],g=this.context.rc.session.isSolarUser(),u=this.props.widgetConfigs.skipOngoingBC&&t!==d.H5d.USAGE||g&&t===d.H5d.APPLIANCE&&!h;t===d.H5d.USAGE&&(u=this.props.widgetConfigs.skipOngoingBcUsage);var S=e===d.DEY.DAY&&p&&t==d.H5d.USAGE,m=t||this.props.insightsUsageV2Data.insightUsageV2Controls.view,E=this.props.widgetConfigs.supportedGranularities?JSON.parse(this.props.widgetConfigs.supportedGranularities):[],C=(0,f.Di)({mode:e,view:m},E),b={"measurement-type":(0,v.nY)(this.props.session.userProfile.fuelType),mode:e.toLowerCase(),start:i||c.start,end:s||c.end,"date-format":c.dateFormat,locale:this.props.locale,"next-bill-cycle":a,"show-at-granularity":S,"skip-ongoing-cycle":u};if(C){var D=o||this.props.insightsUsageV2Data.insightUsageV2Controls.granularity;b.granularity=D}this.props.usageChartLoading(),this.props.fetchItemizationDetails(this.context.rc,this.props.session.userProfile.userId,b)}},{key:"handleArrowClick",value:function(e){var t=this.props.insightsUsageV2Data.insightUsageV2Controls.mode,i=this.props.insightsUsageV2Data.insightsUsageV2ChartData[t].apiResponse,s=this.props.insightsUsageV2Data.insightUsageV2Controls.view;if(t===d.DEY.YEAR)this.props.updateOffset(e);else if(i)if(t===d.DEY.MONTH){var a=1===e?i[i.length-1].intervalEnd+d.RPu/2+1:i[0].intervalStart-d.RPu/2,o=1===e?i[i.length-1].intervalEnd+d.RPu/2:i[0].intervalStart-d.RPu/2+1;this.fetchInsightsUsageData(t,s,a,o,1===e)}else if(t===d.DEY.DAY){var n=1===e?i[0].intervalStart+d.RPu:i[0].intervalStart-d.RPu,r=1===e?i[i.length-1].intervalEnd+d.RPu:i[i.length-1].intervalEnd-d.RPu;this.fetchInsightsUsageData(t,s,n,r,1===e)}this.context.rc.analytics.trackEvent(d.FiA.INSIGHTS,{clicked:d.YyL,shown:d.Q2X.USAGE,direction:1===e?d.JYL.RIGHT:d.JYL.LEFT,widget:d.wY4.INSIGHTS.USAGE,version:d.zZZ.V2}),this.context.rc.analytics.trackGtmEvent("action-click",{pageName:d.FiA.INSIGHTS,click:d.YyL,direction:1===e?d.JYL.RIGHT:d.JYL.LEFT})}},{key:"setFilterAnchorEl",value:function(e){this.filterAnchorEl=e}},{key:"handleFilterModal",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i={openFilter:e};this.setState(i),t&&this.setState({filterRef:t})}},{key:"onUpdateFilter",value:function(e,t){var i=this.props.insightsUsageV2Data.insightUsageV2Controls,s=e.view,a=e.graphStyle,o=e.selectedAppliance,n=e.mode,r=e.timeOfUse,l=i.mode,c=i.view,p=i.selectedAppliance;if(s!==i.view){if(this.props.updateControl({view:s,graphStyle:a,selectedAppliance:o,mode:n,timeOfUse:r}),this.fetchInsightsUsageData(n,s),this.context.runMode!==d.K8z){var h=s===d.H5d.APPLIANCE&&n!==d.DEY.YEAR;this.props.updateControl({selectedAppliance:h?d.N$L:o}),this.props.history.push((0,A.UM)(this.props.location,[{name:"usage-view",value:s},{name:"usage-mode",value:n.toUpperCase()},{name:"app-id",value:h?d.N$L:o}]))}}else o!==i.selectedAppliance?(this.props.updateControl({graphStyle:a,selectedAppliance:o,mode:n,timeOfUse:r}),this.context.runMode!==d.K8z&&this.props.history.push((0,A.UM)(this.props.location,[{name:"app-id",value:o}]))):a!==i.graphStyle?this.props.updateControl({graphStyle:a,mode:n,timeOfUse:r}):n!==i.mode?(this.props.updateControl({mode:n,timeOfUse:r}),this.fetchInsightsUsageData(n,s)):r!==i.timeOfUse&&this.props.updateControl({timeOfUse:r});this.props.updateControl({autoVoiceOver:!0}),this.setState({openFilter:!1}),this.context.rc.analytics.trackEvent(d.FiA.INSIGHTS,{clicked:d.GNf.USAGE_FILTER_TOGGLE,shown:d.Q2X.USAGE,mode:n,view:s,chart:"area"===a?"Stacked":"Bar",appliance:o,widget:d.wY4.INSIGHTS.USAGE,version:d.zZZ.V2}),p!==o&&this.context.rc.analytics.trackGtmEvent("action-click",{pageName:d.FiA.INSIGHTS,click:d.GNf.APPLIANCE_TOGGLE,applianceId:o}),t&&this.state.filterRef&&this.state.filterRef.focus(),l!==n&&this.context.rc.analytics.trackGtmEvent("action-click",{pageName:d.FiA.INSIGHTS,click:d.GNf.MODES_TOGGLE,mode:n}),c!==s&&this.context.rc.analytics.trackGtmEvent("action-click",{pageName:d.FiA.INSIGHTS,click:d.GNf.VIEWS_TOGGLE,view:s})}},{key:"isApplianceSelectionEnabled",value:function(e){return e===d.H5d.APPLIANCE}},{key:"isGraphStyleSelectionEnabled",value:function(){return!this.state.isModalTableEnabled}},{key:"isModeSelectionEnabled",value:function(e){return!!this.props.configs["INSIGHTS.APPLIANCE.SHOW_OTHER_MODES"]||e!==d.H5d.APPLIANCE}},{key:"isRateSelectionEnabled",value:function(e,t){var i=this.props.insightsUsageV2Data.insightUsageV2Controls,s=i.isTouDataPresent,a=i.isFixedRatePlan;return(e===d.H5d.COST||e===d.H5d.USAGE&&t)&&!a&&s}},{key:"isDemandChargeSelectionEnabled",value:function(e,t){var i=this.props.insightsUsageV2Data.insightUsageV2Controls,s=i.isDemandChargeDataPresent,a=i.isFixedRatePlan,o=i.timeOfUse,n=i.mode,r=o===d.u0K.TYPE&&n===d.DEY.YEAR;return(e===d.H5d.COST||e===d.H5d.USAGE&&t)&&!a&&(s||r)&&n===d.DEY.YEAR}},{key:"showFilterBtn",value:function(e,t){var i=this.isGraphStyleSelectionEnabled();if(i){var s=this.props.configs["INSIGHTS.USAGE.TIER_TOU.VIEW"]||!1;return this.isDemandChargeSelectionEnabled(t,s)||this.isRateSelectionEnabled(t,s)||i}return!1}},{key:"getDetectedAppliances",value:function(e){var t=(0,f.HT)(this.props.session.userProfile,this.props.configs),i=[],s=this.props.insightsUsageV2Data.insightsUsageV2ChartData[e].apiResponse;if(e===d.DEY.YEAR&&(s=(0,f.Jq)(s,this.props.insightsUsageV2Data.yearOffset)),!s)return[];var a=(0,f.Ot)(s,e,this.props.applianceList,null,null,null,this.props.configs),o=(0,f.xB)(this.context.rc,this.props.configs);return i.push(d.N$L),Object.keys(this.props.applianceList).forEach((function(e){var s=(0,f.Vb)(e,o);(0,f.qc)(a[s])||-1!==t.indexOf(e)&&i.push(e)})),i}},{key:"handleADA",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.setState({isModalTableEnabled:!this.state.isModalTableEnabled,currentRef:e&&e})}},{key:"getController",value:function(e,t,i){var s=this,a=this.props.responsiveness,o=a.isMobileView,n=a.isXLMobileView,r=this.props.insightsUsageV2Data,l=r.insightUsageV2Controls.mode,c=this.props.widgetConfigs.insightsFilterVersion===d.zZZ.V2;return(0,C.jsxs)(C.Fragment,{children:[(!o||n)&&(0,C.jsx)(G,{showFilterBtn:function(e,t){return s.showFilterBtn(e,t)},widgetName:d.wY4.INSIGHTS.USAGE,insightsUsageV2Data:r,allowedViews:e,filterLabel:this.props.widgetStrings.filterLabel,widgetConfigs:this.props.widgetConfigs,widgetStrings:this.props.widgetStrings.filterModal,intervalDetails:t,history:this.props.history,location:this.props.location,handleArrowClick:this.handleArrowClick,handleFilterModal:this.handleFilterModal,enableApplianceSelection:function(e){return s.isApplianceSelectionEnabled(e)},enableModeSelection:function(e){return s.isModeSelectionEnabled(e)},fetchInsightsUsageData:this.fetchInsightsUsageData,setFilterAnchorEl:this.setFilterAnchorEl,isShowADABtn:i,handleADA:this.handleADA,filterRef:this.state.filterRef,onViewChange:this.onViewChange}),o&&!n&&(0,C.jsx)("div",{className:"insights-mobile-controller",children:(0,C.jsx)(F.Z,{widgetName:d.wY4.INSIGHTS.USAGE,enableLeftArrow:this.props.insightsUsageV2Data.enableLeftArrow,enableRightArrow:this.props.insightsUsageV2Data.enableRightArrow,intervalDetails:t,handleArrowClick:this.handleArrowClick,handleModal:this.handleFilterModal,translations:this.props.translations,isShowADABtn:!0,previousBtnLabel:this.props.translations["DASHBOARD.INSIGHT_USAGE_INTERVAL.PREVIOUS_".concat(l.toUpperCase())],nextBtnLabel:this.props.translations["DASHBOARD.INSIGHT_USAGE_INTERVAL.NEXT_".concat(l.toUpperCase())],handleADA:this.handleADA,isMobileView:o,showViewTabs:c,allowedViews:e,onViewChange:this.onViewChange,controls:r.insightUsageV2Controls,isSolar:this.context.rc.session.isSolarUser(),widgetConfigs:this.props.widgetConfigs,widgetStrings:this.props.widgetStrings})})]})}},{key:"onViewChange",value:function(e){this.context.rc.analytics.trackEvent(d.FiA.INSIGHTS,{clicked:d.GNf.VIEWS_TOGGLE,view:e,widget:d.wY4.INSIGHTS.USAGE,version:d.zZZ.V2}),this.context.rc.analytics.trackGtmEvent("action-click",{pageName:d.FiA.INSIGHTS,click:d.GNf.VIEWS_TOGGLE,view:e});var t=this.props.insightsUsageV2Data.insightUsageV2Controls,i=t.view;if(e!==i){var s=t.mode;if(e===d.H5d.APPLIANCE)s=d.DEY.YEAR;else s=-1!==(0,f.qx)(this.context.rc,this.props.session.userProfile,this.props.configs).indexOf(s.toUpperCase())?s:d.DEY.YEAR;this.props.updateControl({view:e,mode:s,autoVoiceOver:!0});var a=this.props.insightsUsageV2Data.insightsUsageV2ChartData[s],o=a.apiResponse,n=a.timeRange,r=this.props.widgetConfigs.showMinuteUsage,l=this.props.widgetConfigs.skipOngoingBC||this.props.widgetConfigs.skipOngoingBcUsage,c=e===d.H5d.APPLIANCE||i===d.H5d.APPLIANCE,p=this.context.rc.session.isSolarUser(),h=s===d.DEY.DAY&&r&&(e==d.H5d.USAGE||e==d.H5d.COST);o&&!(l||h||p&&c)||this.fetchInsightsUsageData(s,e,n.start,n.end),this.context.runMode!==d.K8z&&this.props.history.push((0,A.UM)(this.props.location,[{name:"usage-view",value:e},{name:"usage-mode",value:s.toUpperCase()}]))}}},{key:"render",value:function(){var e=this,t=this.props,i=t.insightsUsageV2Data,a=t.configs,o=t.billProjectionData,n=t.translations,r=t.responsiveness,l=t.session,p=t.widgetConfigs,g=t.widgetStrings,u=r.isMobileView,A=r.isXLMobileView,S=this.context.runMode===d.K8z,m=i.insightUsageV2Controls,E=m.mode,b=this.context.rc.session.isSolarUser(),D=E!==d.DEY.YEAR&&m.timeOfUse===d.u0K.TYPE?(0,s.Z)((0,s.Z)({},m),{},{timeOfUse:d.NMd.ALL.type}):m,w=(0,f.qE)(this.context.rc,l,a),I=(0,f.qx)(this.context.rc,l.userProfile,a),T=i.enableLeftArrow,N=i.enableRightArrow,U=i.insightsUsageV2ChartData[D.mode].apiResponse,y=!i.isChartLoading&&!i.apiError&&(0,f.qy)(U,D.mode,i.yearOffset,a,u),x=p.showHeader,G=p.showSolarTouRates,L=g.adaIconLabel,O={insightsUsageV2Data:i,billProjectionData:o,userId:this.props.session.userProfile.userId,history:this.props.history,location:this.props.location};return(0,C.jsxs)("div",{className:"insightsv2-inner-container ".concat(u?"mobile-view":""),role:"region","aria-label":n["INSIGHTS_MENU_ITEM.USAGE"],children:[x&&!u&&(0,C.jsx)("div",{className:S?"widget-header-cont ".concat((0,v.jP)()?"no-bg":""):"insightsv2-usage-header-cont",children:(0,C.jsx)("span",{role:"heading","aria-level":2,className:"insightsv2-usage-header",children:g.title})}),((0,v.IR)()||x)&&u&&!A&&(0,C.jsxs)("div",{className:"insightsv2-ada-cta-mobile ".concat(S?"widget-header-cont ".concat((0,v.jP)()||!x?"no-bg":""):"insightsv2-usage-header-cont"),children:[(0,C.jsx)("div",{children:(0,C.jsx)("span",{role:"heading","aria-level":2,className:"insightsv2-usage-header",children:x&&g.title})}),(0,v.IR)()&&(0,C.jsx)("button",{className:"accessibility-cta insights-page ada-mobile","aria-label":L,onClick:function(){return e.handleADA()},children:(0,C.jsx)("span",{className:"bidgely-icon-accessibility"})})]}),(0,C.jsxs)("div",{className:"insightsv2-content ".concat(S&&!u?"web-component ".concat(x?"with-header":""):""),children:[i.isLoading&&(0,C.jsx)(h.Z,{}),!i.isLoading&&(0,C.jsxs)(c.Fragment,{children:[this.getController(w,y,!0),(0,C.jsxs)("div",{"aria-hidden":i.apiError,children:[(0,C.jsx)(Z,(0,s.Z)((0,s.Z)({},O),{},{widgetName:d.wY4.INSIGHTS.USAGE,isMobileView:u,fetchInsightsUsageData:this.fetchInsightsUsageData,isModalTableEnabled:this.state.isModalTableEnabled,handleADA:this.handleADA,intervalDetails:y,handleArrowClick:this.handleArrowClick,enableLeftArrow:T,enableRightArrow:N,isApplianceSelectionEnabled:this.isApplianceSelectionEnabled,isModeSelectionEnabled:this.isModeSelectionEnabled,setFilterAnchorEl:this.setFilterAnchorEl,allowedViews:w,isSolar:b,handleModal:this.handleFilterModal,showHeader:x,currentRef:this.state.currentRef,controller:this.getController(w,y,!1)},this.props)),(0,C.jsx)(B.Z,{widgetName:d.wY4.INSIGHTS.USAGE,isMobileView:u,isXLMobileView:A,enableGraphStyleSelection:this.isGraphStyleSelectionEnabled,enableApplianceSelection:this.isApplianceSelectionEnabled,enableModeSelection:function(t){return e.isModeSelectionEnabled(t)},enableRateSelection:this.isRateSelectionEnabled,enableDemandChargeSelection:this.isDemandChargeSelectionEnabled,getDetectedAppliances:this.getDetectedAppliances,isModalTableEnabled:this.state.isModalTableEnabled,allowedViews:w,allowedModes:I,applianceList:this.props.applianceList,widgetStrings:g.filterModal,open:this.state.openFilter,controls:D,handleModal:this.handleFilterModal,onUpdateFilter:this.onUpdateFilter,anchorEl:this.filterAnchorEl,configData:a,skipOngoingBC:p.skipOngoingBC,skipOngoingBcUsage:p.skipOngoingBcUsage,userTypeDetails:this.props.userTypeDetails,fetchInsightsUsageData:this.fetchInsightsUsageData,insightsUsageV2Data:i,isSolar:b,filterRef:this.state.filterRef,insightsFilterVersion:p.insightsFilterVersion}),G&&D.isTouDataPresent&&E===d.DEY.DAY&&b&&(0,C.jsxs)("div",{className:"solar-tou-info-container",children:[(0,C.jsx)("div",{className:"solar-separater"}),(0,C.jsx)(W,{translations:this.props.translations,widgetConfigs:p,widgetStrings:g.solarRateInfo,isSolar:b})]})]})]})]})]})}}]),i}(c.Component);q.contextType=D.zO;var Q=(0,K.$)(V.Z$.INSIGHTS_USAGE,(0,z.EN)((0,p.$j)((function(e){return{session:e.session,insightsUsageV2Data:e.insightsUsageV2Data,configs:e.configs.data,locale:e.configs.locale,translations:e.translationsData.data,applianceList:e.appliances.appliancesList,billProjectionData:e.billProjectionData,responsiveness:e.responsiveness}}),(function(e){return{updateOffset:function(t){return e((0,u.b7)(t))},updateControl:function(t){return e((0,u.WL)(t))},fetchItemizationDetails:function(t,i,s){return e((0,_.T6)(t,i,s))},fetchUsageChartSummary:function(t,i,s){return e((0,_.s0)(t,i,s))},usageChartLoading:function(){return e((0,u.e8)())},fetchBillProjectionData:function(t,i,s){return e((0,j.S)(t,i,s))}}}))(q)))}}]);