"use strict";(self.webpackChunkmeraki=self.webpackChunkmeraki||[]).push([[181],{77981:function(e,a,t){t.r(a),t.d(a,{default:function(){return le}});var s=t(15671),n=t(43144),i=t(97326),o=t(60136),r=t(98557),l=t(47313),c=t(1084),C=t(1413),p=t(93433),d=t(5845),g=t.n(d),S=t(61113),h=t(70178),f=t(70024),v=t(9019),u=t(70501),H=t(74832),I=t(14427),D=t(4942),m=t(26915),b=t(69140),E=t(16404),A=t(76720),M=t(83450),x=t(46417),T=(0,m.ZL)()((function(e,a){return{row:{padding:"10px 0"},rowSeparator:{borderBottom:"2px Dashed rgba(".concat(a.configColors["--background_500"],", 0.45)")},title:{color:"rgb(".concat(a.configColors["--foreground_500"],")"),fontWeight:E.m5g.bold,fontSize:"18px",marginBottom:"10px"},cell:{paddingLeft:"0",paddingRight:"0",fontSize:"16px",color:"rgb(".concat(a.configColors["--foreground_500"],")")},grid:{marginTop:"15px"},leftBlock:{color:"rgb(".concat(a.configColors["--foreground_500"],")"),fontSize:"16px"},unknown:{color:"rgb(".concat(a.configColors["--primary_500"],")"),cursor:"pointer",backgroundColor:"transparent",padding:0,fontSize:"16px","&:hover":{textDecoration:"underline"}},updateProfile:(0,D.Z)({textAlign:"right"},e.breakpoints.down("sm"),{textAlign:"center",marginTop:"10px"})}})),w=function(e){var a=(0,A.WS)(),t=T(e).classes,s=e.widgetStrings,n=e.shcData,i=a.runMode===E.K8z,o=e.surveySdkNavUrl,r=!i||i&&o,l=i?o:M.ce;return(0,x.jsx)(x.Fragment,{children:(0,x.jsxs)(v.ZP,{container:!0,spacing:2,className:t.grid,children:[(0,x.jsx)(v.ZP,{container:!0,direction:"row",justifyContent:"center",alignItems:"center",children:(0,x.jsx)(v.ZP,{item:!0,xs:12,children:(0,x.jsx)(S.Z,{component:"h3",className:t.title,"data-widget-name":E.wY4.INSIGHTS.SHC,"data-text-color":"foreground_500",children:s.shcComparisonTitle})})}),n.map((function(a,s){return(0,x.jsxs)(v.ZP,{container:!0,direction:"row",justifyContent:"center",alignItems:"center",className:"".concat(t.row," ").concat(t.rowSeparator),"data-widget-name":E.wY4.INSIGHTS.SHC,"data-border-color":"background_500",children:[(0,x.jsxs)(v.ZP,{item:!0,xs:6,sm:7,className:t.cell,"data-widget-name":E.wY4.INSIGHTS.SHC,"data-text-color":"foreground_500",children:[a.title,":"]}),(0,x.jsx)(v.ZP,{item:!0,xs:6,sm:5,align:"right",className:"".concat(t.cell),"data-widget-name":E.wY4.INSIGHTS.SHC,"data-text-color":"foreground_500",children:e.linkUnknownToSurvey&&(n=a.value,"Unknown"===n||"Inconnue"===n)?(0,x.jsx)("a",{href:l+(-1!==l.indexOf("?")?"&":"?")+"question-id="+a.questionId,className:t.unknown,onClick:function(t){return e.goToSurvey(t,l,a.questionId)},children:a.value}):(0,x.jsx)("span",{children:a.value})})]},s);var n})),r&&(0,x.jsxs)(v.ZP,{container:!0,direction:"row",justifyContent:"center",alignItems:"center",className:t.row,children:[(0,x.jsx)(v.ZP,{item:!0,xs:12,sm:7,children:(0,x.jsx)(S.Z,{component:"div",className:t.leftBlock,"data-widget-name":E.wY4.INSIGHTS.SHC,"data-text-color":"foreground_500",children:s.shcComparisonHelp})}),(0,x.jsx)(v.ZP,{item:!0,xs:12,sm:5,className:t.updateProfile,"data-widget-name":E.wY4.INSIGHTS.SHC,"data-text-color":"primary_500","data-border-color":"primary_500","data-hover-color":"background_300",children:(0,x.jsx)(b.Z,{btnText:s.btnTextSurvey,textColor:"rgb(".concat(e.configColors["--primary_500"],")"),borderColor:"rgb(".concat(e.configColors["--primary_500"],")"),onClick:function(a){return e.goToSurvey(a,i?o:M.ce)},hoverColor:"rgb(".concat(e.configColors["--background_300"],")")})})]})]})})},y=t(27507),_=t(97535),N=t(61120),k=t(75260),O=t(19615),L=t(7745),j=t(97240),R=t(56955),F=t(47131),G=t(11198),Y=null;function Z(e){var a=e.role||"dialog",t=(0,l.useRef)(null),s=e.widgetStrings.billChargesDisclaimerSHC||e.widgetStrings.billChargesDisclaimer;(0,l.useEffect)((function(){if(t.current&&e.isModal){var a;a=Array.from(t.current.querySelectorAll('button, a, input:not([type="hidden"]), h2, p,  select, textarea, [tabindex]:not([tabindex="-1"])')),(Y=a[0]).focus()}}),[e.open]);return(0,x.jsxs)("div",{onKeyDown:function(a){if((0,R.IR)()&&e.isModal){if(a.keyCode===E.nx.ESC)return a.preventDefault(),e.closeFooterDialog&&e.closeFooterDialog();if(t.current){var s=t.current,n=Array.from(s.querySelectorAll('button, a, h2, p,  input:not([type="hidden"]), select, textarea, [tabindex]:not([tabindex="-1"])')),i=n[0],o=n[n.length-1],r=Y,l=n.indexOf(Y);if(a.keyCode===E.nx.ARROW_RIGHT||a.keyCode===E.nx.ARROW_DOWN||a.keyCode===E.nx.TAB&&!a.shiftKey)return a.preventDefault(),r===o?(Y=i,i.focus()):(Y=n[l+1]).focus();if(a.keyCode===E.nx.ARROW_LEFT||a.keyCode===E.nx.ARROW_UP||a.keyCode===E.nx.TAB&&a.shiftKey)return a.preventDefault(),r===i?(Y=o,o.focus()):(Y=n[l-1]).focus()}}},role:"".concat(a),tabIndex:(0,R.IR)()?-1:0,className:"footer-dialog-info",ref:t,children:[e.isModal&&(0,x.jsx)(F.Z,{size:"small","aria-label":"close",className:"footer-close-icon-btn",onClick:e.closeFooterDialog,children:(0,x.jsx)(G.Z,{className:"footer-close-icon"})}),(0,x.jsxs)("div",{className:"header",id:e.headerId,role:"heading","aria-level":"3",children:[(0,x.jsx)("span",{className:"header-image ada-logo",title:"ADA Logo","aria-hidden":"true"}),e.widgetStrings.shcChartFaqLabel]}),(0,x.jsxs)("div",{className:"details container",children:[(0,x.jsx)("div",{className:"details",children:e.widgetStrings.shcChartFaqSubTitle}),e.widgetStrings.shcChartFaqQ1&&(0,x.jsx)("div",{className:"details",dangerouslySetInnerHTML:{__html:'<span class="details highlighted">'.concat(e.widgetStrings.shcChartFaqQ1,"</span>").concat(e.widgetStrings.chartFooter)}}),e.widgetStrings.shcChartFaqQ2&&(0,x.jsx)("div",{className:"details",dangerouslySetInnerHTML:{__html:'<span class="details highlighted">'.concat(e.widgetStrings.shcChartFaqQ2,"</span>").concat(s)}}),e.insightsSHData.userEvInfo.showEvData&&e.widgetStrings.shcChartFaqQ3?(0,x.jsx)("div",{className:"details ",dangerouslySetInnerHTML:{__html:'<span class="details highlighted">'.concat(e.widgetStrings.shcChartFaqQ3,"</span>").concat(e.widgetStrings.shcChartFaqEvInfo)}}):""]})]})}var P=t(88291),V=t(21629),U=t(96534),B=null,q=function(e){(0,o.Z)(t,e);var a=(0,r.Z)(t);function t(e){var n;return(0,s.Z)(this,t),(n=a.call(this,e)).openFooterDialog=function(){n.setState({openModal:!0}),B=n.footerEl.current},n.closeFooterDialog=function(){n.setState({openModal:!1}),B&&B.focus()},n.comparedToRef=l.createRef(),n.state={openFilter:!1,showShcComparison:!n.props.configs.data["DASHBOARD.INSIGHTS.MONTHLY_SUMMARY.HIDE_COMPARISON_DETAILS"],isModalTableEnabled:!1,currentRef:null,openModal:!1},n.footerEl=l.createRef(),n.configColors=O.V.getColors().colors,n.handleFilterModal=n.handleFilterModal.bind((0,i.Z)(n)),n.onUpdateFilter=n.onUpdateFilter.bind((0,i.Z)(n)),n.handleADA=n.handleADA.bind((0,i.Z)(n)),n}return(0,n.Z)(t,[{key:"UNSAFE_componentWillMount",value:function(){g().wrap(g().Axis.prototype,"getLinePath",(function(e,a){var t=e.call(this,a);if(this.options.arrowOnEnd){2===t.length&&(t=[].concat((0,p.Z)(t[0]),(0,p.Z)(t[1])));var s,n,i;return i=["L",(s=t[4])-3.5,(n=t[5])-3.5,"L",s,n,"L",s-3.5,n+3.5,"L",s,n],t.concat(i)}return t}))}},{key:"goToSurvey",value:function(e,a,t){e.preventDefault(),this.context.rc.analytics.trackEvent(E.FiA.INSIGHTS,{clicked:t?"Unknown":"Update Home Profile",tab:E.Q2X.SIMILAR_HOMES,questionId:t,widget:E.wY4.INSIGHTS.SHC}),a||(a=M.ce);var s="question-id=".concat(t),n=(0,R.cy)(this.props.configs.data);if((0,P.K2)(a))a+=(-1!==a.indexOf("?")?"&":"?")+s,window.open(a);else{if(t){var i=(0,P.mZ)(this.props.location.search,s);this.props.location.search=i?"?"+i:""}n?this.props.setSurveyV2Modal():(0,P.m3)(V.Z$.INSIGHTS_SIMILAR_HOMES,this.props.history,this.props.location,e,a)}}},{key:"goToRecommendations",value:function(e,a){this.context.rc.analytics.trackEvent(E.FiA.INSIGHTS,{clicked:E.YUf,tab:E.Q2X.SIMILAR_HOMES,widget:E.wY4.INSIGHTS.SHC}),(0,P.K2)(a)?window.open(a):(0,P.m3)(V.Z$.INSIGHTS_SIMILAR_HOMES,this.props.history,this.props.location,e,a)}},{key:"getDetectedApplianceIds",value:function(e,a){var t=[];return e&&e.forEach((function(e){a.shcEvEnabled&&e.id===E.jOc.EV||t.push(e.id)})),t}},{key:"toggleShcComparison",value:function(){var e=this;this.state.showShcComparison||setTimeout((function(){e.comparedToRef.current.scrollIntoView({behavior:"smooth",block:"nearest",inline:"start"})}),100),this.setState((function(e){return(0,C.Z)((0,C.Z)({},e),{},{showShcComparison:!e.showShcComparison})})),this.context.rc.analytics.trackEvent(E.FiA.INSIGHTS,{clicked:E.GNf.SHC_COMPARISON_TOGGLE,collapsed:!this.state.showShcComparison,widget:E.wY4.INSIGHTS.SHC})}},{key:"handleFilterModal",value:function(e){this.setState({openFilter:e})}},{key:"onUpdateFilter",value:function(e){this.props.onSHCRecoChange(e.selectedAppliance),this.setState({openFilter:!1})}},{key:"handleADA",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.setState({isModalTableEnabled:!this.state.isModalTableEnabled,currentRef:e&&e})}},{key:"handleLinkClick",value:function(e){return(0,P.ju)(e,this.props.session,this.props.configs.data,this.props.history)}},{key:"render",value:function(){var e=this,a=this.props,t=a.insightsSHData,s=a.changeDataToShowOffset,n=a.translations,i=a.applianceList,o=a.detectedAppliances,r=a.selectedAppliance,l=a.enableApplianceSHC,c=a.configColors,p=a.isMobileView,d=a.isCostMode,g=a.fuelType,D=a.configs,m=a.widgetConfigs,A=a.widgetStrings,T={selectedAppliance:r},O=D.data["dashboard.top_menu_items"],F=m.showHeader,G=m.recoNavUrl,Y=m.hideComparison,P=m.surveyNavUrl,V=m.highlightApplianceToggle,B=m.linkUnknownToSurvey,q=m.shcFaqPopupShow,W=A.billChargesDisclaimerSHC||A.billChargesDisclaimer,J=A.title,Q=this.context.runMode===E.K8z,z=!Q&&O&&-1!==O.indexOf.MY_RECOMMENDATIONS||Q&&G,X=Q&&!p&&Y,K=this.getDetectedApplianceIds(o,m),$=o&&o.length>1,ee=l&&o&&r&&$?this.handleFilterModal:null,ae=g===E.oVm.WATER,te=!t.dataNotAvailableText&&t.shcData&&t.shcData.length>0,se=!!t.apiErrorMessage,ne=(0,U.Gn)(r,t.shcGraphData[t.shcGraphData.length-1],A,m,M.z_,this.props.isEVToggleOn,g),ie=q&&m.consumptionMode===E.AgQ.COST;return(0,x.jsxs)("div",{className:"insights-inner-container\n          ".concat((0,R.wG)()?"color-accessible-container":""),role:"region","aria-label":J,children:[F&&!p&&(0,x.jsx)("div",{className:Q?"widget-header-cont ".concat((0,R.jP)()?"no-bg":""):"insights-shc-header-cont",children:(0,x.jsx)("span",{role:"heading","aria-level":"2",className:"insights-shc-header",children:J})}),p&&(F||(0,R.IR)())&&(0,x.jsxs)("div",{className:Q?"widget-header-cont ".concat((0,R.jP)()||!F?"no-bg":""):"insights-shc-header-cont",children:[(0,x.jsx)("span",{role:"heading","aria-level":"2",className:"insights-shc-header",children:F&&J}),(0,R.IR)()&&(0,x.jsx)("button",{ref:"shcAdaRefMobile",className:"accessibility-cta insights-page ada-mobile",tabIndex:se?-1:0,"aria-label":A.accessibilityLabel,onClick:function(){return e.handleADA(e.refs.shcAdaRefMobile)},children:(0,x.jsx)("span",{className:"bidgely-icon-accessibility"})})]}),(0,x.jsxs)("div",{className:"insights-shc-content ".concat(X?"hide-full-content\n            ".concat(F?"with-header":""):""),children:[t.isSHChartLoading&&(0,x.jsx)(I.Z,{}),t.apiErrorMessage&&(0,x.jsx)(S.Z,{component:"p",tabIndex:"0",className:"api-error-message insights-shc-error","data-widget-name":E.wY4.INSIGHTS.SHC,"data-text-color":"foreground_300",children:t.apiErrorMessage}),!p&&(0,x.jsxs)("div",{className:"insights-interval-cont","aria-hidden":se,children:[(0,x.jsx)(j.Z,{widgetName:E.wY4.INSIGHTS.SHC,enableLeftArrow:!t.insightsDataLeftArrowDisabled&&!se,enableRightArrow:!t.insightsDataRightArrowDisabled&&!se,intervalDetails:t.currentBillingCycleInfo,handleArrowClick:s,direction:1,disableAda:se,translations:n}),(0,R.IR)()&&(0,x.jsx)("button",{ref:"shcAdaRef",className:"accessibility-cta insights-page",tabIndex:se?-1:0,"aria-label":A.accessibilityLabel,onClick:function(){return e.handleADA(e.refs.shcAdaRef)},children:(0,x.jsx)("span",{className:"bidgely-icon-accessibility"})})]}),!p&&l&&o&&r&&$&&(0,x.jsx)("div",{className:"insights-app-toggle-cont","data-widget-name":E.wY4.INSIGHTS.SHC,"data-text-color":"foreground_500",children:(0,x.jsx)(_.Z,{onToggleAppliance:function(a){return e.props.onSHCRecoChange(a)},detectedAppliances:K,applianceList:this.props.applianceList,selectedAppliance:r,widgetName:E.wY4.INSIGHTS.SHC,themedApplianceToggle:V})}),p&&(0,x.jsx)("div",{className:"ms-controller-mobile",children:(0,x.jsx)(N.Z,{enableLeftArrow:!t.insightsDataLeftArrowDisabled,enableRightArrow:!t.insightsDataRightArrowDisabled,intervalDetails:t.currentBillingCycleInfo,handleArrowClick:s,handleModal:ee,widgetName:E.wY4.INSIGHTS.SHC,direction:-1,translations:n,isShowADABtn:!0,handleADA:this.handleADA,isMobileView:p})}),p&&(0,x.jsx)(L.Z,{isMobileView:!0,open:this.state.openFilter,isModalTableEnabled:this.state.isModalTableEnabled,controls:T,enableApplianceSelection:!0,detectedAppliances:K,widgetStrings:A.filterModal,skipOngoingBC:m.skipOngoingBC,applianceList:i,handleModal:this.handleFilterModal,onUpdateFilter:this.onUpdateFilter,configData:D.data}),(0,x.jsxs)("div",{className:"insights-content","aria-hidden":se,children:[!t.isSHChartLoading&&!ne&&(0,x.jsx)("div",{className:"category-header"+(l&&" shc-appliance"),"data-widget-name":E.wY4.INSIGHTS.SHC,"data-bg-color":"primary_200","data-text-color":"foreground_500",children:(0,x.jsx)(S.Z,{classes:{body1:"current-category-text ".concat(l?"":"shc-center")},children:A.chartHeading})}),ne&&(0,x.jsxs)("div",{className:"insights-info-text",onClick:function(a){return e.handleLinkClick(a)},children:[(0,x.jsx)(H.Z,{className:"dollar-icon"}),(0,x.jsx)("span",{className:"insight-text",dangerouslySetInnerHTML:{__html:ne}})]}),ie&&t.userEvInfo.showEvData&&(0,x.jsx)("div",{className:"ev-toggle-container",children:(0,x.jsx)(S.Z,{component:"div",children:(0,x.jsxs)(v.ZP,{component:"label",container:!0,alignItems:"center",spacing:1,children:[(0,x.jsx)(v.ZP,{item:!0,children:A.shcEvToggleExLabel}),(0,x.jsx)(v.ZP,{item:!0,children:(0,x.jsx)(f.Z,{checked:this.props.isEVToggleOn,onChange:this.props.handleEVToggleChange,name:"ev-checkbox",inputProps:{"aria-label":"".concat(A.shcEvToggleAriaLabel)}})}),(0,x.jsx)(v.ZP,{item:!0,children:A.shcEvToggleInLabel})]})})}),t.dataNotAvailableText&&(0,x.jsx)("div",{className:"shc-data-not-available","data-widget-name":E.wY4.INSIGHTS.SHC,"data-bg-color":"background_300",children:t.dataNotAvailableText}),t.dataEmptyText&&(0,x.jsx)("div",{className:"shc-data-not-available","data-widget-name":E.wY4.INSIGHTS.SHC,"data-bg-color":"background_300",children:t.dataEmptyText}),(0,x.jsxs)("div",{"data-widget-name":E.wY4.INSIGHTS.USAGE,"data-show-appliances-colors":"true","data-graph-label-color":"foreground_400",className:ie?"shc-chart-container":"",children:[(0,x.jsx)(y.Z,(0,C.Z)((0,C.Z)({options:t.options,immutable:!0,isModalTableEnabled:this.state.isModalTableEnabled,isInsights:!0,handleADA:this.handleADA},this.props),{},{detectedApplianceIds:K,enableLeftArrow:!t.insightsDataLeftArrowDisabled,enableRightArrow:!t.insightsDataRightArrowDisabled,intervalDetails:t.currentBillingCycleInfo,handleArrowClick:s,widgetName:E.wY4.INSIGHTS.SHC,errorMessage:t.apiErrorMessage,insightsSHData:t,handleModal:this.handleFilterModal,adaModalTitle:F?J:A.adaTableTitle,currentRef:this.state.currentRef})),ie&&!t.isSHChartLoading&&(0,x.jsxs)("div",{className:"chart-info-popup","aria-hidden":se,children:[this.state.openModal?(0,x.jsxs)("div",{className:"dialog ".concat(p?"custom-dialog-box":""),"aria-labelledby":"header",children:[(0,x.jsx)("div",{className:"dialog-window",children:(0,x.jsx)(u.Z,{className:"popup-root",elevation:3,children:(0,x.jsx)(Z,{insightsSHData:t,translations:n,widgetStrings:A,open:this.state.openModal,closeFooterDialog:this.closeFooterDialog,headerId:"header",isModal:!0})})}),this.state.openModal&&(0,x.jsx)("div",{onClick:this.closeFooterDialog,className:"dialog-mask"})]}):"",(0,x.jsxs)("span",{role:"link",ref:this.footerEl,onClick:function(a){return e.openFooterDialog(a)},onKeyPress:function(a){return e.openFooterDialog(a)},className:"".concat((0,R.IR)()?"ada-focus":""),children:[(0,x.jsxs)("span",{children:[A.shcChartFaqLabel," "]}),(0,x.jsx)("span",{className:"tooltip bidgely-icon-faq"})]})]})]}),t.showDisclaimerMissingInterval&&(0,x.jsxs)("div",{className:"disclaimer-msg","data-widget-name":E.wY4.INSIGHTS.SHC,"data-text-color":"foreground_400",children:[A.missingIntervalIcon," ",A.missingInterval]}),t.showDisclaimerApplianceMissing&&(0,x.jsxs)("div",{className:"disclaimer-msg","data-widget-name":E.wY4.INSIGHTS.SHC,"data-text-color":"foreground_400",children:[A.missingApplianceIcon," ",A.missingAppliance]}),!t.isSHChartLoading&&A.chartDisclaimer&&(0,x.jsx)("div",{className:"disclaimer-msg","data-widget-name":E.wY4.INSIGHTS.SHC,"data-text-color":"foreground_400",children:A.chartDisclaimer})]}),(0,x.jsxs)("div",{className:ie?"insight-confirm-cont":"",children:[ie&&t.userEvInfo.showEvConfirmation&&(0,x.jsxs)("div",{className:"insight-confirm-info",children:[(0,x.jsx)("span",{dangerouslySetInnerHTML:{__html:A.shcEvConfirmLabel}}),(0,x.jsx)("div",{className:"insight-confirm-btn-cont",children:(0,x.jsx)(b.Z,{btnText:A.shcEvSurveyBtnLabel,btnBackground:"rgb(".concat(c["--data_colors_average_homes"],")"),hoverColor:"rgb(".concat(c["--data_colors_average_homes"],")"),textColor:"rgb(".concat(c["--foreground_300"],")"),hoverTextColor:"rgb(".concat(c["--foreground_300"],")"),borderColor:"transparent",onClick:function(a){return e.goToSurvey(a,Q?P:M.ce)},btnTextTransform:"none"})})]}),!ie&&!t.isSHChartLoading&&(0,x.jsxs)("div",{className:"chart-footer","aria-hidden":se,children:[A.chartFooter,p&&d&&!ae&&W&&(0,x.jsx)(k.q,{arrow:!1,placement:"top",interactive:!0,title:(0,x.jsx)("span",{dangerouslySetInnerHTML:{__html:W}}),configColors:this.configColors,name:"\u24d8"}),W&&!p&&d&&!ae&&(0,x.jsx)("span",{dangerouslySetInnerHTML:{__html:" "+W}})]}),!t.isSHChartLoading&&!ae&&z&&(0,x.jsx)("div",{className:"chart-btn-cont ".concat(ie?"new":"old"),"aria-hidden":se,children:(0,x.jsx)(b.Z,{tabIndex:se?-1:0,btnText:A.btnTextReco,textColor:"rgb(".concat(c["--primary_500"],")"),borderColor:"rgb(".concat(c["--primary_500"],")"),onClick:function(a){return e.goToRecommendations(a,Q?G:M.z_)},hoverColor:"rgb(".concat(c["--background_300"],")"),btnTextTransform:"none"})})]}),!t.isSHChartLoading&&te&&(0,x.jsxs)("div",{className:"shc-comparison-cont","aria-hidden":se,children:[(0,x.jsx)("button",{onClick:function(){return e.toggleShcComparison()},"aria-expanded":this.state.showShcComparison,tabIndex:se?-1:0,className:"shc-comparison-header",children:(0,x.jsxs)(S.Z,{children:[A.comparisonHeader,(0,x.jsx)("span",{className:"shc-comparison-header-arrow ".concat(this.state.showShcComparison?"down":"")})]})}),this.state.showShcComparison&&(0,x.jsxs)(h.Z,{disableGutters:!0,className:"shc-comparison-widget","data-widget-name":E.wY4.INSIGHTS.SHC,"data-border-color":"primary_200",children:[(0,x.jsx)("div",{"data-widget-name":E.wY4.INSIGHTS.SHC,"data-bg-color":"background_300","data-border-color":"primary_200"}),(0,x.jsx)(w,{surveySdkNavUrl:P,shcData:t.shcData,disableAda:se,linkUnknownToSurvey:B,goToSurvey:function(a,t,s){return e.goToSurvey(a,t,s)},widgetStrings:A,configColors:c})]}),(0,x.jsx)("div",{ref:this.comparedToRef})]})]})]})}}]),t}(l.Component);q.contextType=A.zO;var W=q,J=t(69099),Q=t(56808),z={average:"--data_colors_average_homes",you:"--data_colors_graph_primary",efficient:"--data_colors_efficient_homes",youEv:"--data_colors_ev_homes"},X={average:"--data_colors_average_homes",you:"--data_colors_graph_primary",efficient:"--data_colors_efficient_homes",youEv:"--data_colors_ev_homes"},K={shcGraphData:[{intervalStart:1493092800,intervalEnd:1495598399,intervalStartDate:"Apr 25, 2017",intervalEndDate:"May 23, 2017",applianceInfo:{4:{appId:4,userCost:10,userCons:106,averageSHCCost:0,averageSHCCons:0,efficientSHCCost:0,efficientSHCCons:0,applianceSHCMissing:!0},17:{appId:17,userCost:81,userCons:879,averageSHCCost:31,averageSHCCons:340,efficientSHCCost:17,efficientSHCCons:190,applianceSHCMissing:!1}},isMissingDataInterval:!1},{intervalStart:1495598400,intervalEnd:1498190399,intervalStartDate:"May 24, 2017",intervalEndDate:"Jun 22, 2017",applianceInfo:{4:{appId:4,userCost:51,userCons:557,averageSHCCost:0,averageSHCCons:0,efficientSHCCost:0,efficientSHCCons:0,applianceSHCMissing:!0},17:{appId:17,userCost:105,userCons:1144,averageSHCCost:32,averageSHCCons:354,efficientSHCCost:17,efficientSHCCons:188,applianceSHCMissing:!1}},isMissingDataInterval:!1},{intervalStart:1498190400,intervalEnd:1500955199,intervalStartDate:"Jun 23, 2017",intervalEndDate:"Jul 24, 2017",applianceInfo:{4:{appId:4,userCost:67,userCons:816,averageSHCCost:0,averageSHCCons:0,efficientSHCCost:0,efficientSHCCons:0,applianceSHCMissing:!0},17:{appId:17,userCost:114,userCons:1390,averageSHCCost:33,averageSHCCons:408,efficientSHCCost:16,efficientSHCCons:200,applianceSHCMissing:!1}},isMissingDataInterval:!1},{intervalStart:1500955200,intervalEnd:1503547199,intervalStartDate:"Jul 25, 2017",intervalEndDate:"Aug 23, 2017",applianceInfo:{4:{appId:4,userCost:23,userCons:288,averageSHCCost:0,averageSHCCons:0,efficientSHCCost:0,efficientSHCCons:0,applianceSHCMissing:!0},17:{appId:17,userCost:93,userCons:1178,averageSHCCost:28,averageSHCCons:359,efficientSHCCost:13,efficientSHCCons:168,applianceSHCMissing:!1}},isMissingDataInterval:!1},{intervalStart:1503547200,intervalEnd:1506311999,intervalStartDate:"Aug 24, 2017",intervalEndDate:"Sep 24, 2017",applianceInfo:{4:{appId:4,userCost:12,userCons:157,averageSHCCost:0,averageSHCCons:0,efficientSHCCost:0,efficientSHCCons:0,applianceSHCMissing:!0},17:{appId:17,userCost:84,userCons:1081,averageSHCCost:26,averageSHCCons:334,efficientSHCCost:13,efficientSHCCons:171,applianceSHCMissing:!1}},isMissingDataInterval:!1},{intervalStart:1506312e3,intervalEnd:1508903999,intervalStartDate:"Sep 25, 2017",intervalEndDate:"Oct 24, 2017",applianceInfo:{4:{appId:4,userCost:5,userCons:70,averageSHCCost:0,averageSHCCons:0,efficientSHCCost:0,efficientSHCCons:0,applianceSHCMissing:!0},17:{appId:17,userCost:78,userCons:1017,averageSHCCost:23,averageSHCCons:296,efficientSHCCost:12,efficientSHCCons:158,applianceSHCMissing:!1}},isMissingDataInterval:!1},{intervalStart:1508904e3,intervalEnd:1511413199,intervalStartDate:"Oct 25, 2017",intervalEndDate:"Nov 22, 2017",applianceInfo:{4:{appId:4,userCost:0,userCons:0,averageSHCCost:0,averageSHCCons:0,efficientSHCCost:0,efficientSHCCons:0,applianceSHCMissing:!0},17:{appId:17,userCost:88,userCons:1124,averageSHCCost:40,averageSHCCons:514,efficientSHCCost:18,efficientSHCCons:231,applianceSHCMissing:!1}},isMissingDataInterval:!1},{intervalStart:1511413200,intervalEnd:1513918799,intervalStartDate:"Nov 23, 2017",intervalEndDate:"Dec 21, 2017",applianceInfo:{4:{appId:4,userCost:0,userCons:0,averageSHCCost:0,averageSHCCons:0,efficientSHCCost:0,efficientSHCCons:0,applianceSHCMissing:!0},17:{appId:17,userCost:97,userCons:1203,averageSHCCost:60,averageSHCCons:739,efficientSHCCost:23,efficientSHCCons:284,applianceSHCMissing:!1}},isMissingDataInterval:!1},{intervalStart:1513918800,intervalEnd:1516856399,intervalStartDate:"Dec 22, 2017",intervalEndDate:"Jan 24, 2018",applianceInfo:{4:{appId:4,userCost:0,userCons:0,averageSHCCost:0,averageSHCCons:0,efficientSHCCost:0,efficientSHCCons:0,applianceSHCMissing:!0},17:{appId:17,userCost:110,userCons:1410,averageSHCCost:77,averageSHCCons:992,efficientSHCCost:33,efficientSHCCons:417,applianceSHCMissing:!1}},isMissingDataInterval:!1},{intervalStart:1516856400,intervalEnd:1519361999,intervalStartDate:"Jan 25, 2018",intervalEndDate:"Feb 22, 2018",applianceInfo:{4:{appId:4,userCost:0,userCons:0,averageSHCCost:0,averageSHCCons:0,efficientSHCCost:0,efficientSHCCons:0,applianceSHCMissing:!0},17:{appId:17,userCost:100,userCons:1259,averageSHCCost:56,averageSHCCons:704,efficientSHCCost:26,efficientSHCCons:322,applianceSHCMissing:!1}},isMissingDataInterval:!1},{intervalStart:1519362e3,intervalEnd:1522036799,intervalStartDate:"Feb 23, 2018",intervalEndDate:"Mar 25, 2018",applianceInfo:{4:{appId:4,userCost:0,userCons:0,averageSHCCost:0,averageSHCCons:0,efficientSHCCost:0,efficientSHCCons:0,applianceSHCMissing:!0},17:{appId:17,userCost:98,userCons:1226,averageSHCCost:49,averageSHCCons:618,efficientSHCCost:20,efficientSHCCons:251,applianceSHCMissing:!1}},isMissingDataInterval:!1},{intervalStart:1522036800,intervalEnd:1524628799,intervalStartDate:"Mar 26, 2018",intervalEndDate:"Apr 24, 2018",applianceInfo:{4:{appId:4,userCost:0,userCons:0,averageSHCCost:0,averageSHCCons:0,efficientSHCCost:0,efficientSHCCons:0,applianceSHCMissing:!0},17:{appId:17,userCost:87,userCons:1089,averageSHCCost:42,averageSHCCons:521,efficientSHCCost:18,efficientSHCCons:222,applianceSHCMissing:!1}},isMissingDataInterval:!1},{intervalStart:1524628800,intervalEnd:1527220799,intervalStartDate:"Apr 25, 2018",intervalEndDate:"May 24, 2018",applianceInfo:{4:{appId:4,userCost:5,userCons:63,averageSHCCost:0,averageSHCCons:0,efficientSHCCost:0,efficientSHCCons:0,applianceSHCMissing:!0},17:{appId:17,userCost:72,userCons:943,averageSHCCost:27,averageSHCCons:357,efficientSHCCost:13,efficientSHCCons:175,applianceSHCMissing:!1}},isMissingDataInterval:!1},{intervalStart:1527220800,intervalEnd:1529899199,intervalStartDate:"May 25, 2018",intervalEndDate:"Jun 24, 2018",applianceInfo:{4:{appId:4,userCost:15,userCons:192,averageSHCCost:0,averageSHCCons:0,efficientSHCCost:0,efficientSHCCons:0,applianceSHCMissing:!0},17:{appId:17,userCost:78,userCons:1015,averageSHCCost:28,averageSHCCons:365,efficientSHCCost:14,efficientSHCCons:178,applianceSHCMissing:!1}},isMissingDataInterval:!1},{intervalStart:1529899200,intervalEnd:1532491199,intervalStartDate:"Jun 25, 2018",intervalEndDate:"Jul 24, 2018",applianceInfo:{4:{appId:4,userCost:34,userCons:437,averageSHCCost:0,averageSHCCons:0,efficientSHCCost:0,efficientSHCCons:0,applianceSHCMissing:!0},17:{appId:17,userCost:86,userCons:1103,averageSHCCost:33,averageSHCCons:418,efficientSHCCost:15,efficientSHCCons:187,applianceSHCMissing:!1}},isMissingDataInterval:!1},{intervalStart:1532491200,intervalEnd:1535342399,intervalStartDate:"Jul 25, 2018",intervalEndDate:"Aug 26, 2018",applianceInfo:{4:{appId:4,userCost:32,userCons:405,averageSHCCost:0,averageSHCCons:0,efficientSHCCost:0,efficientSHCCons:0,applianceSHCMissing:!0},17:{appId:17,userCost:90,userCons:1149,averageSHCCost:37,averageSHCCons:473,efficientSHCCost:19,efficientSHCCons:237,applianceSHCMissing:!1}},isMissingDataInterval:!1},{intervalStart:1535342400,intervalEnd:1537934399,intervalStartDate:"Aug 27, 2018",intervalEndDate:"Sep 25, 2018",applianceInfo:{4:{appId:4,userCost:15,userCons:194,averageSHCCost:0,averageSHCCons:0,efficientSHCCost:0,efficientSHCCons:0,applianceSHCMissing:!0},17:{appId:17,userCost:69,userCons:897,averageSHCCost:27,averageSHCCons:353,efficientSHCCost:15,efficientSHCCons:198,applianceSHCMissing:!1}},isMissingDataInterval:!1},{intervalStart:1537934400,intervalEnd:1540526399,intervalStartDate:"Sep 26, 2018",intervalEndDate:"Oct 25, 2018",applianceInfo:{4:{appId:4,userCost:0,userCons:0,averageSHCCost:0,averageSHCCons:0,efficientSHCCost:0,efficientSHCCons:0,applianceSHCMissing:!0},17:{appId:17,userCost:71,userCons:927,averageSHCCost:31,averageSHCCons:407,efficientSHCCost:19,efficientSHCCons:250,applianceSHCMissing:!1}},isMissingDataInterval:!1},{intervalStart:1540526400,intervalEnd:1543208399,intervalStartDate:"Oct 26, 2018",intervalEndDate:"Nov 25, 2018",applianceInfo:{4:{appId:4,userCost:0,userCons:0,averageSHCCost:0,averageSHCCons:0,efficientSHCCost:0,efficientSHCCons:0,applianceSHCMissing:!0},17:{appId:17,userCost:86,userCons:1085,averageSHCCost:47,averageSHCCons:592,efficientSHCCost:25,efficientSHCCons:319,applianceSHCMissing:!1}},isMissingDataInterval:!1},{intervalStart:1543208400,intervalEnd:1545886799,intervalStartDate:"Nov 26, 2018",intervalEndDate:"Dec 26, 2018",applianceInfo:{4:{appId:4,userCost:0,userCons:0,averageSHCCost:0,averageSHCCons:0,efficientSHCCost:0,efficientSHCCons:0,applianceSHCMissing:!0},17:{appId:17,userCost:97,userCons:1192,averageSHCCost:63,averageSHCCons:774,efficientSHCCost:28,efficientSHCCons:349,applianceSHCMissing:!1}},isMissingDataInterval:!1},{intervalStart:1545886800,intervalEnd:1548651599,intervalStartDate:"Dec 27, 2018",intervalEndDate:"Jan 27, 2019",applianceInfo:{4:{appId:4,userCost:0,userCons:0,averageSHCCost:0,averageSHCCons:0,efficientSHCCost:0,efficientSHCCons:0,applianceSHCMissing:!0},17:{appId:17,userCost:114,userCons:1429,averageSHCCost:76,averageSHCCons:952,efficientSHCCost:38,efficientSHCCons:484,applianceSHCMissing:!1}},isMissingDataInterval:!1},{intervalStart:1548651600,intervalEnd:1551157199,intervalStartDate:"Jan 28, 2019",intervalEndDate:"Feb 25, 2019",applianceInfo:{4:{appId:4,userCost:0,userCons:0,averageSHCCost:0,averageSHCCons:0,efficientSHCCost:0,efficientSHCCons:0,applianceSHCMissing:!0},17:{appId:17,userCost:101,userCons:1241,averageSHCCost:66,averageSHCCons:810,efficientSHCCost:31,efficientSHCCons:380,applianceSHCMissing:!1}},isMissingDataInterval:!1},{intervalStart:1551157200,intervalEnd:1553659199,intervalStartDate:"Feb 26, 2019",intervalEndDate:"Mar 26, 2019",applianceInfo:{4:{appId:4,userCost:0,userCons:0,averageSHCCost:0,averageSHCCons:0,efficientSHCCost:0,efficientSHCCons:0,applianceSHCMissing:!0},17:{appId:17,userCost:90,userCons:1121,averageSHCCost:57,averageSHCCons:707,efficientSHCCost:23,efficientSHCCons:283,applianceSHCMissing:!1}},isMissingDataInterval:!1},{intervalStart:1553659200,intervalEnd:1556251199,intervalStartDate:"Mar 27, 2019",intervalEndDate:"Apr 25, 2019",applianceInfo:{4:{appId:4,userCost:0,userCons:0,averageSHCCost:0,averageSHCCons:0,efficientSHCCost:0,efficientSHCCons:0,applianceSHCMissing:!0},17:{appId:17,userCost:87,userCons:1077,averageSHCCost:44,averageSHCCons:548,efficientSHCCost:21,efficientSHCCons:262,applianceSHCMissing:!1}},isMissingDataInterval:!1},{intervalStart:1556251200,intervalEnd:1558929599,intervalStartDate:"Apr 26, 2019",intervalEndDate:"May 26, 2019",applianceInfo:{4:{appId:4,userCost:0,userCons:0,averageSHCCost:0,averageSHCCons:0,efficientSHCCost:0,efficientSHCCons:0,applianceSHCMissing:!0},17:{appId:17,userCost:70,userCons:928,averageSHCCost:31,averageSHCCons:418,efficientSHCCost:15,efficientSHCCons:204,applianceSHCMissing:!1}},isMissingDataInterval:!1},{intervalStart:1558929600,intervalEnd:1561348799,intervalStartDate:"May 27, 2019",intervalEndDate:"Jun 23, 2019",applianceInfo:{4:{appId:4,userCost:3,userCons:38,averageSHCCost:0,averageSHCCons:0,efficientSHCCost:0,efficientSHCCons:0,applianceSHCMissing:!0},17:{appId:17,userCost:67,userCons:887,averageSHCCost:26,averageSHCCons:352,efficientSHCCost:13,efficientSHCCons:170,applianceSHCMissing:!1}},isMissingDataInterval:!1},{intervalStart:1561348800,intervalEnd:1563940799,intervalStartDate:"Jun 24, 2019",intervalEndDate:"Jul 23, 2019",applianceInfo:{4:{appId:4,userCost:20,userCons:257,averageSHCCost:0,averageSHCCons:0,efficientSHCCost:0,efficientSHCCons:0,applianceSHCMissing:!0},17:{appId:17,userCost:87,userCons:1103,averageSHCCost:41,averageSHCCons:521,efficientSHCCost:17,efficientSHCCons:222,applianceSHCMissing:!1}},isMissingDataInterval:!1},{intervalStart:1563940800,intervalEnd:1566532799,intervalStartDate:"Jul 24, 2019",intervalEndDate:"Aug 22, 2019",applianceInfo:{4:{appId:4,userCost:14,userCons:178,averageSHCCost:0,averageSHCCons:0,efficientSHCCost:0,efficientSHCCons:0,applianceSHCMissing:!0},17:{appId:17,userCost:77,userCons:984,averageSHCCost:37,averageSHCCons:466,efficientSHCCost:16,efficientSHCCons:202,applianceSHCMissing:!1}},isMissingDataInterval:!1},{intervalStart:1566532800,intervalEnd:1569297599,intervalStartDate:"Aug 23, 2019",intervalEndDate:"Sep 23, 2019",applianceInfo:{4:{appId:4,userCost:0,userCons:0,averageSHCCost:0,averageSHCCons:0,efficientSHCCost:0,efficientSHCCons:0,applianceSHCMissing:!0},17:{appId:17,userCost:51,userCons:666,averageSHCCost:31,averageSHCCons:404,efficientSHCCost:14,efficientSHCCons:187,applianceSHCMissing:!1}},isMissingDataInterval:!1},{intervalStart:1569297600,intervalEnd:1571975999,intervalStartDate:"Sep 24, 2019",intervalEndDate:"Oct 24, 2019",applianceInfo:{4:{appId:4,userCost:0,userCons:0,averageSHCCost:0,averageSHCCons:0,efficientSHCCost:0,efficientSHCCons:0,applianceSHCMissing:!0},17:{appId:17,userCost:65,userCons:855,averageSHCCost:31,averageSHCCons:412,efficientSHCCost:14,efficientSHCCons:191,applianceSHCMissing:!1}},isMissingDataInterval:!1},{intervalStart:1571976e3,intervalEnd:1574657999,intervalStartDate:"Oct 25, 2019",intervalEndDate:"Nov 24, 2019",applianceInfo:{4:{appId:4,userCost:0,userCons:0,averageSHCCost:0,averageSHCCons:0,efficientSHCCost:0,efficientSHCCons:0,applianceSHCMissing:!0},17:{appId:17,userCost:123,userCons:1090,averageSHCCost:75,averageSHCCons:661,efficientSHCCost:29,efficientSHCCons:260,applianceSHCMissing:!1}},isMissingDataInterval:!1},{intervalStart:1574658e3,intervalEnd:1577077199,intervalStartDate:"Nov 25, 2019",intervalEndDate:"Dec 22, 2019",applianceInfo:{4:{appId:4,userCost:0,userCons:0,averageSHCCost:0,averageSHCCons:0,efficientSHCCost:0,efficientSHCCons:0,applianceSHCMissing:!0},17:{appId:17,userCost:129,userCons:1040,averageSHCCost:81,averageSHCCons:655,efficientSHCCost:33,efficientSHCCons:270,applianceSHCMissing:!1}},isMissingDataInterval:!1},{intervalStart:1577077200,intervalEnd:1579669199,intervalStartDate:"Dec 23, 2019",intervalEndDate:"Jan 21, 2020",applianceInfo:{4:{appId:4,userCost:0,userCons:0,averageSHCCost:0,averageSHCCons:0,efficientSHCCost:0,efficientSHCCons:0,applianceSHCMissing:!0},17:{appId:17,userCost:152,userCons:1253,averageSHCCost:80,averageSHCCons:659,efficientSHCCost:41,efficientSHCCons:339,applianceSHCMissing:!1}},isMissingDataInterval:!1},{intervalStart:1579669200,intervalEnd:1582347599,intervalStartDate:"Jan 22, 2020",intervalEndDate:"Feb 21, 2020",applianceInfo:{4:{appId:4,userCost:0,userCons:0,averageSHCCost:0,averageSHCCons:0,efficientSHCCost:0,efficientSHCCons:0,applianceSHCMissing:!0},17:{appId:17,userCost:151,userCons:1206,averageSHCCost:92,averageSHCCons:731,efficientSHCCost:44,efficientSHCCons:351,applianceSHCMissing:!1}},isMissingDataInterval:!1},{intervalStart:1582347600,intervalEnd:1584935999,intervalStartDate:"Feb 22, 2020",intervalEndDate:"Mar 22, 2020",applianceInfo:{4:{appId:4,userCost:0,userCons:0,averageSHCCost:0,averageSHCCons:0,efficientSHCCost:0,efficientSHCCons:0,applianceSHCMissing:!0},17:{appId:17,userCost:133,userCons:1054,averageSHCCost:96,averageSHCCons:762,efficientSHCCost:42,efficientSHCCons:335,applianceSHCMissing:!1}},isMissingDataInterval:!1},{intervalStart:1584936e3,intervalEnd:1587614399,intervalStartDate:"Mar 23, 2020",intervalEndDate:"Apr 22, 2020",applianceInfo:{4:{appId:4,userCost:0,userCons:0,averageSHCCost:0,averageSHCCons:0,efficientSHCCost:0,efficientSHCCons:0,applianceSHCMissing:!0},17:{appId:17,userCost:126,userCons:1235,averageSHCCost:53,averageSHCCons:520,efficientSHCCost:26,efficientSHCCons:252,applianceSHCMissing:!1}},isMissingDataInterval:!1},{intervalStart:1587614400,intervalEnd:1590206399,intervalStartDate:"Apr 23, 2020",intervalEndDate:"May 22, 2020",applianceInfo:{4:{appId:4,userCost:0,userCons:0,averageSHCCost:0,averageSHCCons:0,efficientSHCCost:0,efficientSHCCons:0,applianceSHCMissing:!0},17:{appId:17,userCost:113,userCons:1115,averageSHCCost:38,averageSHCCons:378,efficientSHCCost:20,efficientSHCCons:198,applianceSHCMissing:!1}},isMissingDataInterval:!1}],shcApplianceData:{applianceList:[17,4]}},$=t(45764),ee=t(41294),ae=t(74813),te=t(62791),se=t(11698),ne=t(61939),ie=t(21911),oe=t(34582),re=function(e){(0,o.Z)(t,e);var a=(0,r.Z)(t);function t(e){var n;return(0,s.Z)(this,t),(n=a.call(this,e)).widgetTrackingInfo=void 0,n.configColors=O.V.getColors().colors,te.bs.subscribe(te.FP.RELOAD_WIDGET,n.init.bind((0,i.Z)(n))),n.state={isEVToggleOn:!1},n}return(0,n.Z)(t,[{key:"componentDidMount",value:function(){this.widgetTrackingInfo=this.context.rc.analytics.createWidgetInfo(E.xDZ.INSIGHTS_SHC),this.context.rc.analytics.trackEvent(E.FiA.INSIGHTS,{viewed:!0,shown:E.Q2X.SIMILAR_HOMES},this.props),this.init()}},{key:"init",value:function(){var e=(0,P.xu)(this.props.location),a=this.props.insightsSHData,t=this.props.widgetConfigs.consumptionMode;if(0===this.props.insightsSHData.insightsSHChartsData.length?this.fetchSHCGraphData():this.setGraphOptions(),0===this.props.insightsSHData.shcData.length&&this.fetchSHCInfoData(),e&&e.appId&&a&&a.appliancesSHCList){for(var s=!1,n=0;n<a.appliancesSHCList.length;n++)if(parseInt(a.appliancesSHCList[n].id)===parseInt(e.appId)){s=!0;break}s||(e.appId=E.N$L)}e&&e.appId&&(this.props.changeSelectedSHCAppliance({selectedAppliance:e.appId,dataNotAvailableText:"",dataEmptyText:""}),this.updateHighChartsObject(t),this.onSHCRecoChange(e.appId))}},{key:"componentDidUpdate",value:function(e){if(this.widgetTrackingInfo&&e.insightsSHData.isSHChartLoading&&!this.props.insightsSHData.isSHChartLoading){var a=this.props.insightsSHData.apiErrorMessage?E.WW8.ERROR:E.WW8.SUCCESS,t=this.props.insightsSHData.errorInfo;this.context.rc.analytics.logWidgetInfo(this.widgetTrackingInfo,a,t),this.widgetTrackingInfo=null}var s=this.props.insightsSHData,n=((0,P.xu)(this.props.location),this.props.widgetConfigs.consumptionMode);s.usageChartEvent===E.hlE.CHANGE_YEAR_OFFSET&&(this.props.setArrowDisabled({insightsDataLeftArrowDisabled:s.bcIndexOffset>=s.bcDurations.length-E.tv_,insightsDataRightArrowDisabled:0===s.bcIndexOffset,usageChartEvent:E.hlE.SET_ARROW_DISABLED}),this.setGraphOptions()),s.usageChartEvent===E.hlE.SET_HIGHCHARTS_DATA&&(this.checkIfDataEmpty(),this.updateHighChartsObject(n),this.setBillingCyclesInfo()),s.shcGraphData&&s.shcGraphData.length&&(s.usageChartEvent===E.hlE.SAVE_CHART_API_PAYLOAD||s.selectedAppliance!==e.insightsSHData.selectedAppliance)&&this.setHighchartsData(s.shcGraphData),s.usageChartEvent===E.hlE.SIMILAR_HOMES_API_ERROR&&this.setHighchartsData(K.shcGraphData)}},{key:"getChartLabel",value:function(e){var a=this.props.widgetStrings;switch(e){case E.MCA.YOU:return a.chartLabelYou;case E.MCA.AVERAGE:return a.chartLabelAverage;case E.MCA.EFFICIENT:return a.chartLabelEfficient;case E.MCA.YOU_EV:return a.chartLabelYouEV}}},{key:"updateHighChartsObject",value:function(e){var a=this,t="rgb(".concat(this.configColors["--foreground_500"],")"),s="rgb(".concat(this.configColors["--background_400"],")"),n=this.props.insightsSHData.dataXAxis.length,i=this.props.insightsSHData.bcIndexOffset,o=!!this.props.insightsSHData.apiErrorMessage,r=!this.props.insightsSHData.userEvInfo.showEvData||!this.state.isEVToggleOn,l=this.props.insightsSHData.dataXAxis;n>=E.tv_&&(l=this.props.insightsSHData.dataXAxis.slice(n-(E.tv_+i),n-i));var c={chart:{style:{marginBottom:10},backgroundColor:"rgb(".concat(this.configColors["--background_300"],")")},legend:{itemStyle:{color:t,fontWeight:"".concat(E.m5g.medium),fontSize:"14px"},align:"left",symbolPadding:0,symbolHeight:.1,symbolWidth:.1,symbolRadius:.1,x:60,useHTML:!0,labelFormatter:function(){var e=a.getChartLabel(this.name),t=r||this.name===E.MCA.YOU_EV?"":"disable-legend";return'<div class="legend-wrapper '.concat(t," ").concat((0,R.wG)()?"accessibility-color":"",'"><span class="symbol ').concat(this.name,'"></span><span>').concat(e,"</span></div>")},navigation:{enabled:!1}},xAxis:[{gridLineColor:s,startOnTick:!0,categories:l,labels:{style:{color:t,fontSize:"12px",paddingTop:"20px"},padding:0,y:25},lineColor:"rgb(".concat(this.configColors["--background_500"],")")}],yAxis:{gridLineColor:s,min:0,title:{text:""},labels:{formatter:function(){return e===E.AgQ.COST?(0,R.xB)({showCurrency:!0,cost:this.value}):(0,R.ub)({showUsageUnit:!0,usage:this.value,fuelType:a.props.session.userProfile.fuelType})},style:{color:t,fontSize:"12px",marginBottom:"10px"}}},tooltip:{useHTML:!0,backgroundColor:void 0,shared:!0,outside:!1,formatter:function(){return'<div class="tooltip-root-container"> '.concat(a.setTooltip(this.points)," <div>")},style:{color:t},padding:20,borderRadius:8,borderWidth:0},plotOptions:{series:{marker:{symbol:"round"},states:{hover:{halo:{size:0}}},animation:!1},line:{lineWidth:3}},series:a.props.insightsSHData.insightsSHChartsData};(0,R.IR)()&&(c.accessibility={enabled:!o,point:{valueDescriptionFormat:void 0,descriptionFormatter:function(e){var t=a.getTitleObj(a.props,e),s=a.props.widgetStrings.chartLabelAccessibility,n=a.getChartPointInfo(a.props,e),i={start_date:t.startDate,end_date:t.endDate,value_type:n.valueType,value:n.value,tooltip_text:n.tooltipText};return(0,R.Z7)(s,i)}}});var C={options:c,isSHChartLoading:!1,usageChartEvent:E.hlE.UPDATE_HIGHCHARTS_OBJECT};this.props.updateHighChartsObject(C)}},{key:"getTitleObj",value:function(e,a){var t=e.insightsSHData.bcDurations,s=t;return t.length>=E.tv_&&(s=t.slice(t.length-E.tv_-e.insightsSHData.bcIndexOffset,t.length-e.insightsSHData.bcIndexOffset)),s[a.index]}},{key:"getChartPointInfo",value:function(e,a){var t=e.widgetConfigs.consumptionMode;return{tooltipText:this.getChartLabel(a.series.name),value:t===E.AgQ.COST?(0,R.xB)({showCurrency:!0,cost:a.y}):(0,R.ub)({showUsageUnit:!0,usage:a.y,fuelType:e.session.userProfile.fuelType}),valueType:t===E.AgQ.COST?E.AgQ.COST:E.AgQ.USAGE}}},{key:"setTooltip",value:function(e){var a=this;if(e){var t=this.getTitleObj(this.props,e[0].point),s=!this.props.insightsSHData.userEvInfo.showEvData||!this.state.isEVToggleOn;return e.reduce((function(e,t){var n=a.getChartPointInfo(a.props,t),i=s||t.series.name==E.MCA.YOU_EV?"":"disable-tooltip";return"".concat(e,' <span class="tooltip-item-container ').concat(i,'">\n                      <span style="background-color: ').concat(t.color,'" class="tooltip-symbol"></span>\n                      <span class="tooltip-item-text ').concat(t.series.name,'"><span class="amount-text"> ').concat(n.value," </span>").concat(n.tooltipText,"</span>\n                  </span>")}),'<span class="tooltip-title"> '.concat(t.startDate," - ").concat(t.endDate," </span>"))}}},{key:"changeDataToShowOffset",value:function(e){var a=this.props,t=a.insightsSHData,s=a.changeYearOffset,n=t.bcTimeStampsData;t.bcTimeStampsData.length>=E.tv_&&(n=t.bcTimeStampsData.slice(t.bcTimeStampsData.length-E.tv_-t.bcIndexOffset,t.bcTimeStampsData.length-t.bcIndexOffset)),this.context.rc.analytics.trackEvent(E.FiA.INSIGHTS,{clicked:E.YyL,shown:E.Q2X.SIMILAR_HOMES,direction:1===e?E.JYL.RIGHT:E.JYL.LEFT,intervalStart:n[0].start,intervalEnd:n[n.length-1].end,widget:E.wY4.INSIGHTS.SHC}),s({usageChartEvent:E.hlE.CHANGE_YEAR_OFFSET,bcIndexOffset:1===e?t.bcIndexOffset-1:t.bcIndexOffset+1,dataNotAvailableText:"",dataEmptyText:""})}},{key:"checkIfDataEmpty",value:function(){var e=this.props,a=e.insightsSHData,t=e.translationsData,s=a.insightsSHChartsData.map((function(e){return e.data}));if(!(0,U.nk)(s)){var n=(0,U.Hh)(a,t.data);this.props.dataNotAvailable({dataEmptyText:n,dataNotAvailableText:"",isSHChartLoading:!1,insightsDataLeftArrowDisabled:a.bcIndexOffset>=a.bcDurations.length-E.tv_,insightsDataRightArrowDisabled:0===a.bcIndexOffset,usageChartEvent:E.hlE.SET_DATA_NOT_AVAILABLE})}}},{key:"fetchSHCGraphData",value:function(){var e=this.props,a=e.insightsSHData,t=e.session,s=e.translationsData,n=e.configs,i=e.applianceList,o=(0,U.aj)(a),r=this.props.widgetConfigs.dateFormat,l=this.props.widgetConfigs.enableApplianceSHC,c={"measurement-type":(0,R.nY)(t.userProfile.fuelType),"date-format":r,"show-appliance-shc":l,mode:a.mode.toLowerCase(),start:o.start,end:o.end,locale:n.locale};(0,ae.JF)()&&(c.templateName="".concat(E.wY4.INSIGHTS.SHC,".FETCH_SHC_GRAPH_DATA")),this.props.fetchSHCGraphData(this.context.rc,c,t.userProfile.userId,a,s.data,i)}},{key:"onSHCRecoChange",value:function(e){var a=this;this.props.changeSelectedSHCAppliance({selectedAppliance:e,usageChartEvent:E.hlE.CHANGE_SELECTED_APPLIANCE,dataNotAvailableText:"",dataEmptyText:""}),this.props.insightsSHData.shcChartsPayload&&this.props.insightsSHData.shcChartsPayload.length&&setTimeout((function(){return a.setHighchartsData(a.props.insightsSHData.shcChartsPayload)})),this.context.rc.analytics.trackEvent(E.FiA.INSIGHTS,{clicked:E.GNf.APPLIANCE_TOGGLE,widget:E.wY4.INSIGHTS.SHC,tab:E.Q2X.SIMILAR_HOMES,applianceId:e,selectedAppliance:(0,ee.ht)(e,this.props.applianceList)},this.props),this.context.runMode!==E.K8z&&this.props.history.push((0,P.UM)(this.props.location,[{name:"app-id",value:e}]))}},{key:"setHighchartsData",value:function(e){var a=this,t=this.props,s=t.insightsSHData,n=t.translationsData,i=t.configs,o=t.widgetConfigs,r=o.dateFormatChartXAxis,l=o.consumptionMode;this.props.saveSHCChartPayload({shcChartsPayload:e,dataNotAvailableText:"",usageChartEvent:E.hlE.SAVE_SHC_CHART_DATA_PAYLOAD});var c=e;if(0!==c.length){var C=[],p=[],d=!1,g=!1,S=s.selectedAppliance;c.forEach((function(e){var t=(0,se.p6)(e.intervalEndDateFormatted,E.ZFD.FULL_MONTH_DAY,E.ZFD.YEAR_MONTH_DAY);r&&(0,se.qb)(e.intervalEndDateFormatted,E.ZFD.YEAR_MONTH_DAY)&&(t=(0,se.p6)(e.intervalEndDateFormatted,r,E.ZFD.YEAR_MONTH_DAY));var s=a.props.widgetStrings.missingIntervalIcon,n=a.props.widgetStrings.missingApplianceIcon;e.isMissingDataInterval?(C.push(t+s),d=!0):e.applianceInfo[S]&&"applianceSHCMissing"in e.applianceInfo[S]&&e.applianceInfo[S].applianceSHCMissing?(C.push(t+n),g=!0):C.push(t),p.push({startDate:(0,R.Yr)(e.intervalStartDateFormatted,E.DEY.YEAR,i.data),endDate:(0,R.Yr)(e.intervalEndDateFormatted,E.DEY.YEAR,i.data),isMissingDataInterval:e.isMissingDataInterval,startFormattedDate:e.intervalStartDateFormatted,endFormattedDate:e.intervalEndDateFormatted})}));var h=s.userEvInfo;s&&s.appliancesSHCList&&s.userEVState&&S&&(h=(0,U.ro)(s.appliancesSHCList,s.userEVState,S,o),this.props.saveSHCEvInfo({userEvInfo:h}));var f=(0,U.oL)(c,l,S,h.showEvData);this.props.saveBCData({youSeriesData:f.youSeriesData,youEvSeriesData:f.youEvSeriesData,averageSeriesData:f.averageSeriesData,efficientSeriesData:f.efficientSeriesData,bcTimeStampsData:f.bcTimeStampsData,insightsDataLeftArrowDisabled:s.bcIndexOffset>=p.length-E.tv_,insightsDataRightArrowDisabled:0===s.bcIndexOffset,bcDurations:p,dataXAxis:C,dataMonthStart:0,dataMonthEnd:0,datasMonthIndex:f.bcTimeStampsData.length-1,showDisclaimerMissingInterval:d,showDisclaimerApplianceMissing:g,usageChartEvent:E.hlE.SAVE_BC_DATA}),setTimeout((function(){return a.setGraphOptions()}))}else{var v=(0,U.Hh)(s,n.data);this.props.dataNotAvailable({dataNotAvailableText:v,dataEmptyText:"",isSHChartLoading:!1,insightsDataLeftArrowDisabled:s.bcIndexOffset>=s.bcDurations.length-E.tv_,insightsDataRightArrowDisabled:0===s.bcIndexOffset,usageChartEvent:E.hlE.SET_DATA_NOT_AVAILABLE})}}},{key:"setGraphOptions",value:function(){var e=[],a=Object.values(E.MCA),t=!this.props.insightsSHData.userEvInfo.showEvData||!this.state.isEVToggleOn;t&&a.splice(a.indexOf(E.MCA.YOU_EV),1);for(var s=0;s<a.length;s++){var n=a[s],i="".concat(n,"SeriesData"),o=this.props.insightsSHData[i],r=this.props.insightsSHData.bcIndexOffset;o.length>=E.tv_&&(o=o.slice(o.length-(r+E.tv_),o.length-r));var l=t||n==E.MCA.YOU_EV?1:.4;e.push({name:n,type:"line",data:o,opacity:l,color:"rgb(".concat((0,R.wG)()?this.configColors[X[n]]:this.configColors[z[n]],")"),marker:{enabled:a.indexOf(n)>=0||1===o.length,symbol:"round",lineWidth:2,lineColor:null,fillColor:"rgb(".concat((0,R.wG)()?this.configColors[X[n]]:this.configColors[z[n]],")"),states:{hover:{enabled:!1}}},events:{legendItemClick:function(e){t||e.target.name===E.MCA.YOU_EV||e.preventDefault()}}})}this.props.setSimilarHomesChartsData({usageChartEvent:E.hlE.SET_HIGHCHARTS_DATA,insightsSHChartsData:e})}},{key:"setBillingCyclesInfo",value:function(){var e,a=this.props,t=a.insightsSHData,s=a.saveBillingCyclePeriod,n=a.responsiveness,i=a.configs,o=n.isMobileView,r=i.data,l=t.bcDurations;t.bcDurations.length>=E.tv_&&(l=t.bcDurations.slice(t.bcDurations.length-E.tv_-t.bcIndexOffset,t.bcDurations.length-t.bcIndexOffset)),e=(0,R.Yr)(l[0].endFormattedDate,E.DEY.YEAR,r,o)+" - "+(0,R.Yr)(l[l.length-1].endFormattedDate,E.DEY.YEAR,r,o),s({usageChartEvent:E.hlE.SAVE_BILLING_CYCLE_INFO,currentBillingCycleInfo:e})}},{key:"fetchSHCInfoData",value:function(){var e=this,a=this.props,t=a.insightsSHData,s=a.session,n=a.apiError,i=a.translationsData,o=this.props.configs.locale,r={"measurement-type":(0,R.nY)(this.props.session.userProfile.fuelType),locale:o};(0,ae.JF)()&&(r.templateName="".concat(E.wY4.INSIGHTS.SHC,".FETCH_SHC_INFO_DATA")),(0,J.Ac)(this.context.rc,r,s.userProfile.userId).then((function(a){if(a&&a.data)e.setSHComparisonData(a.data);else{var s=(0,U.Hh)(t,i.data);n(s)}}))}},{key:"setSHComparisonData",value:function(e){for(var a=[],t=0;t<e.length;t++)e[t].text&&e[t].value&&a.push({title:e[t].text,value:e[t].value,questionId:e[t].questionId});this.props.setSHCdata({shcData:a,usageChartEvent:E.hlE.SET_SHC_DATA})}},{key:"handleEVToggleChange",value:function(){var e=this;this.setState({isEVToggleOn:!this.state.isEVToggleOn}),setTimeout((function(){return e.setGraphOptions()}))}},{key:"render",value:function(){var e=this,a=this.props,t=a.insightsSHData,s=a.session,n=a.configs,i=a.setQueryParams,o=a.responsiveness,r=this.props.session.userProfile.fuelType,l=this.props.widgetConfigs.consumptionMode,c=this.props.widgetConfigs.enableApplianceSHC;return(0,x.jsx)(W,{detectedAppliances:t.appliancesSHCList,selectedAppliance:t.selectedAppliance,insightsSHData:t,session:s,changeDataToShowOffset:function(a){return e.changeDataToShowOffset(a)},translations:this.props.translationsData.data,onSHCRecoChange:function(a){return e.onSHCRecoChange(a)},enableApplianceSHC:c,configColors:this.configColors,widgetConfigs:this.props.widgetConfigs,widgetStrings:this.props.widgetStrings,configs:n,isCostMode:l===E.AgQ.COST,setQueryParams:function(e){return i(e)},applianceList:this.props.applianceList,isMobileView:o.isMobileView,fuelType:r,history:this.props.history,location:this.props.location,handleEVToggleChange:function(a){return e.handleEVToggleChange()},isEVToggleOn:this.state.isEVToggleOn,setSurveyV2Modal:function(){return e.props.setSurveyV2Modal()}})}}]),t}(l.Component);re.contextType=A.zO;var le=(0,ne.$)(V.Z$.INSIGHTS_SIMILAR_HOMES,(0,ie.EN)((0,c.$j)((function(e){return{session:e.session,insightsSHData:e.similarHomesData,translationsData:e.translationsData,queryParams:e.queryParams,applianceList:e.appliances.appliancesList,configs:e.configs,responsiveness:e.responsiveness}}),(function(e){return{apiError:function(a){return e((0,Q.qF)(a))},saveBillingCyclePeriod:function(a){return e((0,Q.RQ)(a))},setSimilarHomesChartsData:function(a){return e((0,Q.Dj)(a))},saveBCData:function(a){return e((0,Q.KX)(a))},dataNotAvailable:function(a){return e((0,Q.md)(a))},updateHighChartsObject:function(a){return e((0,Q.MW)(a))},changeYearOffset:function(a){return e((0,Q.Fh)(a))},setArrowDisabled:function(a){return e((0,Q.bG)(a))},setSHCdata:function(a){return e((0,Q.R_)(a))},changeSelectedSHCAppliance:function(a){return e((0,Q.iV)(a))},saveSHCEvInfo:function(a){return e((0,Q.YW)(a))},setQueryParams:function(a){return e((0,$.BT)(a))},saveApplianceNavbarList:function(a){return e((0,Q.bx)(a))},saveSHCChartPayload:function(a){return e((0,Q.xk)(a))},fetchSHCGraphData:function(a,t,s,n,i,o){return e((0,J.nQ)(a,t,s,n,i,o))},setSurveyV2Modal:function(){return e((0,oe._t)())}}}))(re)))}}]);