"use strict";(self.webpackChunkmeraki=self.webpackChunkmeraki||[]).push([[561],{88893:function(e,n,t){t.r(n),t.d(n,{default:function(){return P}});var o=t(93433),i=t(15671),a=t(43144),r=t(97326),s=t(60136),c=t(98557),l=t(47313),d=t(1084),m=t(16404),u=t(74813),h=t(56955),p=t(46795),g=t(1413),f=t(29439),v=t(44021),R=t(26019),D=t(1411),C=t(46123),T=t.n(C),E=t(46417);function w(e){var n=e.item,t=e.recoType,o=e.widgetConfigs.cardClickEnabled,i=T()("recommedations-item",{clickable:o&&n.recommendationsMetaData.recommendationDetailsExist});return(0,E.jsxs)("div",{className:i,onMouseOver:function(){return e.onHoverRecos(n.recommendationsMetaData.primaryRecommendationId,m.aAE.CAROUSEL)},onClick:o&&n.recommendationsMetaData.recommendationDetailsExist?function(){return e.handleModal(n.recommendationsMetaData.primaryRecommendationId,null,t)}:null,children:[(0,E.jsxs)("div",{className:"image-details-container",children:[(0,E.jsx)("div",{className:"recommedations-item-image-container",children:(0,E.jsx)("img",{src:n.recommendationsMetaData.dashboardIcon,alt:(0,h.IR)()?"":n.recommendationsMetaData.title})}),(0,E.jsxs)("div",{className:"recommedations-item-content","data-widget-name":m.wY4.RECOMMENDATIONS,children:[(0,E.jsx)("p",{role:"heading","aria-level":"3",className:"title",children:(0,E.jsx)("span",{children:n.recommendationsMetaData.title})}),(0,E.jsx)("p",{className:"description",children:n.recommendationsMetaData.description})]})]}),n.recommendationInsight&&e.recoInsightsEnabled&&(0,E.jsxs)("div",{className:"reco-insight-container",children:[(0,E.jsx)("img",{src:e.insightBulbImage,alt:""}),(0,E.jsx)("div",{className:"insight",children:n.recommendationInsight})]})]},e.index)}var x=t(69140),k=t(19615),M=t(76720),y=t(83450),I=t(61939);function N(e){var n=(0,M.WS)(),t=k.V.getColors().colors,o=(0,l.useContext)(I.R),i=o.widgetConfigs,a=o.widgetStrings,r=i.recoCardVariant,s=i.hideSliderDots,c=i.hideSliderArrows,d=i.moreRecoNavUrl,u=i.showHeader,p=a.prevTip,C=a.nextTip,T=a.sliderCount,N=a.title,b=a.btnAllTips,S=a.noData,O=n.runMode===m.K8z,A=O&&d,j=e.recommendationsData.recoTop5Data,L=j.unviewedRecommendationWrapperList,P=j.viewedRecommendationWrapperList,W=j&&(L.length>0||P.length>0),H=(L&&L.length||0)+(P&&P.length||0),V=l.useState(H>0?1:0),Z=(0,f.Z)(V,2),_=Z[0],F=Z[1],U=(0,l.useRef)(null),Y=(0,l.useRef)(null),B=function(e,n){var t=e.className,o=e.label,i=e.onClick,a=e.additionalClass;return(0,E.jsx)("button",{className:"button button--text button--icon ".concat(t," ").concat(a),type:"button",onClick:i,onKeyDown:function(e){if(e&&e.keyCode&&e.keyCode!==m.nx.ENTER&&e.keyCode!==m.nx.SPACE)return!1;if(i(),n){var t=n;setTimeout((function(){t.current.focus()}),515)}},ref:n,"aria-label":o,children:o})},z=l.forwardRef(B),J=function(){return r===m.mU.DETAILED&&s?"no-slider":""},K={className:"center",centerPadding:"0",centerMode:H>3,infinite:(0,R.R)(j,3),slidesToShow:3,slidesToScroll:1,speed:500,dots:!s,arrows:!c,accessibility:!0,responsive:[{breakpoint:800,settings:{slidesToShow:2,infinite:(0,R.R)(j,2)}},{breakpoint:550,settings:{slidesToShow:1,infinite:(0,R.R)(j,1)}}],afterChange:function(n){e.onViewRecos(n),F(++n)},beforeChange:function(n,t){return e.onChangeSlider(n,t)},prevArrow:(0,E.jsx)(z,{label:p,ref:U,additionalClass:J()}),nextArrow:(0,E.jsx)(z,{label:C,ref:Y,additionalClass:J()})},G=(0,h.Z7)(T,{currSlideCount:_,totalSlides:H});return(0,E.jsxs)("div",{className:"recommendations-tips-cont ".concat(u?"elevate":""),children:[(!O||O&&u)&&(0,E.jsx)("div",{className:"".concat(u?"widget-header-cont ".concat((0,h.jP)()?"no-bg":""):"recommendations-title"),children:(0,E.jsx)("span",{role:"heading","aria-level":"2","data-widget-name":m.wY4.RECOMMENDATIONS,"data-text-color":"foreground_400",children:N})}),W&&(0,E.jsxs)("div",{className:"recommendations-top-tips ".concat((0,h.wG)()?"recommendations-top-tips-color-accessible":""),"data-widget-name":m.wY4.RECOMMENDATIONS,"data-nav-bg-color":"primary_500","data-nav-arrow-color":"foreground_300",children:[(0,E.jsx)("div",{"aria-live":"polite","aria-atomic":"true",className:"bg-sr-only",children:G}),(0,E.jsxs)(v.Z,(0,g.Z)((0,g.Z)({},K),{},{children:[L.length>0&&L.map((function(n,t){return n&&(0,E.jsx)(l.Fragment,{children:r===m.mU.DETAILED?(0,E.jsx)(D.Z,{item:n,index:t,configs:e.configs,widgetConfigs:i.recoCardDetailed,widgetStrings:a.recoCardDetailed,translations:e.translations,recoType:m.aAE.TOP5.UNVIEWED,isSlickDotsDisabled:s,onHoverRecos:function(n,t){return e.onHoverRecos(n,t)},handleModal:function(n,t,o,i){return e.handleModal(n,t,o,i)},handleRecoLikeUnlike:function(n,t){return e.handleRecoLikeUnlike(n,t)},isSlickItem:!0,learnMoreClickHandler:function(n,t,o,i){return e.learnMoreClickHandler(n,t,o,i)}}):(0,E.jsx)(w,{index:t,item:n,recoType:m.aAE.TOP5.UNVIEWED,widgetConfigs:i.recoCardSummary,onHoverRecos:function(n,t){return e.onHoverRecos(n,t)},configs:e.configs,handleModal:function(n,t,o,i){return e.handleModal(n,t,o,i)}})},t)})),P.length>0&&P.map((function(n,t){return n&&(0,E.jsx)(l.Fragment,{children:r===m.mU.DETAILED?(0,E.jsx)(D.Z,{item:n,index:t,configs:e.configs,widgetConfigs:i.recoCardDetailed,widgetStrings:a.recoCardDetailed,translations:e.translations,isSlickDotsDisabled:s,recoType:m.aAE.TOP5.VIEWED,onHoverRecos:function(n,t){return e.onHoverRecos(n,t)},handleModal:function(n,t,o,i){return e.handleModal(n,t,o,i)},handleRecoLikeUnlike:function(n,t){return e.handleRecoLikeUnlike(n,t)},isSlickItem:!0,learnMoreClickHandler:function(n,t,o,i){return e.learnMoreClickHandler(n,t,o,i)}}):(0,E.jsx)(w,{index:t,item:n,recoType:m.aAE.TOP5.VIEWED,widgetConfigs:i.recoCardSummary,onHoverRecos:function(n,t){return e.onHoverRecos(n,t)},configs:e.configs,handleModal:function(n,t,o,i){return e.handleModal(n,t,o,i)}})},t)}))]})),A&&(0,E.jsx)("div",{className:"reco-all-btn",children:(0,E.jsx)(x.Z,{btnText:b,textColor:"rgb(".concat(t["--primary_500"],")"),borderColor:"rgb(".concat(t["--primary_500"],")"),onClick:function(n){return e.goToAllRecommendations(n,O?d:y.z_)},hoverColor:"rgb(".concat(t["--background_300"],")")})})]}),!W&&O&&(0,E.jsx)("p",{className:"reco-no-data-cont",children:S})]})}var b=t(17878),S=t(88291),O=t(21911),A=t(62791),j=t(21629),L=function(e){(0,s.Z)(t,e);var n=(0,c.Z)(t);function t(e){var o;return(0,i.Z)(this,t),(o=n.call(this,e)).state={preventInitalFoucs:!0},o.unViewedRecos=[],A.bs.subscribe(A.FP.RELOAD_WIDGET,o.init.bind((0,r.Z)(o))),o}return(0,a.Z)(t,[{key:"componentDidMount",value:function(){this.widgetTrackingInfo=this.context.rc.analytics.createWidgetInfo(m.xDZ.RECO_TOP_TIPS),this.init()}},{key:"init",value:function(){if(!this.props.recommendationsData.recoTop5Data){var e=(0,h.nY)(this.props.session.userProfile.fuelType);this.props.fetchingTop5Reco(),this.props.fetchTop5Reco(this.context.rc,this.props.session.userProfile.userId,this.props.configs.locale,e,(0,u.JF)()&&"".concat(m.wY4.RECOMMENDATIONS,".FETCH_TOP_5"))}}},{key:"componentDidUpdate",value:function(e){var n=this,t=this.props.recommendationsData,o=e.recommendationsData;if(this.widgetTrackingInfo&&o&&o.fetchingRecoTop5Data&&!t.fetchingRecoTop5Data){var i=t.recoTop5DataFailed?m.WW8.ERROR:m.WW8.SUCCESS,a=t.recoTop5DataErrorInfo;this.context.rc.analytics.logWidgetInfo(this.widgetTrackingInfo,i,a),this.widgetTrackingInfo=null}t.recoTop5Data===o.recoTop5Data||o.recoTop5Data||(0===t.recoTop5Data.viewedRecommendationWrapperList.length&&0===t.recoTop5Data.unviewedRecommendationWrapperList.length?this.context.rc.analytics.trackEvent(m.FiA.RECOMMENDATIONS,{noreco:"true",carousel:!0}):(t.recoTop5Data.unviewedRecommendationWrapperList.map((function(e){return e&&n.unViewedRecos.push(e.recommendationsMetaData.recommendationId),e})),this.onViewRecos(0)))}},{key:"onViewRecos",value:function(e){var n=this.props.recommendationsData;if(!this.context.rc.session.isCobrowsingMode()&&n.recoTop5Data.unviewedRecommendationWrapperList&&n.recoTop5Data.unviewedRecommendationWrapperList.length>0&&e<n.recoTop5Data.unviewedRecommendationWrapperList.length&&this.unViewedRecos[e]&&(this.props.onViewRecos(this.context.rc,this.props.session.userProfile.userId,this.unViewedRecos[e],(0,u.JF)()&&"".concat(m.wY4.RECOMMENDATIONS,".RECO_VIEW")),this.unViewedRecos[e]=null),(0,h.IR)()&&this.refs&&this.refs.slick){var t=this.refs.slick,i=t.getElementsByClassName("slick-current");if(i&&i.length){for(var a=t.getElementsByClassName("slick-slide"),r=t.getElementsByClassName("recommedations-item-content"),s=0;s<a.length;s++)r[s]&&""!==r[s].style.height&&(r[s].style.removeProperty("height"),r[s].style.removeProperty("top"),r[s].lastChild.style.removeProperty("height"),r[s].lastChild.style.removeProperty("padding"),r[s].lastChild.style.removeProperty("opacity"));if(!this.state.preventInitalFoucs){var c=i[0].getElementsByClassName("recommedations-item-content")[0];c&&(c.style.cssText="height: calc(100% - 1rem); top: 1rem",c.lastChild.style.cssText="height: auto;padding: 0 1rem .8rem;opacity:1")}this.setState({preventInitalFoucs:!1});for(var l=t.getElementsByClassName("slick-dots"),d=l&&l.length?l[0].children:[],p=0;p<d.length;p++)d[p].firstChild&&d[p].firstChild.setAttribute("aria-label","".concat(this.props.widgetStrings.sliderAriaLabel," ").concat(p+1))}}this.context.rc.analytics.trackEvent(m.FiA.RECOMMENDATIONS,{viewed:"recommendation",recoId:[].concat((0,o.Z)(n.recoTop5Data.unviewedRecommendationWrapperList),(0,o.Z)(n.recoTop5Data.viewedRecommendationWrapperList))[e].recommendationId,carousel:"true"})}},{key:"onChangeSlider",value:function(e,n){var t=m.JYL.LEFT;(e+1===n||0===n&&e-1!==n)&&(t=m.JYL.RIGHT),this.context.rc.analytics.trackEvent(m.FiA.RECOMMENDATIONS,{clicked:t,widget:m.wY4.RECOMMENDATIONS})}},{key:"gotoAllRecommendations",value:function(e,n){this.context.rc.analytics.trackEvent(m.FiA.RECOMMENDATIONS,{clicked:"allRecos",widget:m.wY4.RECOMMENDATIONS}),(0,S.K2)(n)?window.open(n):(0,S.m3)(m.K8z.RECOMMENDATION_TOP_TIPS,this.props.history,this.props.location,e,n)}},{key:"render",value:function(){var e=this,n=this.props,t=n.configs,o=n.translations,i=n.recommendationsData,a=n.recoInsightsEnabled,r=n.insightBulbImage,s=i.recoTop5Data;return(0,E.jsx)("div",{ref:"slick",children:s&&(0,E.jsx)(N,{configs:t.data,translations:o.data,recoInsightsEnabled:a,insightBulbImage:r,recommendationsData:this.props.recommendationsData,onViewRecos:function(n){return e.onViewRecos(n)},onHoverRecos:function(n,t){return e.props.onHoverRecos(n,t)},onChangeSlider:function(n,t){return e.onChangeSlider(n,t)},goToAllRecommendations:function(n,t){return e.gotoAllRecommendations(n,t)},handleModal:function(n,t,o,i){return e.props.handleModal(n,t,o,i)},learnMoreClickHandler:function(n,t,o,i){return e.props.learnMoreClickHandler(n,t,o,i)}})})}}]),t}(l.Component);L.contextType=M.zO;var P=(0,I.$)(j.Z$.RECOMMENDATION_TOP_TIPS,(0,O.EN)((0,b.H)((0,d.$j)((function(e){return{recommendationsData:e.recommendationsData,session:e.session,configs:e.configs,translations:e.translationsData}}),(function(e){return{fetchingTop5Reco:function(){return e((0,p.eo)())},fetchTop5Reco:function(n,t,o,i,a){return e((0,p.yo)(n,t,o,i,a))},onViewRecos:function(n,t,o,i){return e((0,p.Mq)(n,t,o,i))}}}))(L))))}}]);