"use strict";(self.webpackChunkmeraki=self.webpackChunkmeraki||[]).push([[945],{65664:function(e,t,a){a.r(t),a.d(t,{default:function(){return Te}});var n=a(15671),i=a(43144),s=a(60136),o=a(98557),r=a(47313),l=a(21911),c=a(1084),d=a(57877),u=a(16404),p=a(37762),g=a(29439),h=a(1413),f=a(22548),m=a(26915),x=a(1550),A=a(44758),D=a(38502),N=a(51405),E=a(74748),v=a(83213),S=a(98957),T=a(93116),C=a(46417),I=(0,m.ZL)()({root:{fontSize:"14px"},dropdownIcon:{color:"rgba(var(--foreground_500), 1)",paddingRight:"5px"},iconRoot:{minWidth:"auto",margin:"0",paddingTop:"4px",paddingRight:"10px",alignItems:"center",color:"#67758D"},icon:{fontSize:"16px"},selectMenu:{padding:"12px 10px 11px 10px"},multiSelect:{paddingTop:"7px",paddingBottom:"7px"}}),w=(0,m.D2)((function(e){return(0,C.jsx)(A.Z,(0,h.Z)({color:"default"},e))}),(function(){return{root:{"&$checked":{color:"#3572A8"}},checked:{}}})),b=(0,m.D2)(D.ZP,(function(e){return{root:{height:"50px"},input:{display:"inline-flex",borderRadius:"6px",border:"1px solid #DFE8F1",color:"rgba(var(--foreground_500), 1)",fontWeight:500,fontSize:"14px",height:"20px",lineHeight:"17px",paddingLeft:"10px",boxShadow:"0px 3px 6px rgba(68, 103, 141, 0.09), 0px -2px 6px rgba(68, 103, 141, 0.05)","&:focus":{borderRadius:"6px",borderColor:"#80bdff"}}}}));function O(e){var t=I(e).classes,a=(0,r.useState)(e.defaultValue),n=(0,g.Z)(a,2),i=n[0],s=n[1],o=(0,r.useState)(["All"]),l=(0,g.Z)(o,2),c=l[0],d=l[1],u=(0,r.useState)(!1),p=(0,g.Z)(u,2),h=p[0],m=p[1],A=(0,r.useRef)(null),D=e.onClickHandler,O=e.filterName,R=(0,r.useCallback)((function(t){var a=[27,32,13],n=!1;if(n=!a.includes(t.keyCode)&&(e.isMultiFilter?!t.target.classList.contains("MuiModal-backdrop"):!h),t.keyCode&&-1===a.indexOf(t.keyCode))return!1;m(n),D&&D(O,i,c)}),[D,O,i,c,h]);return(0,r.useEffect)((function(){var e=A.current;return e.addEventListener("keydown",R,!1),function(){e.removeEventListener("keydown",R,!1)}}),[A,R]),(0,r.useEffect)((function(){if(e.isMultiFilter&&c.find((function(e){return"All"===e}))){var t=[];e.options.map((function(e){t.push(e.value)})),d(t),e.selectHandleChange(t)}}),[]),(0,C.jsx)("div",{children:(0,C.jsx)(x.Z,{classes:{root:t.root},children:(0,C.jsx)(f.Z,{onChange:function(t){if(e.isMultiFilter)if(t.target.value.find((function(e){return"All"===e}))){var a=[];if(t.target.value.length===e.options.length-1)for(var n=[],i=0;i<e.options.length;++i){if(t.target.value[i]!==e.options[i].value){n.push(e.options[i].value);break}a=n}else e.options.map((function(e){a.push(e.value)}));d(a),t.target.value=a}else d((function(a){if(a.find((function(e){return"All"===e})))return[];if("string"===typeof t.target.value)return t.target.value.split(",");if(t.target.value.length===e.options.length-1){var n=[];return e.options.map((function(e){n.push(e.value)})),n}return t.target.value}));else s(t.target.value);e.selectHandleChange&&e.selectHandleChange(t.target.value)},onClick:R,onClose:function(e,t){"backdropClick"!==t&&"escapeKeyDown"!==t||m(!1)},ref:A,MenuProps:{anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"},getContentAnchorEl:null,onKeyDown:function(e){e.stopPropagation(),e.preventDefault()}},input:(0,C.jsx)(b,{}),inputProps:{"aria-label":e.adaLabel,value:e.isMultiFilter?c:i,disabled:e.selectDisabled,className:e.isMultiFilter?t.multiSelect:""},multiple:e.isMultiFilter,renderValue:e.isMultiFilter?function(t){return e.isMultiFilter?t.join(", ").length>30&&t.length!==e.options.length?t.join(", ").substr(0,32)+"...":t.length===e.options.length?"All":t.join(", "):t}:null,IconComponent:S.Z,classes:{icon:t.dropdownIcon,selectMenu:t.selectMenu},open:h,children:e.options.map((function(a){return(0,C.jsxs)(N.Z,{value:a.value,children:[e.isIcon?(0,C.jsx)(E.Z,{classes:{root:t.iconRoot},className:e.isIconActive?t.iconActive:"",children:(0,C.jsx)(T.Z,{classes:{root:t.icon}})}):"",e.isMultiFilter?(0,C.jsx)(w,{checked:c.indexOf(a.value)>-1,color:"primary"}):"",(0,C.jsx)(v.Z,{primary:a.value,classes:{root:t.root},disableTypography:!0,inset:!1})]},a.id)}))})})})}var R=a(14427),j=a(4942),L=a(67478),y=a(24076),_=a(51629),H=a(70501),M=a(66835),k=a(23477),V=a(57861),Z=a(25673),F=a(47131),B=a(41489),P=a(11698);function U(){return{top:"10%"}}var z=(0,m.ZL)()((function(e){return{iconButtonRoot:{position:"absolute",top:"-5px",right:"-30px",color:"rgba(var(--background_300), 1)","&:hover":{background:"transparent"}}}}));function W(e){var t="1950px",a=r.useState(U),n=(0,g.Z)(a,1)[0],i=z(e).classes,s=r.useState(t),o=(0,g.Z)(s,2),l=o[0],c=o[1],d=r.useState(null),p=(0,g.Z)(d,2),h=p[0],f=p[1],m=(0,r.useState)(""),x=(0,g.Z)(m,2),A=x[0],D=x[1],N=function(e){return!!(e&&e.data)&&(e.data.notificationBody||e.data.notificationText)};r.useEffect((function(){var a=N(e.engagementViewNotificationData);h&&a&&function(e,a,n){a=a.replace(/(\n|\t)/g,"");var i=n.toLowerCase();if(a=i===u.XHW.EMAIL?a.replace(/(<a(.*?))(href="(.*?)")/g,"$1#"):a.replace(/(<a(.*?))(href="(.*?)")/g,'$1# style="pointer-events:none;"'),i===u.XHW.PAPER)D(a),c(t);else if(i===u.XHW.EMAIL||i==u.XHW.SMS){var s=e.contentDocument||e.contentWindow.document;s.open(),s.write(a),s.close()}}(h,a,e.userRow.channel)}),[h,e.engagementViewNotificationData,e.userRow.channel]);var E=function(t,a){return{SENT_TO:e.translations["DASHBOARD.NOTIFICATION_LIST_MODAL.SENT_TO"]||"Sent to",EMAIL_ADDRESS:e.translations["DASHBOARD.NOTIFICATION_LIST_MODAL.EMAIL_ADDRESS"]||"Email Address",ON:e.translations["DASHBOARD.NOTIFICATION_LIST_MODAL.ON"]||"on",NO_PREVIEW_AVAILABLE:a["DASHBOARD.NOTIFICATION_LIST_MODAL.NO_PREVIEW_AVAILABLE"]||"No Preview Available"}[t]};return(0,C.jsx)("div",{children:(0,C.jsx)(Z.Z,{open:e.open,onClose:e.handleClose,"aria-labelledby":"simple-modal-title","aria-describedby":"simple-modal-description",BackdropProps:{onClick:e.handleClose},style:{display:"flex",justifyContent:"center",overflow:"auto"},disableEnforceFocus:!0,children:(0,C.jsxs)("div",{style:n,className:"notification-modal-container",children:[(0,C.jsx)(F.Z,{"aria-label":"close modal",disableRipple:!0,disableFocusRipple:!0,size:"small",classes:{root:i.iconButtonRoot},onKeyDown:function(t){return 32===t.keyCode&&e.handleClose()},onClick:e.handleClose,children:(0,C.jsx)(B.Z,{})}),(0,C.jsxs)("h2",{className:"status-bar",children:[(0,C.jsx)("div",{children:e.userRow.status?e.userRow.status.toUpperCase():""}),"Email"===e.userRow.channel&&e.userRow.email?(0,C.jsx)("div",{children:E("EMAIL_ADDRESS",e.translations)+" "+e.userRow.email}):""]}),(0,C.jsxs)("h3",{className:"sent-details",children:[E("SENT_TO",e.translations)+" ",(e.session.userProfile.firstName||"")+" "+(e.session.userProfile.lastName||"")," ",E("ON",e.translations)+" ",e.userRow&&e.userRow.timestamp?(0,P.p6)(e.userRow.timestamp,"MM/DD/YY HH:mm:ss"):""]}),N(e.engagementViewNotificationData)?(0,C.jsx)("div",{className:"notification-preview",children:(0,C.jsx)("iframe",{className:"preview-iframe",title:"preview",scrolling:"no",frameBorder:"0",id:"notification-iframe",height:l,ref:f,src:A,onLoad:function(){c(h.contentWindow.document.body.scrollHeight+50+"px")}})}):e.engagementViewNotificationData&&e.engagementViewNotificationData.fetchingData?(0,C.jsx)(R.Z,{}):(0,C.jsx)("div",{className:"no-body",children:E("NO_PREVIEW_AVAILABLE",e.translations)})]})})})}var G=a(69140),Y=a(88345),K=a(25566),X=a.n(K),$=a(61113),Q=a(19615),J=a(76720),q=(0,m.ZL)()((function(e){var t,a;return{tableHeadRoot:{background:"rgba(var(--background_300), 1)"},btnRoot:(t={},(0,j.Z)(t,e.breakpoints.up("800"),{height:"25px",width:"60px",padding:"5px 10px"}),(0,j.Z)(t,e.breakpoints.up("1080"),{height:"32px",width:"100px"}),t),btnLabel:(a={},(0,j.Z)(a,e.breakpoints.up("800"),{fontSize:"10px"}),(0,j.Z)(a,e.breakpoints.up("1080"),{fontSize:"12px"}),a),paper:{position:"absolute",width:400,backgroundColor:e.palette.background.paper,border:"2px solid rgba(var(--foreground_700), 1)",boxShadow:e.shadows[5],padding:e.spacing(2,4,3)}}})),ee=(0,m.D2)(L.Z,(function(e){var t,a;return{head:(t={backgroundColor:"rgba(var(--background_300), 1)",color:"rgba(var(--foreground_500), 1)",padding:"10px 16px",lineHeight:"15px",letterSpacing:"1px"},(0,j.Z)(t,e.breakpoints.up("800"),{fontSize:"10px"}),(0,j.Z)(t,e.breakpoints.up("1080"),{fontSize:"13px"}),t),body:(a={lineHeight:"24px",letterSpacing:"1px",padding:"6px 16px",color:"rgba(var(--foreground_500), 1)",textAlign:"left",fontWeight:"500"},(0,j.Z)(a,e.breakpoints.up("800"),{fontSize:"10px"}),(0,j.Z)(a,e.breakpoints.up("1080"),{fontSize:"13px"}),a)}})),te=(0,m.D2)(y.Z,(function(e){return{root:{cursor:"pointer","&:nth-of-type(odd)":{backgroundColor:"rgba(var(--primary_200), 1)"}}}}));function ae(e){var t=(0,J.WS)().rc,a=q(e).classes,n=r.useState(!1),i=(0,g.Z)(n,2),s=i[0],o=i[1],l=(0,r.useState)({}),c=(0,g.Z)(l,2),d=c[0],u=c[1],p=function(a){if(!a.id)return!1;t.analytics.trackEvent("console.app.widget.engagementView",{clicked:"Preview",shown:"Engagement View",widget:"ENGAGEMENT_VIEW"},e),e.fetchNotificationsTemplateCb(t,a.id),u(a),o(!0)},h=[{id:1,value:e.translations["DASHBOARD.NOTIFICATION_LIST.DATE"]||"Date"},{id:2,value:e.translations["DASHBOARD.NOTIFICATION_LIST.CHANNEL"]||"Channel"},{id:3,value:e.translations["DASHBOARD.NOTIFICATION_LIST.TYPE"]||"Type"},{id:4,value:e.translations["DASHBOARD.NOTIFICATION_LIST.STATUS"]||"Status"},{id:5,value:e.translations["DASHBOARD.NOTIFICATION_LIST.OPENED"]||"Opened"},{id:6,value:e.translations["DASHBOARD.NOTIFICATION_LIST.CLICKED"]||"Clicked"},{id:7,value:e.translations["DASHBOARD.NOTIFICATION_LIST.MESSAGE"]||"Message"},{id:8,value:""}],f=!(!e.viewData||!e.viewData.length),m=Q.V.getColors().colors;return(0,C.jsxs)("div",{children:[(0,C.jsx)(W,{open:s,handleClose:function(e,t){o(!1)},engagementViewNotificationData:e.engagementViewNotificationData,session:e.session,userRow:d,translations:e.translations}),(0,C.jsxs)("div",{className:"result-table",children:[!f&&(0,C.jsx)($.Z,{variant:"h6",align:"center",children:"No result found"}),f&&(0,C.jsx)(_.Z,{component:H.Z,children:(0,C.jsxs)(M.Z,{"aria-label":"customized table",children:[(0,C.jsx)(k.Z,{classes:{root:a.tableHeadRoot},children:(0,C.jsx)(y.Z,{children:h.map((function(e){return(0,C.jsx)(ee,{children:e.value.toUpperCase()},e.id)}))})}),(0,C.jsx)(V.Z,{children:e.viewData.map((function(t,n){return(0,C.jsxs)(te,{onClick:function(){return p(t)},children:[(0,C.jsx)(ee,{component:"th",scope:"row",children:t.date}),(0,C.jsx)(ee,{align:"right",children:(0,C.jsx)(X(),{highlightClassName:"YourHighlightClass",searchWords:[e.keywords],autoEscape:!0,textToHighlight:t.channel||""})}),(0,C.jsx)(ee,{align:"right",children:(0,C.jsx)(X(),{highlightClassName:"YourHighlightClass",searchWords:[e.keywords],autoEscape:!0,textToHighlight:t.type||""})}),(0,C.jsx)(ee,{align:"right",children:(0,C.jsx)(X(),{highlightClassName:"YourHighlightClass",searchWords:[e.keywords],autoEscape:!0,textToHighlight:t.status||""})}),(0,C.jsx)(ee,{align:"right",children:t.opened.status?(0,C.jsx)(Y.Z,{className:"status-icon",fontSize:"small"}):"N/A"}),(0,C.jsx)(ee,{align:"right",className:"status-cell",children:t.clicked.status?(0,C.jsx)(Y.Z,{className:"status-icon",fontSize:"small"}):"N/A"}),(0,C.jsx)(ee,{align:"right",children:(0,C.jsx)("div",{className:"message",children:(0,C.jsx)(X(),{highlightClassName:"YourHighlightClass",searchWords:[e.keywords],autoEscape:!0,textToHighlight:t.message||""})})}),(0,C.jsx)(ee,{align:"right",children:(0,C.jsx)(G.Z,{btnVariant:"outlined",btnText:"Preview",btnTextSize:"12px",disableRipple:!0,btnBackground:"rgb(".concat(m["--background_300"],")"),borderColor:"rgb(".concat(m["--primary_500"],")"),textColor:"rgb(".concat(m["--primary_500"],")"),hoverColor:"rgb(".concat(m["--background_300"],")"),hoverTextColor:"rgb(".concat(m["--primary_600"],")"),btnTextTransform:"none",classes:{root:a.btnRoot,label:a.btnLabel},onClick:function(){return p(t)},"aria-label":t.previewAdaLabel})})]},t.id+n)}))})]})})]})]})}var ne=a(50494),ie=a(95180),se=a(90575),oe=a(98492),re=a(41872),le=(0,m.ZL)()((function(e){return{calendarIcon:{height:"15px",width:"16px",color:"rgba(var(--foreground_500), 1)",verticalAlign:"top"},statusIcon:{width:"15px",height:"11px",color:"rgba(var(--bgl_green_500), 1)",verticalAlign:"middle"},btnRoot:{height:"32px",width:"144px",padding:"6px 25px"},btnLabel:{fontSize:"13px",fontWeight:"600",lineHeight:"20px",textTransform:"none"},accordionRoot:{boxShadow:"none","&:before":{height:0}},accordionSummaryRoot:{padding:0,margin:"5px 0 10px 0",minHeight:"20px",borderBottom:"1px solid rgba(var(--background_500), 1)",color:"rgba(var(--foreground_500), 1)","&.Mui-expanded":{minHeight:"auto"}},accordionSummaryContent:{padding:0,margin:0,"&.Mui-expanded":{margin:0}},accordionSummaryExpandIcon:{padding:0,margin:0},accordionSummaryExpanded:{minHeight:"auto"},accordionDetailsRoot:{padding:0}}}));function ce(e){var t=(0,J.WS)().rc,a=le(e).classes,n=(0,r.useState)(null),i=(0,g.Z)(n,2),s=i[0],o=i[1],l=(0,r.useState)(!1),c=(0,g.Z)(l,2),d=c[0],u=c[1],p=(0,r.useState)({}),h=(0,g.Z)(p,2),f=h[0],m=h[1],x=function(e){return function(t,a){o(s===e?null:e)}},A=Q.V.getColors().colors;return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(W,{open:d,handleClose:function(e,t){u(!1)},engagementViewNotificationData:e.engagementViewNotificationData,session:e.session,userRow:f,translations:e.translations}),(0,C.jsx)("div",{className:"result-cards",children:e.viewData.map((function(n,i){return(0,C.jsxs)("div",{className:"result-card",children:[(0,C.jsxs)("div",{className:"data-row",children:[(0,C.jsxs)("div",{children:[(0,C.jsx)(T.Z,{classes:{root:a.calendarIcon}}),(0,C.jsx)("span",{className:"date",children:n.date})]}),(0,C.jsx)("div",{className:"channel",children:n.channel})]}),(0,C.jsxs)(se.Z,{expanded:s==="panel".concat(i),onChange:x("panel".concat(i)),classes:{root:a.accordionRoot},children:[(0,C.jsx)(oe.Z,{expandIcon:(0,C.jsx)(ne.Z,{}),"aria-controls":"panel1bh-content",id:"panel1bh-header",classes:{root:a.accordionSummaryRoot,content:a.accordionSummaryContent,expandIcon:a.accordionSummaryExpandIcon},onKeyDown:function(e){return function(e,t){if(e.keyCode&&-1===[32,13].indexOf(e.keyCode))return!1;x(t)(e)}(e,"panel".concat(i))},children:(0,C.jsx)("div",{className:"type",children:n.type})}),(0,C.jsx)(re.Z,{classes:{root:a.accordionDetailsRoot},children:(0,C.jsxs)("div",{className:"accordion-details",children:[(0,C.jsxs)("div",{className:"notification-status",children:[(0,C.jsxs)("div",{children:[(0,C.jsx)("span",{className:"opened",children:"Opened: "}),n.opened.status?(0,C.jsx)("span",{className:"status yes",children:"YES"}):(0,C.jsx)("span",{className:"status no",children:"NO"})]}),(0,C.jsxs)("div",{children:[(0,C.jsx)("span",{className:"clicked",children:"Clicked: "}),n.clicked.status?(0,C.jsx)("span",{className:"status yes",children:"YES"}):(0,C.jsx)("span",{className:"status no",children:"NO"})]})]}),(0,C.jsx)("div",{className:"message",children:n.message})]})})]}),(0,C.jsxs)("div",{className:"data-row",children:[(0,C.jsx)("div",{children:(0,C.jsx)(G.Z,{btnVariant:"outlined",btnText:"Preview",btnTextSize:"14px",disableRipple:!0,btnBackground:"rgb(".concat(A["--background_300"],")"),borderColor:"rgb(".concat(A["--primary_500"],")"),textColor:"rgb(".concat(A["--primary_500"],")"),hoverColor:"rgb(".concat(A["--background_300"],")"),hoverTextColor:"rgb(".concat(A["--primary_600"],")"),btnTextTransform:"none",classes:{root:a.btnRoot,label:a.btnLabel},onClick:function(){return function(a){if(!a.id)return!1;t.analytics.trackEvent("console.app.widget.engagementView",{clicked:"Preview",shown:"Engagement View",widget:"ENGAGEMENT_VIEW"},e),e.fetchNotificationsTemplateCb(t,a.id),m(a),u(!0)}(n)},"aria-label":n.previewAdaLabel})}),(0,C.jsxs)("div",{className:"status",children:[(0,C.jsx)(ie.Z,{classes:{root:a.statusIcon}}),n.status]})]})]},n.id+i)}))})]})}var de=a(56955),ue=function(e,t){var a={};switch(e.toLowerCase()){case u.zjR.SMS.dataKey:a.channelName=t[u.zjR.SMS.textKey],a.channelId=u.zjR.SMS.id;break;case u.zjR.EMAIL.dataKey:a.channelName=t[u.zjR.EMAIL.textKey],a.channelId=u.zjR.EMAIL.id;break;case u.zjR.PUSH.dataKey:a.channelName=t[u.zjR.PUSH.textKey],a.channelId=u.zjR.PUSH.id;break;case u.zjR.PAPER.dataKey:a.channelName=t[u.zjR.PAPER.textKey],a.channelId=u.zjR.PAPER.id;break;case u.zjR.ENROL_EHER.dataKey:a.channelName=t[u.zjR.ENROL_EHER.textKey],a.channelId=u.zjR.ENROL_EHER.id;break;default:a.channelName=e,a.channelId=0}return a},pe=function(e){if(-1===e.indexOf("_"))return e.toUpperCase();for(var t=(e=e.replace("_"," ")).toLowerCase().split(" "),a=0;a<t.length;a++)t[a]=t[a].charAt(0).toUpperCase()+t[a].substring(1);return t.join(" ")},ge=function(e,t,a){var n={DELIVERED:a["DASHBOARD.NOTIFICATION.STATUS.DELIVERED"],GENERATED:a["DASHBOARD.NOTIFICATION.STATUS.GENERATED"],BOUNCED:a["DASHBOARD.NOTIFICATION.STATUS.BOUNCED"],SENT:a["DASHBOARD.NOTIFICATION.STATUS.SENT"],SOFT_BOUNCED:a["DASHBOARD.NOTIFICATION.STATUS.SOFT_BOUNCED"],QUEUED:a["DASHBOARD.NOTIFICATION.STATUS.QUEUED"],UNDELIVERED:a["DASHBOARD.NOTIFICATION.STATUS.UNDELIVERED"],REJECTED:a["DASHBOARD.NOTIFICATION.STATUS.REJECTED"],SPAM:a["DASHBOARD.NOTIFICATION.STATUS.SPAM"],BLOCKED:a["DASHBOARD.NOTIFICATION.STATUS.BLOCKED"],FAILED:a["DASHBOARD.NOTIFICATION.STATUS.FAILED"],PRINTED:a["DASHBOARD.NOTIFICATION.STATUS.PRINTED"],MAILED:a["DASHBOARD.NOTIFICATION.STATUS.MAILED"],SCHEDULED:a["DASHBOARD.NOTIFICATION.STATUS.SCHEDULED"]},i=t.deliveryMode.toLowerCase()===u.zjR.PAPER.dataKey;switch(e){case"message":return i?a["COMMON.NA_TEXT"]:t.notificationTitle;case"status":return n[t.status]||t.status;case"type":return pe(t.notificationType);default:return i?{status:!0,value:a["COMMON.NA_TEXT"]}:0!==t[e]?{status:!0,value:""}:{status:!1,value:""}}},he=function(e,t){return{EMAIL:e["DASHBOARD.ENG_CARE.FILTERS.EMAIL"]||"Email Channel",PAPER:e["DASHBOARD.ENG_CARE.FILTERS.PAPER"]||"Paper Channel",SMS:e["DASHBOARD.ENG_CARE.FILTERS.SMS"]||"SMS Channel"}[t]},fe=a(9019),me=a(35045),xe={BOUNCED:"bounced",GENERATED:"generated"},Ae={areNotificationChannelsEnabled:{email:!0,paper:!1,sms:!0,push:!1,failed:!0}},De=(0,m.ZL)()((function(e){return{paperRoot:{display:"flex",height:"33px"},inputRoot:{backgroundColor:"rgba(var(--background_300), 1)",borderRadius:"8px",height:"33px",fontSize:"14px",lineHeight:"17px",color:"rgba(var(--foreground_500), 1)",flexGrow:"100"},iconRoot:{padding:"7px 10px",color:"rgba(var(--primary_500), 1)"}}}));function Ne(e){var t=(0,J.WS)().rc,a=De().classes,n=function(e){var t=(0,P.ZG)(new Date);return[{id:1,value:e["DASHBOARD.TIMELINE.SHOW_ALL_NOTIFICATIONS"]||"30 days",end:t,start:(0,P.YD)(t,30)},{id:2,value:e["DASHBOARD.TIMELINE.LAST_90_DAYS"]||"90 days",end:t,start:(0,P.YD)(t,90)},{id:3,value:e["DASHBOARD.TIMELINE.SHOW_ALL_NOTIFICATIONS"]||"Show All",end:null,start:null}]}(e.translations),i=[{id:1,value:e.translations["DASHBOARD.ENG_CARE.FILTERS.SHOW_ALL"]||"All Channels"}],s=function(e){return[{id:1,value:e["DASHBOARD.ENG_CARE.FILTERS.SHOW_ALL"]||"All"}]}(e.translations),o=null,l=(0,r.useState)(i[0].value),c=(0,g.Z)(l,2),d=c[0],h=c[1],f=(0,r.useState)([s[0].value]),m=(0,g.Z)(f,2),x=m[0],A=m[1],N=(0,r.useState)(n[2].value),E=(0,g.Z)(N,2),v=E[0],S=E[1],T=(0,r.useState)(""),I=(0,g.Z)(T,2),w=I[0],b=I[1],j=!e.engagementViewData||e.engagementViewData.fetchingData||e.engagementViewData.failed||!e.engagementViewData.data,L=[],y=[];!j&&e.engagementViewData.data.deliveryModesSummary&&(o=function(e,t,a){if((0,de.Qr)(e))return!1;for(var n,i,s,o,r,l,c=e.deliveryModesSummary,d=0,u=!1,p=0;p<c.length;p++)"push"===c[p].deliveryMode.toLowerCase()?(n=c[p].failureCount+c[p].successCount,d+=c[p].failureCount):"email"===c[p].deliveryMode.toLowerCase()?(s=c[p].failureCount+c[p].successCount,d+=c[p].failureCount,l=c[p].successCount>0):"sms"===c[p].deliveryMode.toLowerCase()?(i=c[p].failureCount+c[p].successCount,d+=c[p].failureCount,r=c[p].successCount>0):"paper"===c[p].deliveryMode.toLowerCase()&&(o=c[p].failureCount+c[p].successCount,d+=c[p].failureCount,u=c[p].successCount>0);return[{title:t["DASHBOARD.SUMMARY.EMAILS"]||"Emails",total:s,class:"email",isEnabled:l},{title:t["DASHBOARD.SUMMARY.SMS"]||"SMS",total:i,class:"sms",isEnabled:r},{title:t["DASHBOARD.SUMMARY.PAPER"]||"Paper",total:o,class:"paper",isEnabled:u},{title:t["DASHBOARD.SUMMARY.PUSH"]||"Push",total:n,class:"push",isEnabled:a.areNotificationChannelsEnabled.push},{title:t["DASHBOARD.SUMMARY.FAILED"]||"Failed",total:e.totalCount,failed:d,class:"bounced",isEnabled:a.areNotificationChannelsEnabled.failed}]}(e.engagementViewData.data,e.translations,Ae)),!j&&e.engagementViewData.data.notificationsList&&function(t){var a,n=[],o=[],r=1,l=(0,p.Z)(t);try{for(l.s();!(a=l.n()).done;){var c=a.value;-1===n.indexOf(c.notificationType)&&(n.push(c.notificationType),r++,s.push({id:r,value:pe(c.notificationType)})),-1===o.indexOf(c.deliveryMode)&&(o.push(c.deliveryMode),r++,i.push({id:r,value:he(e.translations,c.deliveryMode.toUpperCase())}))}}catch(d){l.e(d)}finally{l.f()}}(e.engagementViewData.data.notificationsList),!j&&e.engagementViewData.data.notificationsList&&(L=function(e,t){var a=[];if(!(0,de.Qr)(e)){for(var n=0;n<e.length;n++){var i=ue(e[n].deliveryMode,t),s={id:e[n].notificationId,date:(0,P.p6)(e[n].generationTimestamp,u.ZFD.MONTH_DAY_YEAR_SLASH,u.ZFD.MONTH_DAY_YEAR_SLASH),dateTime:(0,P.p6)(e[n].generationTimestamp,u.ZFD.YEAR_MONTH_DAY_HOUR_MIN_SEC,u.ZFD.MONTH_DAY_YEAR_SLASH),channelId:i.channelId,channel:i.channelName,timestamp:e[n].generationTimestamp,fuelType:e[n].measurementType?t["FUEL_TYPES."+e[n].measurementType]:"",email:e[n].deliveryDestination,type:ge("type",e[n],t),status:ge("status",e[n],t),opened:ge("lastOpenedTimestamp",e[n],t),clicked:ge("lastClickedTimestamp",e[n],t),message:ge("message",e[n],t)};s.previewAdaLabel="See preview for ".concat(s.channel," sent on ").concat(s.date),a.push(s)}return a}t["DASHBOARD.TABLE_HEADER.NO_NOTIFICATION_FOUND"]}(e.engagementViewData.data.notificationsList,e.translations,e.session),L&&(y=function(e){return e.filter((function(e){var t=!1;d.toLowerCase()!==i[0].value.toLowerCase()&&d.toLowerCase()!==e.channel.toLowerCase()&&d.toLowerCase()!==(e.channel+" Channel").toLowerCase()||(t=!0);var a=!1;-1===x.indexOf(s[0].value)&&-1===x.indexOf(e.type)||(a=!0);var n=!1;return w?(e.channel&&-1!==e.channel.toLowerCase().indexOf(w.toLowerCase())||e.type&&-1!==e.type.toLowerCase().indexOf(w.toLowerCase())||e.status&&-1!==e.status.toLowerCase().indexOf(w.toLowerCase())||e.message&&-1!==e.message.toLowerCase().indexOf(w.toLowerCase())||-1!==(e.date&&e.date.toLowerCase().indexOf(w.toLowerCase())))&&(n=!0):n=!0,t&&a&&n}))}(L)));var _=["Time Duration","Channel","Notifications"],M=function(a,n,i){var s="";t.analytics.trackEvent("console.app.widget.engagementView",{clicked:a,options:"Notifications"===a?s+=i.join(","):n,widget:"ENGAGEMENT_VIEW",shown:"Engagement View"},e)};return(0,C.jsx)(C.Fragment,{children:e.engagementViewData&&!e.engagementViewData.fetchingData&&!e.engagementViewData.failed&&e.engagementViewData.data&&e.engagementViewData.data.notificationsList&&(0,C.jsxs)(C.Fragment,{children:[(0,C.jsxs)("div",{className:"filters-container",children:[(0,C.jsxs)("div",{className:"filters",children:[(0,C.jsx)("div",{className:"duration-filter",children:(0,C.jsx)(O,{isIcon:!0,options:n,defaultValue:v,selectHandleChange:function(a){for(var i=0;i<n.length;i++)if(a===n[i].value){e.fetchEngagementViewDataFn(t,e.session.userProfile.userId,{start:Math.floor((0,P.ZG)(n[i].start)/1e3),end:Math.floor((0,P.ZG)(n[i].end)/1e3)});break}S(a)},userId:e.userId,filterName:_[0],onClickHandler:M,adaLabel:"Duration Filter"})}),(0,C.jsx)("div",{className:"channel-filter",children:(0,C.jsx)(O,{isIcon:!1,options:i,defaultValue:d,selectHandleChange:function(e){h(e)},userId:e.userId,filterName:_[1],onClickHandler:M,adaLabel:"Notification Channel Filter"})}),(0,C.jsx)("div",{className:"notification-filter",children:(0,C.jsx)(O,{isIcon:!1,options:s,defaultValue:x,isMultiFilter:!0,selectHandleChange:function(e){A("string"===typeof e?e.split(","):e)},userId:e.userId,filterName:_[2],onClickHandler:M,adaLabel:"Notification Alerts Filter"})})]}),(0,C.jsx)("div",{className:"notification-stats",children:(0,C.jsx)(fe.ZP,{container:!0,spacing:3,children:o&&o.map((function(e,t){return e.isEnabled&&(0,C.jsx)(fe.ZP,{item:!0,children:(0,C.jsxs)("div",{children:[(0,C.jsxs)("span",{className:"title",children:[e.title,":\xa0"]}),e.class!==xe.BOUNCED&&(0,C.jsx)("b",{className:"total",children:e.total}),e.class===xe.BOUNCED&&(0,C.jsxs)("b",{className:"failed",children:[e.failed,(0,C.jsxs)("span",{children:["/",e.total]})]})]})},t)}))})})]}),(0,C.jsxs)("div",{className:"search-results",style:{width:"100%"},children:[(0,C.jsx)("div",{className:"search-box-container",children:(0,C.jsx)("div",{className:"search-box",children:(0,C.jsxs)(H.Z,{classes:{root:a.paperRoot},children:[(0,C.jsx)(F.Z,{tabIndex:"-1",classes:{root:a.iconRoot},style:{outline:"none"},size:"large",children:(0,C.jsx)(me.Z,{})}),(0,C.jsx)(D.ZP,{classes:{root:a.inputRoot},placeholder:"Search notification by keywords",onChange:function(e){e.target.value.length>=3?b(e.target.value):b("")},onClick:function(){t.analytics.trackEvent("console.app.widget.engagementView",{clicked:"search",shown:"Engagement View",widget:"ENGAGEMENT_VIEW"},e)}})]})})}),(0,C.jsxs)("div",{className:"result-container","aria-live":"polite","aria-atomic":"true",children:[e.engagementViewData.fetchingData&&(0,C.jsx)(R.Z,{}),!e.engagementViewData.fetchingData&&e.engagementViewData.failed&&(0,C.jsx)("div",{children:"Unable to fetch notification data"}),!e.engagementViewData.fetchingData&&!e.engagementViewData.failed&&!e.isMobileView&&(0,C.jsx)(ae,{viewData:y,fetchNotificationsTemplateCb:e.fetchNotificationsTemplateFn,engagementViewNotificationData:e.engagementViewNotificationData,session:e.session,keywords:w,translations:e.translations,userId:e.userId}),!e.engagementViewData.fetchingData&&!e.engagementViewData.failed&&e.isMobileView&&(0,C.jsx)(ce,{viewData:y,fetchNotificationsTemplateCb:e.fetchNotificationsTemplateFn,engagementViewNotificationData:e.engagementViewNotificationData,session:e.session,keywords:w,userId:e.userId,translations:e.translations})]})]})]})})}var Ee=a(61939),ve=a(21629),Se=function(e){(0,s.Z)(a,e);var t=(0,o.Z)(a);function a(){return(0,n.Z)(this,a),t.apply(this,arguments)}return(0,i.Z)(a,[{key:"componentDidMount",value:function(){this.widgetTrackingInfo=this.context.rc.analytics.createWidgetInfo(u.xDZ.ENGAGEMENT_VIEW),this.props.engagementViewData||this.props.fetchEngagementViewData(this.context.rc,this.props.session.userProfile.userId),this.context.rc.analytics.trackEvent("console.app.widget.engagementView",{viewed:!0,shown:"Engagement View",widget:"ENGAGEMENT_VIEW"},this.props)}},{key:"fetchNotificationsTemplateCb",value:function(e){if(!e)return"";this.props.fetchNotificationsTemplate(this.context.rc,e)}},{key:"render",value:function(){var e=this.props.widgetStrings.title,t=this.props.widgetConfigs.hideHeader;return(0,C.jsxs)("div",{className:"engagement-view-container","aria-label":e,children:[!t&&(0,C.jsx)("div",{className:"widget-header-cont",children:(0,C.jsx)("span",{role:"heading","aria-level":2,"data-text-color":"foreground_400",children:e})}),null!==this.props.engagementViewData&&(0,C.jsx)(Ne,{engagementViewData:this.props.engagementViewData,fetchEngagementViewDataFn:this.props.fetchEngagementViewData,translations:this.props.translations,isMobileView:this.props.responsiveness.isMobileView,fetchNotificationsTemplateFn:this.props.fetchNotificationsTemplate,engagementViewNotificationData:this.props.engagementViewNotificationData,session:this.props.session})]})}}]),a}(r.Component);Se.contextType=J.zO;var Te=(0,Ee.$)(ve.Z$.CARE_ENGAGEMENT_VIEW,(0,l.EN)((0,c.$j)((function(e){return{session:e.session,translations:e.translationsData.data,engagementViewData:e.engagementViewData,engagementViewNotificationData:e.engagementViewNotification,responsiveness:e.responsiveness}}),(function(e){return{fetchEngagementViewData:function(t,a,n){return e((0,d.zm)(t,a,n))},fetchNotificationsTemplate:function(t,a){return e((0,d.ME)(t,a))}}}))(Se)))}}]);